<!doctype html><html lang=en><head><meta charset=utf-8><title>Architecture | Linkerd</title>
<link rel="shortcut icon" href=/favicon.png><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Deep dive into the architecture of Linkerd."><meta property="og:url" content="https://travisbeckham.github.io/2.9/reference/architecture/"><meta property="og:site_name" content="Linkerd"><meta property="og:title" content="Architecture"><meta property="og:description" content="Deep dive into the architecture of Linkerd."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="2.9"><meta property="og:image" content="https://travisbeckham.github.io/logos/linkerd.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://travisbeckham.github.io/logos/linkerd.png"><meta name=twitter:title content="Architecture"><meta name=twitter:description content="Deep dive into the architecture of Linkerd."><meta name=twitter:site content="@Linkerd"><link rel=canonical href=https://travisbeckham.github.io/2.9/reference/architecture/><link rel=stylesheet href=/css/main.css><script src=/js/main.js></script><script async defer src=https://buttons.github.io/buttons.js></script></head><body><header class=main-header><div class=main-header__container><div class=main-header__logo><a href=/><img src=/logos/linkerd.png alt=Linkerd></a></div><input class=main-header__toggle-checkbox type=checkbox id=main-header-toggle>
<label class=main-header__toggle for=main-header-toggle><span class=main-header__toggle-icon><span class=main-header__toggle-icon--open><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3 6H21V8H3V6m0 5H21v2H3V11m0 5H21v2H3V16z"/></svg>
</span><span class=main-header__toggle-icon--close><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg></span></span></label><div class=main-header__nav><nav class=main-nav><ul class=main-nav__menu><li class=main-nav__menu--selected><a href=/docs>Docs</a></li><li><a href>Community<svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M7.41 8.58 12 13.17l4.59-4.59L18 10l-6 6-6-6L7.41 8.58z"/></svg></a><ul><li><a href=/community/get-involved/>Get Involved</a></li><li><a href=/community/adopters/>Adopters</a></li><li><a href=/community/ambassadors/>Linkerd Ambassadors</a></li><li><a href=/community/heroes/>Linkerd Heroes</a></li><li><a href=https://linkerd.buoyant.io target=_blank rel=noopener>Buoyant's Linkerd Forum</a></li></ul></li><li><a href=/blog/>Blog</a></li><li><a href=/faq/>FAQ</a></li><li><a href=/enterprise/>Enterprise</a></li></ul><div class=main-nav__search><form action=/search method=get><div class="search-input search-input--sm"><svg class="icon" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5.0 0116 9.5c0 1.61-.59 3.09-1.56 4.23L14.71 14H15.5l5 5L19 20.5l-5-5V14.71L13.73 14.44C12.59 15.41 11.11 16 9.5 16A6.5 6.5.0 013 9.5 6.5 6.5.0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
<input type=text name=q placeholder=Search></div></form></div><div class=main-nav__github><a class=github-button href=https://github.com/linkerd/linkerd2 data-icon=octicon-star data-size=large data-show-count=true aria-label="Star linkerd/linkerd2 on GitHub">Star</a></div><div class=main-nav__forum><a href=https://linkerd.buoyant.io class="button button--primary button--sm" target=_blank rel=noopener>Join Forum</a></div></nav></div></div></header><div class=main-announcement>Service Mesh 101: Get Service Mesh-Certified
<span class=main-announcement__link><a href=https://buoyant.io/courses/service-mesh-101 target=_blank rel=noopener>Enroll now</a></span></div><main class=main-content><div class="alert alert--warning alert--condensed alert--center docs__deprecated-alert"><div class=alert__content>You are viewing docs for an older version of Linkerd.
<a href=/2.16/>View the latest docs</a>.</div></div><div class=docs><div class=docs__container><div class=docs__sidebar><div class=docs__nav><div class=docs__versions><select onchange="window.location.href=this.value"><option value=/2-edge/>Linkerd edge</option><option value=/2.16/>Linkerd 2.16</option><option value=/2.15/>Linkerd 2.15</option><option value=/2.14/>Linkerd 2.14</option><option value=/2.13/>Linkerd 2.13</option><option value=/2.12/>Linkerd 2.12</option><option value=/2.11/>Linkerd 2.11</option><option value=/2.10/>Linkerd 2.10</option><option value=/2.9/ selected>Linkerd 2.9</option></select></div><nav><ul><li><a href=/2.9/overview/>Overview</a></li><li><a href=/2.9/getting-started/>Getting Started</a></li><li><a href=/2.9/features/>Features
</a><input class=toggle__input type=checkbox id=toggle-e4cde74e0b82591bbb113b641faed73d>
<label class=toggle__label for=toggle-e4cde74e0b82591bbb113b641faed73d><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2.9/features/http-grpc/>HTTP, HTTP/2, and gRPC Proxying</a></li><li><a href=/2.9/features/protocol-detection/>TCP Proxying and Protocol Detection</a></li><li><a href=/2.9/features/retries-and-timeouts/>Retries and Timeouts</a></li><li><a href=/2.9/features/automatic-mtls/>Automatic mTLS</a></li><li><a href=/2.9/features/ingress/>Ingress</a></li><li><a href=/2.9/features/telemetry/>Telemetry and Monitoring</a></li><li><a href=/2.9/features/load-balancing/>Load Balancing</a></li><li><a href=/2.9/features/proxy-injection/>Automatic Proxy Injection</a></li><li><a href=/2.9/features/cni/>CNI Plugin</a></li><li><a href=/2.9/features/dashboard/>Dashboard and Grafana</a></li><li><a href=/2.9/features/distributed-tracing/>Distributed Tracing</a></li><li><a href=/2.9/features/fault-injection/>Fault Injection</a></li><li><a href=/2.9/features/ha/>High Availability</a></li><li><a href=/2.9/features/multicluster/>Multi-cluster communication</a></li><li><a href=/2.9/features/service-profiles/>Service Profiles</a></li><li><a href=/2.9/features/traffic-split/>Traffic Split (canaries, blue/green deploys)</a></li></ul></li><li><a href=/2.9/tasks/>Tasks
</a><input class=toggle__input type=checkbox id=toggle-5e629638c4c6eed35a2c9c4890c08f16>
<label class=toggle__label for=toggle-5e629638c4c6eed35a2c9c4890c08f16><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2.9/tasks/adding-your-service/>Adding Your Services to Linkerd</a></li><li><a href=/2.9/tasks/canary-release/>Automated Canary Releases</a></li><li><a href=/2.9/tasks/automatically-rotating-control-plane-tls-credentials/>Automatically Rotating Control Plane TLS Credentials</a></li><li><a href=/2.9/tasks/automatically-rotating-webhook-tls-credentials/>Automatically Rotating Webhook TLS Credentials</a></li><li><a href=/2.9/tasks/external-prometheus/>Bringing your own Prometheus</a></li><li><a href=/2.9/tasks/configuring-proxy-concurrency/>Configuring Proxy Concurrency</a></li><li><a href=/2.9/tasks/configuring-retries/>Configuring Retries</a></li><li><a href=/2.9/tasks/configuring-timeouts/>Configuring Timeouts</a></li><li><a href=/2.9/tasks/using-debug-endpoints/>Control Plane Debug Endpoints</a></li><li><a href=/2.9/tasks/customize-install/>Customizing Linkerd's Configuration with Kustomize</a></li><li><a href=/2.9/tasks/debugging-502s/>Debugging 502s</a></li><li><a href=/2.9/tasks/debugging-your-service/>Debugging gRPC applications with request tracing</a></li><li><a href=/2.9/tasks/books/>Debugging HTTP applications with per-route metrics</a></li><li><a href=/2.9/tasks/distributed-tracing/>Distributed tracing with Linkerd</a></li><li><a href=/2.9/tasks/enabling-addons/>Enabling Add-ons</a></li><li><a href=/2.9/tasks/exporting-metrics/>Exporting Metrics</a></li><li><a href=/2.9/tasks/exposing-dashboard/>Exposing the Dashboard</a></li><li><a href=/2.9/tasks/generate-certificates/>Generating your own mTLS root certificates</a></li><li><a href=/2.9/tasks/getting-per-route-metrics/>Getting Per-Route Metrics</a></li><li><a href=/2.9/tasks/graceful-shutdown/>Graceful Pod Shutdown</a></li><li><a href=/2.9/tasks/using-ingress/>Ingress traffic</a></li><li><a href=/2.9/tasks/fault-injection/>Injecting Faults</a></li><li><a href=/2.9/tasks/install/>Installing Linkerd</a></li><li><a href=/2.9/tasks/install-helm/>Installing Linkerd with Helm</a></li><li><a href=/2.9/tasks/installing-multicluster/>Installing Multi-cluster Components</a></li><li><a href=/2.9/tasks/using-psp/>Linkerd and Pod Security Policies (PSP)</a></li><li><a href=/2.9/tasks/manually-rotating-control-plane-tls-credentials/>Manually Rotating Control Plane TLS Credentials</a></li><li><a href=/2.9/tasks/modifying-proxy-log-level/>Modifying the Proxy Log Level</a></li><li><a href=/2.9/tasks/multicluster/>Multi-cluster communication</a></li><li><a href=/2.9/tasks/replacing_expired_certificates/>Replacing expired certificates</a></li><li><a href=/2.9/tasks/rotating_webhooks_certificates/>Rotating webhooks certificates</a></li><li><a href=/2.9/tasks/securing-your-service/>Securing Your Application with mTLS</a></li><li><a href=/2.9/tasks/securing-your-cluster/>Securing Your Cluster</a></li><li><a href=/2.9/tasks/setting-up-service-profiles/>Setting Up Service Profiles</a></li><li><a href=/2.9/tasks/troubleshooting/>Troubleshooting</a></li><li><a href=/2.9/tasks/uninstall/>Uninstalling Linkerd</a></li><li><a href=/2.9/tasks/uninstall-multicluster/>Uninstalling Multicluster</a></li><li><a href=/2.9/tasks/upgrade/>Upgrading Linkerd</a></li><li><a href=/2.9/tasks/upgrade-multicluster/>Upgrading Multicluster in Linkerd 2.9</a></li><li><a href=/2.9/tasks/using-custom-domain/>Using a Custom Cluster Domain</a></li><li><a href=/2.9/tasks/using-a-private-docker-repository/>Using A Private Docker Repository</a></li><li><a href=/2.9/tasks/gitops/>Using GitOps with Linkerd with Argo CD</a></li><li><a href=/2.9/tasks/using-the-debug-container/>Using the Debug Sidecar</a></li></ul></li><li class=docs__nav--selected><a href=/2.9/reference/>Reference
</a><input class=toggle__input type=checkbox id=toggle-a8d66111bc52c02f61a2a68c4bc0d794 checked>
<label class=toggle__label for=toggle-a8d66111bc52c02f61a2a68c4bc0d794><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li class=docs__nav--selected><a href=/2.9/reference/architecture/>Architecture</a></li><li><a href=/2.9/reference/cli/>CLI
</a><input class=toggle__input type=checkbox id=toggle-3f11a82cff203cfd1d728e9564196222>
<label class=toggle__label for=toggle-3f11a82cff203cfd1d728e9564196222><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2.9/reference/cli/check/>check</a></li><li><a href=/2.9/reference/cli/completion/>completion</a></li><li><a href=/2.9/reference/cli/dashboard/>dashboard</a></li><li><a href=/2.9/reference/cli/edges/>edges</a></li><li><a href=/2.9/reference/cli/endpoints/>endpoints</a></li><li><a href=/2.9/reference/cli/get/>get</a></li><li><a href=/2.9/reference/cli/inject/>inject</a></li><li><a href=/2.9/reference/cli/install/>install</a></li><li><a href=/2.9/reference/cli/install-cni/>install-cni</a></li><li><a href=/2.9/reference/cli/install-sp/>install-sp</a></li><li><a href=/2.9/reference/cli/logs/>logs</a></li><li><a href=/2.9/reference/cli/metrics/>metrics</a></li><li><a href=/2.9/reference/cli/profile/>profile</a></li><li><a href=/2.9/reference/cli/routes/>routes</a></li><li><a href=/2.9/reference/cli/stat/>stat</a></li><li><a href=/2.9/reference/cli/tap/>tap</a></li><li><a href=/2.9/reference/cli/top/>top</a></li><li><a href=/2.9/reference/cli/uninject/>uninject</a></li><li><a href=/2.9/reference/cli/upgrade/>upgrade</a></li><li><a href=/2.9/reference/cli/version/>version</a></li></ul></li><li><a href=/2.9/reference/cluster-configuration/>Cluster Configuration</a></li><li><a href=/2.9/reference/proxy-configuration/>Proxy Configuration</a></li><li><a href=/2.9/reference/proxy-log-level/>Proxy Log Level</a></li><li><a href=/2.9/reference/proxy-metrics/>Proxy Metrics</a></li><li><a href=/2.9/reference/service-profiles/>Service Profiles</a></li></ul></li></ul><ul><li><a href=/what-is-a-service-mesh/>What is a service mesh?</a></li><li><a href=/faq/>Frequently Asked Questions</a></li><li><a href=/releases/>Releases and Versions</a></li><li><a href=/design-principles/>Design Principles</a></li><li><a href=/going-to-production/>Going to Production</a></li><li><a href=/service-mesh-glossary/>Service Mesh Glossary</a></li></ul></nav><div class=docs__community><ul><li><a href=https://github.com/linkerd/linkerd2 target=_blank rel=noopener><img src=/logos/github.svg alt=GitHub class=img></a></li><li><a href=https://slack.linkerd.io target=_blank rel=noopener><img src=/logos/slack.svg alt=Slack class=img></a></li><li><a href=https://linkerd.buoyant.io target=_blank rel=noopener><img src=/logos/forum.png alt="Linkerd Forum" class=img></a></li></ul></div></div></div><div class=docs__main><div class=docs__body><div class=docs__header><h1>Architecture</h1></div><div class="docs__content prose"><p>At a high level, Linkerd consists of a <em>control plane</em> and a <em>data plane</em>.</p><p>The <em>control plane</em> is a set of services that run in a dedicated
namespace. These services accomplish various things&mdash;aggregating telemetry
data, providing a user-facing API, providing control data to the data plane
proxies, etc. Together, they drive the behavior of the data plane.</p><p>The <em>data plane</em> consists of transparent proxies that are run next
to each service instance. These proxies automatically handle all traffic to and
from the service. Because they&rsquo;re transparent, these proxies act as highly
instrumented out-of-process network stacks, sending telemetry to, and receiving
control signals from, the control plane.</p><figure><img alt=Architecture class="img img--max-fill img--center img--rounded" src=/images/architecture/control-plane.png><figcaption>Architecture</figcaption></figure><h2 id=control-plane class=anchor>Control Plane
<a href=#control-plane class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>The Linkerd control plane is a set of services that run in a dedicated
Kubernetes namespace (<code>linkerd</code> by default). These services accomplish various
things&mdash;aggregating telemetry data, providing a user-facing API, providing
control data to the data plane proxies, etc. Together, they drive the behavior
of the data plane. To install the control plane on your own cluster, follow the <a href=../../tasks/install/>instructions</a>.</p><p>The control plane is made up of:</p><h3 id=controller class=anchor>Controller
<a href=#controller class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>The controller deployment consists of the public-api container that provides an
API for the CLI and dashboard to interface with.</p><h3 id=destination class=anchor>Destination
<a href=#destination class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Each <a href=#proxy>proxy</a> in the data plane uses this component to lookup where to
send requests. The destination deployment is also used to fetch service profile
information used for per-route metrics, retries and timeouts.</p><h3 id=identity class=anchor>Identity
<a href=#identity class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This component provides a <a href=https://en.wikipedia.org/wiki/Certificate_authority target=_blank rel=noopener>Certificate
Authority</a> that accepts
<a href=https://en.wikipedia.org/wiki/Certificate_signing_request target=_blank rel=noopener>CSRs</a> from proxies
and returns certificates signed with the correct identity. These certificates
are fetched by the proxy on start and must be issued before the proxy becomes
ready. They are subsequently used for any connection between Linkerd proxies to
implement mTLS.</p><h3 id=proxy-injector class=anchor>Proxy Injector
<a href=#proxy-injector class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>The injector is an <a href=https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/ target=_blank rel=noopener>admission controller</a>, which receives
a webhook request every time a pod is created. This injector inspects resources
for a Linkerd-specific annotation (<code>linkerd.io/inject: enabled</code>). When that
annotation exists, the injector mutates the pod&rsquo;s specification and adds both an
<code>initContainer</code> as well as a sidecar containing the proxy itself.</p><h3 id=service-profile-validator class=anchor>Service Profile Validator
<a href=#service-profile-validator class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>The validator is also an <a href=https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/ target=_blank rel=noopener>admission controller</a>, which
validates new <a href=../service-profiles/>service profiles</a> before they are
saved.</p><h3 id=tap class=anchor>Tap
<a href=#tap class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>The tap deployment receives requests from the CLI and dashboard to watch
requests and responses in real time. It establishes stream to watch these
requests and responses in specific proxies associated with the requested
applications.</p><h3 id=web class=anchor>Web
<a href=#web class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>The web deployment provides the Linkerd dashboard. This does not require running
<code>linkerd dashboard</code> and can be <a href=../../tasks/exposing-dashboard/>exposed</a> to
others.</p><h3 id=heartbeat class=anchor>Heartbeat
<a href=#heartbeat class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This CronJob runs once a day and records some analytics that help with the
development of Linkerd. It is optional and can be disabled.</p><h3 id=grafana class=anchor>Grafana
<a href=#grafana class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Linkerd comes with many dashboards out of the box. The Grafana component is used
to render and display these dashboards. You can reach these dashboards via links
in the Linkerd dashboard itself. It is possible to see high level metrics and dig
down into the details for your workloads as well as Linkerd itself.</p><p>The dashboards that are provided out of the box include:</p><figure><img alt="Top Line Metrics" class="img img--max-fill img--center img--rounded" src=/images/screenshots/grafana-top.png><figcaption>Top Line Metrics</figcaption></figure><figure><img alt="Deployment Detail" class="img img--max-fill img--center img--rounded" src=/images/screenshots/grafana-deployment.png><figcaption>Deployment Detail</figcaption></figure><figure><img alt="Pod Detail" class="img img--max-fill img--center img--rounded" src=/images/screenshots/grafana-pod.png><figcaption>Pod Detail</figcaption></figure><figure><img alt="Linkerd Health" class="img img--max-fill img--center img--rounded" src=/images/screenshots/grafana-health.png><figcaption>Linkerd Health</figcaption></figure><h3 id=prometheus class=anchor>Prometheus
<a href=#prometheus class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Prometheus is a cloud native monitoring solution that is used to collect and
store all of the Linkerd metrics. It is installed as part of the control plane
and provides the data used by the CLI, dashboard and Grafana.</p><p>The proxy exposes a <code>/metrics</code> endpoint for Prometheus to scrape on port 4191.
This is scraped every 10 seconds. These metrics are then available to all the
other Linkerd components, such as the CLI and dashboard.</p><figure><img alt="Metrics Collection" class="img img--max-fill img--center img--rounded" src=/images/architecture/prometheus.svg><figcaption>Metrics Collection</figcaption></figure><h2 id=data-plane class=anchor>Data Plane
<a href=#data-plane class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>The Linkerd data plane is comprised of lightweight proxies, which are deployed
as sidecar containers alongside each instance of your service code. In order to
&ldquo;add&rdquo; a service to the Linkerd service mesh, the pods for that service must be
redeployed to include a data plane proxy in each pod. The proxy injector
accomplishes this by watching for a specific annotation that can either be added
with <code>linkerd inject</code> or by hand to the pod&rsquo;s spec. You can <a href=../../tasks/adding-your-service/>add your
service</a> to the data plane with a single CLI
command.</p><p>These proxies transparently intercept communication to and from each pod by
utilizing iptables rules that are automatically configured by
<a href=#linkerd-init>linkerd-init</a>, and add features such as instrumentation and
encryption (TLS), as well as allowing and denying requests according to the
relevant policy.</p><p>These proxies are not designed to be configured by hand. Rather, their behavior
is driven by the control plane.</p><h3 id=proxy class=anchor>Proxy
<a href=#proxy class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>An ultralight transparent proxy written in <a href=https://www.rust-lang.org/ target=_blank rel=noopener>Rust</a>,
the proxy is installed into each pod of a service and becomes part of the data
plane. It receives all incoming traffic for a pod and intercepts all outgoing
traffic via an <code>initContainer</code> that configures <code>iptables</code> to forward the
traffic correctly. Because it is a sidecar and intercepts all the incoming and
outgoing traffic for a service, there are no code changes required and it can
even be added to a running service.</p><p>The proxy&rsquo;s features include:</p><ul><li><p>Transparent, zero-config proxying for HTTP, HTTP/2, and arbitrary TCP
protocols.</p></li><li><p>Automatic Prometheus metrics export for HTTP and TCP traffic.</p></li><li><p>Transparent, zero-config WebSocket proxying.</p></li><li><p>Automatic, latency-aware, layer-7 load balancing.</p></li><li><p>Automatic layer-4 load balancing for non-HTTP traffic.</p></li><li><p>Automatic TLS.</p></li><li><p>An on-demand diagnostic tap API.</p></li></ul><p>The proxy supports service discovery via DNS and the
<a href=https://github.com/linkerd/linkerd2-proxy-api target=_blank rel=noopener>destination gRPC API</a>.</p><h3 id=linkerd-init class=anchor>Linkerd Init
<a href=#linkerd-init class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>To make the proxy truly transparent, traffic needs to be automatically routed
through it. The <code>linkerd-init</code> container is added as a Kubernetes
<a href=https://kubernetes.io/docs/concepts/workloads/pods/init-containers/ target=_blank rel=noopener>init container</a>
that runs before any other containers are started. This executes a small
<a href=https://github.com/linkerd/linkerd2-proxy-init target=_blank rel=noopener>program</a> which executes
<code>iptables</code> and configures the flow of traffic.</p><p>There are two main rules that <code>iptables</code> uses:</p><ul><li><p>Any traffic being sent to the pod&rsquo;s external IP address (10.0.0.1 for example)
is forwarded to a specific port on the proxy (4143). By setting
<code>SO_ORIGINAL_DST</code> on the socket, the proxy is able to forward the traffic to the
original destination port that your application is listening on.</p></li><li><p>Any traffic originating from within the pod and being sent to an external IP
address (not 127.0.0.1) is forwarded to a specific port on the proxy (4140).
Because <code>SO_ORIGINAL_DST</code> was set on the socket, the proxy is able to forward
the traffic to the original recipient (unless there is a reason to send it
elsewhere). This does not result in a traffic loop because the <code>iptables</code>
rules explicitly skip the proxy&rsquo;s UID.</p></li></ul><div class="alert alert--info alert--callout"><div class=alert__title><svg class="icon icon--current" viewBox="0 0 24 24"><path d="M13 9H11V7h2m0 10H11V11h2M12 2A10 10 0 002 12 10 10 0 0012 22 10 10 0 0022 12 10 10 0 0012 2z"/></svg><h4>Note</h4></div><div class=alert__content>By default, most ports are forwarded through the proxy. This is not always
desirable and it is possible to have specific ports skip the proxy entirely for
both incoming and outgoing traffic. See the <a href=../../features/protocol-detection/>protocol
detection</a> documentation for an explanation of
what&rsquo;s happening here.</div></div><h2 id=cli class=anchor>CLI
<a href=#cli class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>The Linkerd CLI is run locally on your machine and is used to interact with the
control and data planes. It can be used to view statistics, debug production
issues in real time and install/upgrade the control and data planes.</p><h2 id=dashboard class=anchor>Dashboard
<a href=#dashboard class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>The Linkerd dashboard provides a high level view of what is happening with your
services in real time. It can be used to view the &ldquo;golden&rdquo; metrics (success
rate, requests/second and latency), visualize service dependencies and
understand the health of specific service routes. One way to pull it up is by
running <code>linkerd dashboard</code> from the command line.</p><figure><img alt="Top Line Metrics" class="img img--max-fill img--center img--rounded" src=/images/architecture/stat.png><figcaption>Top Line Metrics</figcaption></figure><div class="alert alert--info alert--callout"><div class=alert__title><svg class="icon icon--current" viewBox="0 0 24 24"><path d="M13 9H11V7h2m0 10H11V11h2M12 2A10 10 0 002 12 10 10 0 0012 22 10 10 0 0022 12 10 10 0 0012 2z"/></svg><h4>Note</h4></div><div class=alert__content>The dashboard is served by <code>linkerd-web</code> and does not require running <code>linkerd dashboard</code>. It can be <a href=../../tasks/exposing-dashboard/>exposed</a> to others.</div></div></div></div></div></div></div></main><footer class=main-footer><div class=main-footer__top><div class="main-footer__container container"><div class=main-footer__info><p><img src=/logos/linkerd.png alt=Linkerd></p><p>Linkerd was originally created by <a href=https://buoyant.io/ target=_blank rel=noopener>Buoyant</a></p><p>View <a href=https://github.com/linkerd/linkerd/wiki/Linkerd-code-of-conduct target=_blank rel=noopener>Code of Conduct</a></p></div><div class=main-footer__links><div class=main-footer__community><h4>Community</h4><ul><li><a href=https://github.com/linkerd/linkerd2 target=_blank rel=noopener>GitHub</a></li><li><a href=https://slack.linkerd.io target=_blank rel=noopener>Slack</a></li><li><a href=https://linkerd.buoyant.io target=_blank rel=noopener>Linkerd Forum</a></li></ul></div><div class=main-footer__follow><h4>Follow</h4><ul><li><a href=https://www.linkedin.com/company/linkerd/ target=_blank rel=noopener>Linkedin</a></li><li><a href=https://www.youtube.com/buoyantio target=_blank rel=noopener>YouTube</a></li><li><a href=https://twitter.com/linkerd target=_blank rel=noopener>Twitter</a></li></ul></div></div></div></div><div class=main-footer__bottom><div class="main-footer__container container"><p><a href=https://github.com/linkerd/website/tree/main/linkerd.io/content target=_blank rel=noopener>Edit This Site</a></p><p>Copyright Â© 2024 Linkerd Authors. All rights reserved.</p></div></div></footer></body></html>