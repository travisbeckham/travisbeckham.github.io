<!doctype html><html lang=en><head><meta charset=utf-8><title>Automatically Rotating Webhook TLS Credentials | Linkerd</title>
<link rel="shortcut icon" href=/favicon.png><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Use cert-manager to automatically rotate webhook TLS credentials."><meta property="og:url" content="https://travisbeckham.github.io/2.14/tasks/automatically-rotating-webhook-tls-credentials/"><meta property="og:site_name" content="Linkerd"><meta property="og:title" content="Automatically Rotating Webhook TLS Credentials"><meta property="og:description" content="Use cert-manager to automatically rotate webhook TLS credentials."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="2.14"><meta property="og:image" content="https://travisbeckham.github.io/logos/linkerd.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://travisbeckham.github.io/logos/linkerd.png"><meta name=twitter:title content="Automatically Rotating Webhook TLS Credentials"><meta name=twitter:description content="Use cert-manager to automatically rotate webhook TLS credentials."><meta name=twitter:site content="@Linkerd"><link rel=canonical href=https://travisbeckham.github.io/2.14/tasks/automatically-rotating-webhook-tls-credentials/><link rel=stylesheet href=/css/main.css><script src=/js/main.js></script><script async defer src=https://buttons.github.io/buttons.js></script></head><body><header class=main-header><div class=main-header__container><div class=main-header__logo><a href=/><img src=/logos/linkerd.png alt=Linkerd></a></div><input class=main-header__toggle-checkbox type=checkbox id=main-header-toggle>
<label class=main-header__toggle for=main-header-toggle><span class=main-header__toggle-icon><span class=main-header__toggle-icon--open><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3 6H21V8H3V6m0 5H21v2H3V11m0 5H21v2H3V16z"/></svg>
</span><span class=main-header__toggle-icon--close><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg></span></span></label><div class=main-header__nav><nav class=main-nav><ul class=main-nav__menu><li class=main-nav__menu--selected><a href=/docs>Docs</a></li><li><a href=#>Community<svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M7.41 8.58 12 13.17l4.59-4.59L18 10l-6 6-6-6L7.41 8.58z"/></svg></a><ul><li><a href=/community/get-involved/>Get Involved</a></li><li><a href=/community/adopters/>Adopters</a></li><li><a href=/community/ambassadors/>Linkerd Ambassadors</a></li><li><a href=https://linkerd.buoyant.io target=_blank rel=noopener>Buoyant's Linkerd Forum</a></li></ul></li><li><a href=/blog/>Blog</a></li><li><a href=/faq/>FAQ</a></li><li><a href=/enterprise/>Enterprise</a></li></ul><div class=main-nav__search><form action=/search method=get><div class="search-input search-input--sm"><svg class="icon" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5.0 0116 9.5c0 1.61-.59 3.09-1.56 4.23L14.71 14H15.5l5 5L19 20.5l-5-5V14.71L13.73 14.44C12.59 15.41 11.11 16 9.5 16A6.5 6.5.0 013 9.5 6.5 6.5.0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
<input type=text name=q placeholder=Search></div></form></div><div class=main-nav__github><a class=github-button href=https://github.com/linkerd/linkerd2 data-icon=octicon-star data-size=large data-show-count=true aria-label="Star linkerd/linkerd2 on GitHub">Star</a></div><div class=main-nav__forum><a href=https://linkerd.buoyant.io class="button button--primary button--sm" target=_blank rel=noopener>Join Forum</a></div></nav></div></div></header><div class=main-announcement><strong>Oct 23, 2024</strong> New blog post: Towards a Sustainable Service Mesh.
<a href=/2024/10/23/making-linkerd-sustainable/ class=main-announcement__link>Read the post</a></div><main class=main-content><div class="alert alert--warning alert--condensed alert--center docs__deprecated-alert"><div class=alert__content>You are viewing docs for an older version of Linkerd.
<a href=/2.16/>View the latest docs</a>.</div></div><div class=docs><div class=docs__container><div class=docs__sidebar><div class=docs__nav><div class=docs__versions><select onchange="window.location.href=this.value"><option value=/2-edge/>Linkerd edge</option><option value=/2.16/>Linkerd 2.16</option><option value=/2.15/>Linkerd 2.15</option><option value=/2.14/ selected>Linkerd 2.14</option><option value=/2.13/>Linkerd 2.13</option><option value=/2.12/>Linkerd 2.12</option><option value=/2.11/>Linkerd 2.11</option><option value=/2.10/>Linkerd 2.10</option></select></div><nav><ul><li><a href=/2.14/overview/>Overview</a></li><li><a href=/2.14/getting-started/>Getting Started</a></li><li><a href=/2.14/features/>Features
</a><input class=toggle__input type=checkbox id=toggle-ea3747e68e61b73d22c1d6ba39092b05>
<label class=toggle__label for=toggle-ea3747e68e61b73d22c1d6ba39092b05><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2.14/features/http-grpc/>HTTP, HTTP/2, and gRPC Proxying</a></li><li><a href=/2.14/features/protocol-detection/>TCP Proxying and Protocol Detection</a></li><li><a href=/2.14/features/retries-and-timeouts/>Retries and Timeouts</a></li><li><a href=/2.14/features/automatic-mtls/>Automatic mTLS</a></li><li><a href=/2.14/features/ingress/>Ingress</a></li><li><a href=/2.14/features/telemetry/>Telemetry and Monitoring</a></li><li><a href=/2.14/features/load-balancing/>Load Balancing</a></li><li><a href=/2.14/features/server-policy/>Authorization Policy</a></li><li><a href=/2.14/features/proxy-injection/>Automatic Proxy Injection</a></li><li><a href=/2.14/features/cni/>CNI Plugin</a></li><li><a href=/2.14/features/dashboard/>Dashboard and on-cluster metrics stack</a></li><li><a href=/2.14/features/distributed-tracing/>Distributed Tracing</a></li><li><a href=/2.14/features/request-routing/>Dynamic Request Routing</a></li><li><a href=/2.14/features/fault-injection/>Fault Injection</a></li><li><a href=/2.14/features/ha/>High Availability</a></li><li><a href=/2.14/features/access-logging/>HTTP Access Logging</a></li><li><a href=/2.14/features/httproute/>HTTPRoutes</a></li><li><a href=/2.14/features/nft/>Iptables-nft Support</a></li><li><a href=/2.14/features/multicluster/>Multi-cluster communication</a></li><li><a href=/2.14/features/service-profiles/>Service Profiles</a></li><li><a href=/2.14/features/traffic-split/>Traffic Split (canaries, blue/green deploys)</a></li></ul></li><li class=docs__nav--selected><a href=/2.14/tasks/>Tasks
</a><input class=toggle__input type=checkbox id=toggle-2a72366790e7eb356e6377b5da0dbc49 checked>
<label class=toggle__label for=toggle-2a72366790e7eb356e6377b5da0dbc49><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2.14/tasks/adding-your-service/>Adding your services to Linkerd</a></li><li><a href=/2.14/tasks/automatic-failover/>Automatic Multicluster Failover</a></li><li><a href=/2.14/tasks/automatically-rotating-control-plane-tls-credentials/>Automatically Rotating Control Plane TLS Credentials</a></li><li class=docs__nav--selected><a href=/2.14/tasks/automatically-rotating-webhook-tls-credentials/>Automatically Rotating Webhook TLS Credentials</a></li><li><a href=/2.14/tasks/external-prometheus/>Bringing your own Prometheus</a></li><li><a href=/2.14/tasks/circuit-breakers/>Circuit Breakers</a></li><li><a href=/2.14/tasks/configuring-dynamic-request-routing/>Configuring Dynamic Request Routing</a></li><li><a href=/2.14/tasks/configuring-per-route-policy/>Configuring Per-Route Authorization Policy</a></li><li><a href=/2.14/tasks/configuring-proxy-concurrency/>Configuring Proxy Concurrency</a></li><li><a href=/2.14/tasks/configuring-proxy-discovery-cache/>Configuring Proxy Discovery Cache</a></li><li><a href=/2.14/tasks/configuring-retries/>Configuring Retries</a></li><li><a href=/2.14/tasks/configuring-timeouts/>Configuring Timeouts</a></li><li><a href=/2.14/tasks/using-debug-endpoints/>Control Plane Debug Endpoints</a></li><li><a href=/2.14/tasks/customize-install/>Customizing Linkerd's Configuration with Kustomize</a></li><li><a href=/2.14/tasks/debugging-502s/>Debugging 502s</a></li><li><a href=/2.14/tasks/debugging-your-service/>Debugging gRPC applications with request tracing</a></li><li><a href=/2.14/tasks/books/>Debugging HTTP applications with per-route metrics</a></li><li><a href=/2.14/tasks/distributed-tracing/>Distributed tracing with Linkerd</a></li><li><a href=/2.14/tasks/exporting-metrics/>Exporting Metrics</a></li><li><a href=/2.14/tasks/exposing-dashboard/>Exposing the Dashboard</a></li><li><a href=/2.14/tasks/generate-certificates/>Generating your own mTLS root certificates</a></li><li><a href=/2.14/tasks/getting-per-route-metrics/>Getting Per-Route Metrics</a></li><li><a href=/2.14/tasks/linkerd-smi/>Getting started with Linkerd SMI extension</a></li><li><a href=/2.14/tasks/graceful-shutdown/>Graceful Pod Shutdown</a></li><li><a href=/2.14/tasks/grafana/>Grafana</a></li><li><a href=/2.14/tasks/using-ingress/>Handling ingress traffic</a></li><li><a href=/2.14/tasks/fault-injection/>Injecting Faults</a></li><li><a href=/2.14/tasks/install/>Installing Linkerd</a></li><li><a href=/2.14/tasks/install-helm/>Installing Linkerd with Helm</a></li><li><a href=/2.14/tasks/installing-multicluster/>Installing Multi-cluster Components</a></li><li><a href=/2.14/tasks/using-psp/>Linkerd and Pod Security Policies (PSP)</a></li><li><a href=/2.14/tasks/manually-rotating-control-plane-tls-credentials/>Manually Rotating Control Plane TLS Credentials</a></li><li><a href=/2.14/tasks/modifying-proxy-log-level/>Modifying the Proxy Log Level</a></li><li><a href=/2.14/tasks/multicluster/>Multi-cluster communication</a></li><li><a href=/2.14/tasks/multicluster-using-statefulsets/>Multi-cluster communication with StatefulSets</a></li><li><a href=/2.14/tasks/pod-to-pod-multicluster/>Pod-to-Pod Multi-cluster communication</a></li><li><a href=/2.14/tasks/flagger/>Progressive Delivery</a></li><li><a href=/2.14/tasks/replacing_expired_certificates/>Replacing expired certificates</a></li><li><a href=/2.14/tasks/restricting-access/>Restricting Access To Services</a></li><li><a href=/2.14/tasks/rotating_webhooks_certificates/>Rotating webhooks certificates</a></li><li><a href=/2.14/tasks/securing-linkerd-tap/>Securing Linkerd Tap</a></li><li><a href=/2.14/tasks/setting-up-service-profiles/>Setting Up Service Profiles</a></li><li><a href=/2.14/tasks/traffic-shifting/>Traffic Shifting</a></li><li><a href=/2.14/tasks/troubleshooting/>Troubleshooting</a></li><li><a href=/2.14/tasks/uninstall/>Uninstalling Linkerd</a></li><li><a href=/2.14/tasks/uninstall-multicluster/>Uninstalling Multicluster</a></li><li><a href=/2.14/tasks/upgrade/>Upgrading Linkerd</a></li><li><a href=/2.14/tasks/using-custom-domain/>Using a Custom Cluster Domain</a></li><li><a href=/2.14/tasks/using-a-private-docker-repository/>Using A Private Docker Repository</a></li><li><a href=/2.14/tasks/extensions/>Using extensions</a></li><li><a href=/2.14/tasks/gitops/>Using GitOps with Linkerd with Argo CD</a></li><li><a href=/2.14/tasks/using-the-debug-container/>Using the Debug Sidecar</a></li><li><a href=/2.14/tasks/validating-your-traffic/>Validating your mTLS traffic</a></li></ul></li><li><a href=/2.14/reference/>Reference
</a><input class=toggle__input type=checkbox id=toggle-4b6137c2c4851e7b42ef195bf0fca52a>
<label class=toggle__label for=toggle-4b6137c2c4851e7b42ef195bf0fca52a><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2.14/reference/architecture/>Architecture</a></li><li><a href=/2.14/reference/authorization-policy/>Authorization Policy</a></li><li><a href=/2.14/reference/circuit-breaking/>Circuit Breaking</a></li><li><a href=/2.14/reference/cli/>CLI
</a><input class=toggle__input type=checkbox id=toggle-d1b1ff7f2e08491aa304402b092e2b75>
<label class=toggle__label for=toggle-d1b1ff7f2e08491aa304402b092e2b75><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2.14/reference/cli/authz/>authz</a></li><li><a href=/2.14/reference/cli/check/>check</a></li><li><a href=/2.14/reference/cli/completion/>completion</a></li><li><a href=/2.14/reference/cli/diagnostics/>diagnostics</a></li><li><a href=/2.14/reference/cli/identity/>identity</a></li><li><a href=/2.14/reference/cli/inject/>inject</a></li><li><a href=/2.14/reference/cli/install/>install</a></li><li><a href=/2.14/reference/cli/install-cni/>install-cni</a></li><li><a href=/2.14/reference/cli/jaeger/>jaeger</a></li><li><a href=/2.14/reference/cli/multicluster/>multicluster</a></li><li><a href=/2.14/reference/cli/profile/>profile</a></li><li><a href=/2.14/reference/cli/prune/>prune</a></li><li><a href=/2.14/reference/cli/uninject/>uninject</a></li><li><a href=/2.14/reference/cli/uninstall/>uninstall</a></li><li><a href=/2.14/reference/cli/upgrade/>upgrade</a></li><li><a href=/2.14/reference/cli/version/>version</a></li><li><a href=/2.14/reference/cli/viz/>viz</a></li></ul></li><li><a href=/2.14/reference/cluster-configuration/>Cluster Configuration</a></li><li><a href=/2.14/reference/extension-list/>Extensions List</a></li><li><a href=/2.14/reference/helm-chart-version-matrix/>Helm Chart Version Matrix</a></li><li><a href=/2.14/reference/httproute/>HTTPRoute</a></li><li><a href=/2.14/reference/iptables/>IPTables Reference</a></li><li><a href=/2.14/reference/multicluster/>Multi-cluster communication</a></li><li><a href=/2.14/reference/proxy-configuration/>Proxy Configuration</a></li><li><a href=/2.14/reference/proxy-log-level/>Proxy Log Level</a></li><li><a href=/2.14/reference/proxy-metrics/>Proxy Metrics</a></li><li><a href=/2.14/reference/service-profiles/>Service Profiles</a></li><li><a href=/2.14/reference/k8s-versions/>Supported Kubernetes Versions</a></li></ul></li></ul><ul><li><a href=/what-is-a-service-mesh/>What is a service mesh?</a></li><li><a href=/faq/>Frequently Asked Questions</a></li><li><a href=/releases/>Releases and Versions</a></li><li><a href=/design-principles/>Design Principles</a></li><li><a href=/going-to-production/>Going to Production</a></li><li><a href=/service-mesh-glossary/>Service Mesh Glossary</a></li></ul></nav><div class=docs__community><ul><li><a href=https://github.com/linkerd/linkerd2 target=_blank rel=noopener><img src=/logos/github.svg alt=GitHub class=img></a></li><li><a href=https://slack.linkerd.io target=_blank rel=noopener><img src=/logos/slack.svg alt=Slack class=img></a></li><li><a href=https://linkerd.buoyant.io target=_blank rel=noopener><img src=/logos/forum.png alt="Linkerd Forum" class=img></a></li></ul></div></div></div><div class=docs__main><div class=docs__body><div class=docs__header><h1>Automatically Rotating Webhook TLS Credentials</h1></div><div class="docs__content prose"><p>The Linkerd control plane contains several components, called webhooks, which
are called directly by Kubernetes itself. The traffic from Kubernetes to the
Linkerd webhooks is secured with TLS and therefore each of the webhooks requires
a secret containing TLS credentials. These certificates are different from the
ones that the Linkerd proxies use to secure pod-to-pod communication and use a
completely separate trust chain. For more information on rotating the TLS
credentials used by the Linkerd proxies, see
<a href=../use_external_certs/>Automatically Rotating Control Plane TLS Credentials</a>.</p><p>By default, when Linkerd is installed
with the Linkerd CLI or with the Linkerd Helm chart, TLS credentials are
automatically generated for all of the webhooks. If these certificates expire
or need to be regenerated for any reason, performing a
<a href=../upgrade/>Linkerd upgrade</a> (using the Linkerd CLI or using Helm) will
regenerate them.</p><p>This workflow is suitable for most users. However, if you need these webhook
certificates to be rotated automatically on a regular basis, it is possible to
use cert-manager to automatically manage them.</p><div class="alert alert--info alert--callout"><div class=alert__title><svg class="icon icon--current" viewBox="0 0 24 24"><path d="M13 9H11V7h2m0 10H11V11h2M12 2A10 10 0 002 12 10 10 0 0012 22 10 10 0 0022 12 10 10 0 0012 2z"/></svg><h4>Linkerd Production Tip</h4></div><div class=alert__content>This page contains best-effort instructions by the open source community. Production users with mission-critical applications should familiarize themselves with <a href=/going-to-production/>Linkerd production resources</a> and/or connect with a commercial <a href=/support-training/>Linkerd provider</a>.</div></div><h2 id=install-cert-manager class=anchor>Install Cert manager
<a href=#install-cert-manager class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>As a first step, <a href=https://cert-manager.io/docs/installation/ target=_blank rel=noopener>install cert-manager on your
cluster</a>
and create the namespaces that cert-manager will use to store its
webhook-related resources. For simplicity, we suggest using the default
namespace linkerd uses:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8b949e;font-style:italic># control plane core</span>
</span></span><span style=display:flex><span>kubectl create namespace linkerd
</span></span><span style=display:flex><span>kubectl label namespace linkerd <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  linkerd.io/is-control-plane<span style=color:#ff7b72;font-weight:700>=</span>true <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  config.linkerd.io/admission-webhooks<span style=color:#ff7b72;font-weight:700>=</span>disabled <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  linkerd.io/control-plane-ns<span style=color:#ff7b72;font-weight:700>=</span>linkerd
</span></span><span style=display:flex><span>kubectl annotate namespace linkerd linkerd.io/inject<span style=color:#ff7b72;font-weight:700>=</span>disabled
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># viz (ignore if not using the viz extension)</span>
</span></span><span style=display:flex><span>kubectl create namespace linkerd-viz
</span></span><span style=display:flex><span>kubectl label namespace linkerd-viz linkerd.io/extension<span style=color:#ff7b72;font-weight:700>=</span>viz
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># jaeger (ignore if not using the jaeger extension)</span>
</span></span><span style=display:flex><span>kubectl create namespace linkerd-jaeger
</span></span><span style=display:flex><span>kubectl label namespace linkerd-jaeger linkerd.io/extension<span style=color:#ff7b72;font-weight:700>=</span>jaeger
</span></span></code></pre></div><h2 id=save-the-signing-key-pair-as-a-secret class=anchor>Save the signing key pair as a Secret
<a href=#save-the-signing-key-pair-as-a-secret class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>Next, we will use the <a href=https://smallstep.com/cli/ target=_blank rel=noopener><code>step</code></a> tool, to create a
signing key pair which will be used to sign each of the webhook certificates:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>step certificate create webhook.linkerd.cluster.local ca.crt ca.key <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --profile root-ca --no-password --insecure --san webhook.linkerd.cluster.local
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl create secret tls webhook-issuer-tls --cert<span style=color:#ff7b72;font-weight:700>=</span>ca.crt --key<span style=color:#ff7b72;font-weight:700>=</span>ca.key --namespace<span style=color:#ff7b72;font-weight:700>=</span>linkerd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># ignore if not using the viz extension</span>
</span></span><span style=display:flex><span>kubectl create secret tls webhook-issuer-tls --cert<span style=color:#ff7b72;font-weight:700>=</span>ca.crt --key<span style=color:#ff7b72;font-weight:700>=</span>ca.key --namespace<span style=color:#ff7b72;font-weight:700>=</span>linkerd-viz
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># ignore if not using the jaeger extension</span>
</span></span><span style=display:flex><span>kubectl create secret tls webhook-issuer-tls --cert<span style=color:#ff7b72;font-weight:700>=</span>ca.crt --key<span style=color:#ff7b72;font-weight:700>=</span>ca.key --namespace<span style=color:#ff7b72;font-weight:700>=</span>linkerd-jaeger
</span></span></code></pre></div><h2 id=create-issuers-referencing-the-secrets class=anchor>Create Issuers referencing the secrets
<a href=#create-issuers-referencing-the-secrets class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>With the Secrets in place, we can create cert-manager &ldquo;Issuer&rdquo; resources that
reference them:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f - <span style=color:#a5d6ff>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>apiVersion: cert-manager.io/v1
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>kind: Issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>metadata:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  name: webhook-issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  namespace: linkerd
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>spec:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  ca:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    secretName: webhook-issuer-tls
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>---
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff># ignore if not using the viz extension
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>apiVersion: cert-manager.io/v1
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>kind: Issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>metadata:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  name: webhook-issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  namespace: linkerd-viz
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>spec:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  ca:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    secretName: webhook-issuer-tls
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>---
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff># ignore if not using the jaeger extension
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>apiVersion: cert-manager.io/v1
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>kind: Issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>metadata:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  name: webhook-issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  namespace: linkerd-jaeger
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>spec:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  ca:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    secretName: webhook-issuer-tls
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>EOF</span>
</span></span></code></pre></div><h2 id=issuing-certificates-and-writing-them-to-secrets class=anchor>Issuing certificates and writing them to secrets
<a href=#issuing-certificates-and-writing-them-to-secrets class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>Finally, we can create cert-manager &ldquo;Certificate&rdquo; resources which use the
Issuers to generate the desired certificates:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f - <span style=color:#a5d6ff>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>apiVersion: cert-manager.io/v1
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>kind: Certificate
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>metadata:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  name: linkerd-policy-validator
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  namespace: linkerd
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>spec:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  secretName: linkerd-policy-validator-k8s-tls
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  duration: 24h
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  renewBefore: 1h
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  issuerRef:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    name: webhook-issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    kind: Issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  commonName: linkerd-policy-validator.linkerd.svc
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  dnsNames:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  - linkerd-policy-validator.linkerd.svc
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  isCA: false
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  privateKey:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    algorithm: ECDSA
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    encoding: PKCS8
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  usages:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  - server auth
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>---
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>apiVersion: cert-manager.io/v1
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>kind: Certificate
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>metadata:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  name: linkerd-proxy-injector
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  namespace: linkerd
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>spec:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  secretName: linkerd-proxy-injector-k8s-tls
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  duration: 24h
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  renewBefore: 1h
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  issuerRef:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    name: webhook-issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    kind: Issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  commonName: linkerd-proxy-injector.linkerd.svc
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  dnsNames:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  - linkerd-proxy-injector.linkerd.svc
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  isCA: false
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  privateKey:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    algorithm: ECDSA
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  usages:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  - server auth
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>---
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>apiVersion: cert-manager.io/v1
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>kind: Certificate
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>metadata:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  name: linkerd-sp-validator
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  namespace: linkerd
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>spec:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  secretName: linkerd-sp-validator-k8s-tls
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  duration: 24h
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  renewBefore: 1h
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  issuerRef:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    name: webhook-issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    kind: Issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  commonName: linkerd-sp-validator.linkerd.svc
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  dnsNames:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  - linkerd-sp-validator.linkerd.svc
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  isCA: false
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  privateKey:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    algorithm: ECDSA
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  usages:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  - server auth
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>---
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff># ignore if not using the viz extension
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>apiVersion: cert-manager.io/v1
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>kind: Certificate
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>metadata:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  name: tap
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  namespace: linkerd-viz
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>spec:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  secretName: tap-k8s-tls
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  duration: 24h
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  renewBefore: 1h
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  issuerRef:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    name: webhook-issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    kind: Issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  commonName: tap.linkerd-viz.svc
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  dnsNames:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  - tap.linkerd-viz.svc
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  isCA: false
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  privateKey:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    algorithm: ECDSA
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  usages:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  - server auth
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>---
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff># ignore if not using the viz extension
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>apiVersion: cert-manager.io/v1
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>kind: Certificate
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>metadata:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  name: linkerd-tap-injector
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  namespace: linkerd-viz
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>spec:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  secretName: tap-injector-k8s-tls
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  duration: 24h
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  renewBefore: 1h
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  issuerRef:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    name: webhook-issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    kind: Issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  commonName: tap-injector.linkerd-viz.svc
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  dnsNames:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  - tap-injector.linkerd-viz.svc
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  isCA: false
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  privateKey:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    algorithm: ECDSA
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  usages:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  - server auth
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>---
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff># ignore if not using the jaeger extension
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>apiVersion: cert-manager.io/v1
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>kind: Certificate
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>metadata:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  name: jaeger-injector
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  namespace: linkerd-jaeger
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>spec:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  secretName: jaeger-injector-k8s-tls
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  duration: 24h
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  renewBefore: 1h
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  issuerRef:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    name: webhook-issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    kind: Issuer
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  commonName: jaeger-injector.linkerd-jaeger.svc
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  dnsNames:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  - jaeger-injector.linkerd-jaeger.svc
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  isCA: false
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  privateKey:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    algorithm: ECDSA
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  usages:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  - server auth
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>EOF</span>
</span></span></code></pre></div><p>At this point, cert-manager can now use these Certificate resources to obtain
TLS credentials, which are stored in the <code>linkerd-proxy-injector-k8s-tls</code>,
<code>linkerd-sp-validator-k8s-tls</code>, <code>tap-k8s-tls</code>, <code>tap-injector-k8s-tls</code> and
<code>jaeger-injector-k8s-tls</code> secrets respectively.</p><p>Now we just need to inform Linkerd to consume these credentials.</p><h2 id=using-these-credentials-with-cli-installation class=anchor>Using these credentials with CLI installation
<a href=#using-these-credentials-with-cli-installation class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>To configure Linkerd to use the credentials from cert-manager rather than
generating its own:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8b949e;font-style:italic># first, install the Linkerd CRDs</span>
</span></span><span style=display:flex><span>linkerd install --crds | kubectl apply -f -
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># install the Linkerd control plane, using the credentials</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># from cert-manager</span>
</span></span><span style=display:flex><span>linkerd install <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set policyValidator.externalSecret<span style=color:#ff7b72;font-weight:700>=</span>true <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set-file policyValidator.caBundle<span style=color:#ff7b72;font-weight:700>=</span>ca.crt <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set proxyInjector.externalSecret<span style=color:#ff7b72;font-weight:700>=</span>true <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set-file proxyInjector.caBundle<span style=color:#ff7b72;font-weight:700>=</span>ca.crt <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set profileValidator.externalSecret<span style=color:#ff7b72;font-weight:700>=</span>true <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set-file profileValidator.caBundle<span style=color:#ff7b72;font-weight:700>=</span>ca.crt <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  | kubectl apply -f -
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># ignore if not using the viz extension</span>
</span></span><span style=display:flex><span>linkerd viz install <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set tap.externalSecret<span style=color:#ff7b72;font-weight:700>=</span>true <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set-file tap.caBundle<span style=color:#ff7b72;font-weight:700>=</span>ca.crt <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set tapInjector.externalSecret<span style=color:#ff7b72;font-weight:700>=</span>true <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set-file tapInjector.caBundle<span style=color:#ff7b72;font-weight:700>=</span>ca.crt <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  | kubectl apply -f -
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># ignore if not using the jaeger extension</span>
</span></span><span style=display:flex><span>linkerd jaeger install
</span></span><span style=display:flex><span>  --set webhook.externalSecret<span style=color:#ff7b72;font-weight:700>=</span>true <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set-file webhook.caBundle<span style=color:#ff7b72;font-weight:700>=</span>ca.crt <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  | kubectl apply -f -
</span></span></code></pre></div><h2 id=installing-with-helm class=anchor>Installing with Helm
<a href=#installing-with-helm class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>A similar pattern can be used with Helm:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8b949e;font-style:italic># first install the linkerd-crds chart</span>
</span></span><span style=display:flex><span>helm install linkerd-crds linkerd/linkerd-crds <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  -n linkerd --create-namespace
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># then install the linkerd-control-plane chart</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># (see note below)</span>
</span></span><span style=display:flex><span>helm install linkerd-control-plane <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set-file <span style=color:#79c0ff>identityTrustAnchorsPEM</span><span style=color:#ff7b72;font-weight:700>=</span>... <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set-file identity.issuer.tls.crtPEM<span style=color:#ff7b72;font-weight:700>=</span>... <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set-file identity.issuer.tls.keyPEM<span style=color:#ff7b72;font-weight:700>=</span>... <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set policyValidator.externalSecret<span style=color:#ff7b72;font-weight:700>=</span>true <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set-file policyValidator.caBundle<span style=color:#ff7b72;font-weight:700>=</span>ca.crt <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set proxyInjector.externalSecret<span style=color:#ff7b72;font-weight:700>=</span>true <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set-file proxyInjector.caBundle<span style=color:#ff7b72;font-weight:700>=</span>ca.crt <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set profileValidator.externalSecret<span style=color:#ff7b72;font-weight:700>=</span>true <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set-file profileValidator.caBundle<span style=color:#ff7b72;font-weight:700>=</span>ca.crt <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  linkerd/linkerd-control-plane <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  -n linkerd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># ignore if not using the viz extension</span>
</span></span><span style=display:flex><span>helm install linkerd-viz <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set tap.externalSecret<span style=color:#ff7b72;font-weight:700>=</span>true <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set-file tap.caBundle<span style=color:#ff7b72;font-weight:700>=</span>ca.crt <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set tapInjector.externalSecret<span style=color:#ff7b72;font-weight:700>=</span>true <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set-file tapInjector.caBundle<span style=color:#ff7b72;font-weight:700>=</span>ca.crt <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  linkerd/linkerd-viz <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  -n linkerd-viz --create-namespace
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># ignore if not using the jaeger extension</span>
</span></span><span style=display:flex><span>helm install linkerd-jaeger <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set webhook.externalSecret<span style=color:#ff7b72;font-weight:700>=</span>true <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  --set-file webhook.caBundle<span style=color:#ff7b72;font-weight:700>=</span>ca.crt <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  linkerd/linkerd-jaeger <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  -n linkerd-jaeger --create-namespace
</span></span></code></pre></div><div class="alert alert--info alert--callout"><div class=alert__title><svg class="icon icon--current" viewBox="0 0 24 24"><path d="M13 9H11V7h2m0 10H11V11h2M12 2A10 10 0 002 12 10 10 0 0012 22 10 10 0 0022 12 10 10 0 0012 2z"/></svg><h4>Note</h4></div><div class=alert__content>When installing the <code>linkerd-control-plane</code> chart, you <em>must</em> provide the
issuer trust root and issuer credentials as described in <a href=../install-helm/>Installing Linkerd
with Helm</a>.</div></div><p>See <a href=../automatically-rotating-control-plane-tls-credentials/>Automatically Rotating Control Plane TLS
Credentials</a>
for details on how to do something similar for control plane credentials.</p></div></div></div></div></div></main><footer class=main-footer><div class=main-footer__top><div class="main-footer__container container"><div class=main-footer__info><p><img src=/logos/linkerd.png alt=Linkerd></p><p>Linkerd was originally created by <a href=https://buoyant.io/ target=_blank rel=noopener>Buoyant</a></p><p>View <a href=https://github.com/linkerd/linkerd/wiki/Linkerd-code-of-conduct target=_blank rel=noopener>Code of Conduct</a></p></div><div class=main-footer__links><div class=main-footer__community><h4>Community</h4><ul><li><a href=https://github.com/linkerd/linkerd2 target=_blank rel=noopener>GitHub</a></li><li><a href=https://slack.linkerd.io target=_blank rel=noopener>Slack</a></li><li><a href=https://linkerd.buoyant.io target=_blank rel=noopener>Linkerd Forum</a></li></ul></div><div class=main-footer__follow><h4>Follow</h4><ul><li><a href=https://www.linkedin.com/company/linkerd/ target=_blank rel=noopener>Linkedin</a></li><li><a href=https://www.youtube.com/buoyantio target=_blank rel=noopener>YouTube</a></li><li><a href=https://twitter.com/linkerd target=_blank rel=noopener>Twitter</a></li></ul></div></div></div></div><div class=main-footer__bottom><div class="main-footer__container container"><p><a href=https://github.com/linkerd/website/tree/main/linkerd.io/content target=_blank rel=noopener>Edit This Site</a></p><p>Copyright  2024 Linkerd Authors. All rights reserved.</p></div></div></footer></body></html>