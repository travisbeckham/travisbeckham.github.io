<!doctype html><html lang=en><head><meta charset=utf-8><title>Debugging HTTP applications with per-route metrics | Linkerd</title>
<link rel="shortcut icon" href=/favicon.png><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Follow a long-form example of debugging a failing HTTP application using per-route metrics."><meta property="og:url" content="https://travisbeckham.github.io/2-edge/tasks/books/"><meta property="og:site_name" content="Linkerd"><meta property="og:title" content="Debugging HTTP applications with per-route metrics"><meta property="og:description" content="Follow a long-form example of debugging a failing HTTP application using per-route metrics."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="2-edge"><meta property="og:image" content="https://travisbeckham.github.io/logos/linkerd.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://travisbeckham.github.io/logos/linkerd.png"><meta name=twitter:title content="Debugging HTTP applications with per-route metrics"><meta name=twitter:description content="Follow a long-form example of debugging a failing HTTP application using per-route metrics."><meta name=twitter:site content="@Linkerd"><link rel=canonical href=https://travisbeckham.github.io/2-edge/tasks/books/><link rel=stylesheet href=/css/main.css><script src=/js/main.js></script><script async defer src=https://buttons.github.io/buttons.js></script></head><body><header class=main-header><div class=main-header__container><div class=main-header__logo><a href=/><img src=/logos/linkerd.png alt=Linkerd></a></div><input class=main-header__toggle-checkbox type=checkbox id=main-header-toggle>
<label class=main-header__toggle for=main-header-toggle><span class=main-header__toggle-icon><span class=main-header__toggle-icon--open><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3 6H21V8H3V6m0 5H21v2H3V11m0 5H21v2H3V16z"/></svg>
</span><span class=main-header__toggle-icon--close><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg></span></span></label><div class=main-header__nav><nav class=main-nav><ul class=main-nav__menu><li class=main-nav__menu--selected><a href=/docs>Docs</a></li><li><a href=#>Community<svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M7.41 8.58 12 13.17l4.59-4.59L18 10l-6 6-6-6L7.41 8.58z"/></svg></a><ul><li><a href=/community/get-involved/>Get Involved</a></li><li><a href=/community/adopters/>Adopters</a></li><li><a href=/community/ambassadors/>Linkerd Ambassadors</a></li><li><a href=https://linkerd.buoyant.io target=_blank rel=noopener>Buoyant's Linkerd Forum</a></li></ul></li><li><a href=/blog/>Blog</a></li><li><a href=/faq/>FAQ</a></li><li><a href=/enterprise/>Enterprise</a></li></ul><div class=main-nav__search><form action=/search method=get><div class="search-input search-input--sm"><svg class="icon" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5.0 0116 9.5c0 1.61-.59 3.09-1.56 4.23L14.71 14H15.5l5 5L19 20.5l-5-5V14.71L13.73 14.44C12.59 15.41 11.11 16 9.5 16A6.5 6.5.0 013 9.5 6.5 6.5.0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
<input type=text name=q placeholder=Search></div></form></div><div class=main-nav__github><a class=github-button href=https://github.com/linkerd/linkerd2 data-icon=octicon-star data-size=large data-show-count=true aria-label="Star linkerd/linkerd2 on GitHub">Star</a></div><div class=main-nav__forum><a href=https://linkerd.buoyant.io class="button button--primary button--sm" target=_blank rel=noopener>Join Forum</a></div></nav></div></div></header><div class=main-announcement>Service Mesh 101: Get Service Mesh-Certified
<span class=main-announcement__link><a href=https://buoyant.io/courses/service-mesh-101 target=_blank rel=noopener>Enroll now</a></span></div><main class=main-content><div class=docs><div class=docs__container><div class=docs__sidebar><div class=docs__nav><div class=docs__versions><select onchange="window.location.href=this.value"><option value=/2-edge/ selected>Linkerd edge</option><option value=/2.16/>Linkerd 2.16</option><option value=/2.15/>Linkerd 2.15</option><option value=/2.14/>Linkerd 2.14</option><option value=/2.13/>Linkerd 2.13</option><option value=/2.12/>Linkerd 2.12</option><option value=/2.11/>Linkerd 2.11</option><option value=/2.10/>Linkerd 2.10</option></select></div><nav><ul><li><a href=/2-edge/overview/>Overview</a></li><li><a href=/2-edge/getting-started/>Getting Started</a></li><li><a href=/2-edge/features/>Features
</a><input class=toggle__input type=checkbox id=toggle-f524806733d51ea4f7c2504b44379f32>
<label class=toggle__label for=toggle-f524806733d51ea4f7c2504b44379f32><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2-edge/features/http-grpc/>HTTP, HTTP/2, and gRPC Proxying</a></li><li><a href=/2-edge/features/protocol-detection/>TCP Proxying and Protocol Detection</a></li><li><a href=/2-edge/features/retries-and-timeouts/>Retries and Timeouts</a></li><li><a href=/2-edge/features/automatic-mtls/>Automatic mTLS</a></li><li><a href=/2-edge/features/ingress/>Ingress</a></li><li><a href=/2-edge/features/telemetry/>Telemetry and Monitoring</a></li><li><a href=/2-edge/features/load-balancing/>Load Balancing</a></li><li><a href=/2-edge/features/server-policy/>Authorization Policy</a></li><li><a href=/2-edge/features/proxy-injection/>Automatic Proxy Injection</a></li><li><a href=/2-edge/features/cni/>CNI Plugin</a></li><li><a href=/2-edge/features/dashboard/>Dashboard and on-cluster metrics stack</a></li><li><a href=/2-edge/features/distributed-tracing/>Distributed Tracing</a></li><li><a href=/2-edge/features/request-routing/>Dynamic Request Routing</a></li><li><a href=/2-edge/features/fault-injection/>Fault Injection</a></li><li><a href=/2-edge/features/ha/>High Availability</a></li><li><a href=/2-edge/features/access-logging/>HTTP Access Logging</a></li><li><a href=/2-edge/features/httproute/>HTTPRoutes</a></li><li><a href=/2-edge/features/nft/>Iptables-nft Support</a></li><li><a href=/2-edge/features/ipv6/>IPv6 Support</a></li><li><a href=/2-edge/features/multicluster/>Multi-cluster communication</a></li><li><a href=/2-edge/features/non-kubernetes-workloads/>Non-Kubernetes workloads (mesh expansion)</a></li><li><a href=/2-edge/features/service-profiles/>Service Profiles</a></li><li><a href=/2-edge/features/traffic-split/>Traffic Split (canaries, blue/green deploys)</a></li></ul></li><li class=docs__nav--selected><a href=/2-edge/tasks/>Tasks
</a><input class=toggle__input type=checkbox id=toggle-eb66af6ff84f9fce506d3a9073494489 checked>
<label class=toggle__label for=toggle-eb66af6ff84f9fce506d3a9073494489><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2-edge/tasks/adding-non-kubernetes-workloads/>Adding non-Kubernetes workloads to your mesh</a></li><li><a href=/2-edge/tasks/adding-your-service/>Adding your services to Linkerd</a></li><li><a href=/2-edge/tasks/automatic-failover/>Automatic Multicluster Failover</a></li><li><a href=/2-edge/tasks/automatically-rotating-control-plane-tls-credentials/>Automatically Rotating Control Plane TLS Credentials</a></li><li><a href=/2-edge/tasks/automatically-rotating-webhook-tls-credentials/>Automatically Rotating Webhook TLS Credentials</a></li><li><a href=/2-edge/tasks/external-prometheus/>Bringing your own Prometheus</a></li><li><a href=/2-edge/tasks/circuit-breakers/>Circuit Breakers</a></li><li><a href=/2-edge/tasks/configuring-dynamic-request-routing/>Configuring Dynamic Request Routing</a></li><li><a href=/2-edge/tasks/configuring-per-route-policy/>Configuring Per-Route Authorization Policy</a></li><li><a href=/2-edge/tasks/configuring-proxy-concurrency/>Configuring Proxy Concurrency</a></li><li><a href=/2-edge/tasks/configuring-proxy-discovery-cache/>Configuring Proxy Discovery Cache</a></li><li><a href=/2-edge/tasks/configuring-retries/>Configuring Retries</a></li><li><a href=/2-edge/tasks/configuring-timeouts/>Configuring Timeouts</a></li><li><a href=/2-edge/tasks/using-debug-endpoints/>Control Plane Debug Endpoints</a></li><li><a href=/2-edge/tasks/customize-install/>Customizing Linkerd's Configuration with Kustomize</a></li><li><a href=/2-edge/tasks/debugging-502s/>Debugging 502s</a></li><li><a href=/2-edge/tasks/debugging-your-service/>Debugging gRPC applications with request tracing</a></li><li class=docs__nav--selected><a href=/2-edge/tasks/books/>Debugging HTTP applications with per-route metrics</a></li><li><a href=/2-edge/tasks/distributed-tracing/>Distributed tracing with Linkerd</a></li><li><a href=/2-edge/tasks/exporting-metrics/>Exporting Metrics</a></li><li><a href=/2-edge/tasks/exposing-dashboard/>Exposing the Dashboard</a></li><li><a href=/2-edge/tasks/generate-certificates/>Generating your own mTLS root certificates</a></li><li><a href=/2-edge/tasks/getting-per-route-metrics/>Getting Per-Route Metrics</a></li><li><a href=/2-edge/tasks/linkerd-smi/>Getting started with Linkerd SMI extension</a></li><li><a href=/2-edge/tasks/graceful-shutdown/>Graceful Pod Shutdown</a></li><li><a href=/2-edge/tasks/grafana/>Grafana</a></li><li><a href=/2-edge/tasks/using-ingress/>Handling ingress traffic</a></li><li><a href=/2-edge/tasks/fault-injection/>Injecting Faults</a></li><li><a href=/2-edge/tasks/install/>Installing Linkerd</a></li><li><a href=/2-edge/tasks/install-helm/>Installing Linkerd with Helm</a></li><li><a href=/2-edge/tasks/installing-multicluster/>Installing Multi-cluster Components</a></li><li><a href=/2-edge/tasks/using-psp/>Linkerd and Pod Security Policies (PSP)</a></li><li><a href=/2-edge/tasks/manually-rotating-control-plane-tls-credentials/>Manually Rotating Control Plane TLS Credentials</a></li><li><a href=/2-edge/tasks/modifying-proxy-log-level/>Modifying the Proxy Log Level</a></li><li><a href=/2-edge/tasks/multicluster/>Multi-cluster communication</a></li><li><a href=/2-edge/tasks/multicluster-using-statefulsets/>Multi-cluster communication with StatefulSets</a></li><li><a href=/2-edge/tasks/per-request-policy/>Per-Request Policy</a></li><li><a href=/2-edge/tasks/pod-to-pod-multicluster/>Pod-to-Pod Multi-cluster communication</a></li><li><a href=/2-edge/tasks/flagger/>Progressive Delivery</a></li><li><a href=/2-edge/tasks/replacing_expired_certificates/>Replacing expired certificates</a></li><li><a href=/2-edge/tasks/restricting-access/>Restricting Access To Services</a></li><li><a href=/2-edge/tasks/rotating_webhooks_certificates/>Rotating webhooks certificates</a></li><li><a href=/2-edge/tasks/securing-linkerd-tap/>Securing Linkerd Tap</a></li><li><a href=/2-edge/tasks/setting-up-service-profiles/>Setting Up Service Profiles</a></li><li><a href=/2-edge/tasks/traffic-shifting/>Traffic Shifting</a></li><li><a href=/2-edge/tasks/troubleshooting/>Troubleshooting</a></li><li><a href=/2-edge/tasks/uninstall/>Uninstalling Linkerd</a></li><li><a href=/2-edge/tasks/uninstall-multicluster/>Uninstalling Multicluster</a></li><li><a href=/2-edge/tasks/upgrade/>Upgrading Linkerd</a></li><li><a href=/2-edge/tasks/using-custom-domain/>Using a Custom Cluster Domain</a></li><li><a href=/2-edge/tasks/extensions/>Using extensions</a></li><li><a href=/2-edge/tasks/gitops/>Using GitOps with Linkerd with Argo CD</a></li><li><a href=/2-edge/tasks/using-the-debug-container/>Using the Debug Sidecar</a></li><li><a href=/2-edge/tasks/validating-your-traffic/>Validating your mTLS traffic</a></li></ul></li><li><a href=/2-edge/reference/>Reference
</a><input class=toggle__input type=checkbox id=toggle-c5cd1c9c50e40c408453dcf4eae5468f>
<label class=toggle__label for=toggle-c5cd1c9c50e40c408453dcf4eae5468f><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2-edge/reference/architecture/>Architecture</a></li><li><a href=/2-edge/reference/authorization-policy/>Authorization Policy</a></li><li><a href=/2-edge/reference/circuit-breaking/>Circuit Breaking</a></li><li><a href=/2-edge/reference/cli/>CLI
</a><input class=toggle__input type=checkbox id=toggle-3670a1706f943ec7fd577cd3725efcef>
<label class=toggle__label for=toggle-3670a1706f943ec7fd577cd3725efcef><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2-edge/reference/cli/authz/>authz</a></li><li><a href=/2-edge/reference/cli/check/>check</a></li><li><a href=/2-edge/reference/cli/completion/>completion</a></li><li><a href=/2-edge/reference/cli/diagnostics/>diagnostics</a></li><li><a href=/2-edge/reference/cli/identity/>identity</a></li><li><a href=/2-edge/reference/cli/inject/>inject</a></li><li><a href=/2-edge/reference/cli/install/>install</a></li><li><a href=/2-edge/reference/cli/install-cni/>install-cni</a></li><li><a href=/2-edge/reference/cli/jaeger/>jaeger</a></li><li><a href=/2-edge/reference/cli/multicluster/>multicluster</a></li><li><a href=/2-edge/reference/cli/profile/>profile</a></li><li><a href=/2-edge/reference/cli/prune/>prune</a></li><li><a href=/2-edge/reference/cli/uninject/>uninject</a></li><li><a href=/2-edge/reference/cli/uninstall/>uninstall</a></li><li><a href=/2-edge/reference/cli/upgrade/>upgrade</a></li><li><a href=/2-edge/reference/cli/version/>version</a></li><li><a href=/2-edge/reference/cli/viz/>viz</a></li></ul></li><li><a href=/2-edge/reference/cluster-configuration/>Cluster Configuration</a></li><li><a href=/2-edge/reference/extension-list/>Extensions List</a></li><li><a href=/2-edge/reference/external-workload/>ExternalWorkload</a></li><li><a href=/2-edge/reference/httproute/>HTTPRoute</a></li><li><a href=/2-edge/reference/iptables/>IPTables Reference</a></li><li><a href=/2-edge/reference/multicluster/>Multi-cluster communication</a></li><li><a href=/2-edge/reference/proxy-configuration/>Proxy Configuration</a></li><li><a href=/2-edge/reference/proxy-log-level/>Proxy Log Level</a></li><li><a href=/2-edge/reference/proxy-metrics/>Proxy Metrics</a></li><li><a href=/2-edge/reference/retries/>Retries</a></li><li><a href=/2-edge/reference/service-profiles/>Service Profiles</a></li><li><a href=/2-edge/reference/k8s-versions/>Supported Kubernetes Versions</a></li><li><a href=/2-edge/reference/timeouts/>Timeouts</a></li></ul></li><li><a href=/2-edge/common-errors/>Common Errors
</a><input class=toggle__input type=checkbox id=toggle-de403e5bf3db4733165f05741364f350>
<label class=toggle__label for=toggle-de403e5bf3db4733165f05741364f350><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2-edge/common-errors/failfast/>Failfast</a></li><li><a href=/2-edge/common-errors/http-502/>HTTP 502 Errors</a></li><li><a href=/2-edge/common-errors/http-503-504/>HTTP 503 and 504 Errors</a></li><li><a href=/2-edge/common-errors/protocol-detection/>Protocol Detection Errors</a></li></ul></li></ul><ul><li><a href=/what-is-a-service-mesh/>What is a service mesh?</a></li><li><a href=/faq/>Frequently Asked Questions</a></li><li><a href=/releases/>Releases and Versions</a></li><li><a href=/design-principles/>Design Principles</a></li><li><a href=/going-to-production/>Going to Production</a></li><li><a href=/service-mesh-glossary/>Service Mesh Glossary</a></li></ul></nav><div class=docs__community><ul><li><a href=https://github.com/linkerd/linkerd2 target=_blank rel=noopener><img src=/logos/github.svg alt=GitHub class=img></a></li><li><a href=https://slack.linkerd.io target=_blank rel=noopener><img src=/logos/slack.svg alt=Slack class=img></a></li><li><a href=https://linkerd.buoyant.io target=_blank rel=noopener><img src=/logos/forum.png alt="Linkerd Forum" class=img></a></li></ul></div></div></div><div class=docs__main><div class=docs__body><div class=docs__header><h1>Debugging HTTP applications with per-route metrics</h1></div><div class="docs__content prose"><p>This demo is of a Ruby application that helps you manage your bookshelf. It
consists of multiple microservices and uses JSON over HTTP to communicate with
the other services. There are three services:</p><ul><li><p><a href=https://github.com/BuoyantIO/booksapp/blob/master/webapp.rb target=_blank rel=noopener>webapp</a>: the
frontend</p></li><li><p><a href=https://github.com/BuoyantIO/booksapp/blob/master/authors.rb target=_blank rel=noopener>authors</a>: an
API to manage the authors in the system</p></li><li><p><a href=https://github.com/BuoyantIO/booksapp/blob/master/books.rb target=_blank rel=noopener>books</a>: an API
to manage the books in the system</p></li></ul><p>For demo purposes, the app comes with a simple traffic generator. The overall
topology looks like this:</p><figure><img alt=Topology class="img img--max-fill img--center img--rounded" src=/docs/images/books/topology.png><figcaption>Topology</figcaption></figure><h2 id=prerequisites class=anchor>Prerequisites
<a href=#prerequisites class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>To use this guide, you&rsquo;ll need to have Linkerd installed on your cluster.
Follow the <a href=../install/>Installing Linkerd Guide</a> if you haven&rsquo;t already done
this.</p><h2 id=install-the-app class=anchor>Install the app
<a href=#install-the-app class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>To get started, let&rsquo;s install the books app onto your cluster. In your local
terminal, run:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create ns booksapp <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span> <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  curl --proto <span style=color:#a5d6ff>&#39;=https&#39;</span> --tlsv1.2 -sSfL https://run.linkerd.io/booksapp.yml <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  | kubectl -n booksapp apply -f -
</span></span></code></pre></div><p>This command creates a namespace for the demo, downloads its Kubernetes
resource manifest and uses <code>kubectl</code> to apply it to your cluster. The app
comprises the Kubernetes deployments and services that run in the <code>booksapp</code>
namespace.</p><p>Downloading a bunch of containers for the first time takes a little while.
Kubernetes can tell you when all the services are running and ready for
traffic. Wait for that to happen by running:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl -n booksapp rollout status deploy webapp
</span></span></code></pre></div><p>You can also take a quick look at all the components that were added to your
cluster by running:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl -n booksapp get all
</span></span></code></pre></div><p>Once the rollout has completed successfully, you can access the app itself by
port-forwarding <code>webapp</code> locally:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl -n booksapp port-forward svc/webapp <span style=color:#a5d6ff>7000</span> &gt;/dev/null &amp;
</span></span></code></pre></div><p>(We redirect to <code>/dev/null</code> just so you don&rsquo;t get flooded with &ldquo;Handling
connection&rdquo; messages for the rest of the exercise.)</p><p>Open <a href=http://localhost:7000/ target=_blank rel=noopener>http://localhost:7000/</a> in your browser to see the
frontend.</p><figure><img alt=Frontend class="img img--max-fill img--center img--rounded" src=/docs/images/books/frontend.png><figcaption>Frontend</figcaption></figure><p>Unfortunately, there is an error in the app: if you click <em>Add Book</em>, it will
fail 50% of the time. This is a classic case of non-obvious, intermittent
failure&mdash;the type that drives service owners mad because it is so difficult to
debug. Kubernetes itself cannot detect or surface this error. From Kubernetes&rsquo;s
perspective, it looks like everything&rsquo;s fine, but you know the application is
returning errors.</p><figure><img alt=Failure class="img img--max-fill img--center img--rounded" src=/docs/images/books/failure.png><figcaption>Failure</figcaption></figure><h2 id=add-linkerd-to-the-service class=anchor>Add Linkerd to the service
<a href=#add-linkerd-to-the-service class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>Now we need to add the Linkerd data plane proxies to the service. The easiest
option is to do something like this:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get -n booksapp deploy -o yaml <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  | linkerd inject - <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  | kubectl apply -f -
</span></span></code></pre></div><p>This command retrieves the manifest of all deployments in the <code>booksapp</code>
namespace, runs them through <code>linkerd inject</code>, and then re-applies with
<code>kubectl apply</code>. The <code>linkerd inject</code> command annotates each resource to
specify that they should have the Linkerd data plane proxies added, and
Kubernetes does this when the manifest is reapplied to the cluster. Best of
all, since Kubernetes does a rolling deploy, the application stays running the
entire time. (See <a href=../../features/proxy-injection/>Automatic Proxy Injection</a> for
more details on how this works.)</p><h2 id=debugging class=anchor>Debugging
<a href=#debugging class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>Let&rsquo;s use Linkerd to discover the root cause of this app&rsquo;s failures. Linkerd&rsquo;s
proxy exposes rich metrics about the traffic that it processes, including HTTP
response codes. The metric that we&rsquo;re interested is <code>outbound_http_route_backend_response_statuses_total</code>
and will help us identify where HTTP errors are occuring. We can use the
<code>linkerd diagnostics proxy-metrics</code> command to get proxy metrics. Pick one of
your webapp pods and run the following command to get the metrics for HTTP 500
responses:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd diagnostics proxy-metrics -n booksapp po/webapp-pod-here <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>| grep outbound_http_route_backend_response_statuses_total <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>| grep <span style=color:#79c0ff>http_status</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#79c0ff>\&#34;</span>500<span style=color:#79c0ff>\&#34;</span>
</span></span></code></pre></div><p>This should return a metric that looks something like:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>outbound_http_route_backend_response_statuses_total{
</span></span><span style=display:flex><span>  parent_group=&#34;core&#34;,
</span></span><span style=display:flex><span>  parent_kind=&#34;Service&#34;,
</span></span><span style=display:flex><span>  parent_namespace=&#34;booksapp&#34;,
</span></span><span style=display:flex><span>  parent_name=&#34;books&#34;,
</span></span><span style=display:flex><span>  parent_port=&#34;7002&#34;,
</span></span><span style=display:flex><span>  parent_section_name=&#34;&#34;,
</span></span><span style=display:flex><span>  route_group=&#34;&#34;,
</span></span><span style=display:flex><span>  route_kind=&#34;default&#34;,
</span></span><span style=display:flex><span>  route_namespace=&#34;&#34;,
</span></span><span style=display:flex><span>  route_name=&#34;http&#34;,
</span></span><span style=display:flex><span>  backend_group=&#34;core&#34;,
</span></span><span style=display:flex><span>  backend_kind=&#34;Service&#34;,
</span></span><span style=display:flex><span>  backend_namespace=&#34;booksapp&#34;,
</span></span><span style=display:flex><span>  backend_name=&#34;books&#34;,
</span></span><span style=display:flex><span>  backend_port=&#34;7002&#34;,
</span></span><span style=display:flex><span>  backend_section_name=&#34;&#34;,
</span></span><span style=display:flex><span>  http_status=&#34;500&#34;,
</span></span><span style=display:flex><span>  error=&#34;&#34;
</span></span><span style=display:flex><span>} 207
</span></span></code></pre></div><p>This counter tells us that the webapp pod received a total of 207 HTTP 500
responses from the <code>books</code> Service on port 7002.</p><h2 id=httproute class=anchor>HTTPRoute
<a href=#httproute class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>We know that the webapp component is getting 500s from the books component, but
it would be great to narrow this down further and get per route metrics. To do
this, we take advantage of the Gateway API and define a set of HTTPRoute
resources, each attached to the <code>books</code> Service by specifying it as their
<code>parent_ref</code>.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f - <span style=color:#a5d6ff>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>kind: HTTPRoute
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>apiVersion: gateway.networking.k8s.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>metadata:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  name: books-list
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  namespace: booksapp
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>spec:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  parentRefs:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    - name: books
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      group: core
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      kind: Service
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      port: 7002
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  rules:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    - matches:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        - path:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            type: Exact
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            value: &#34;/books.json&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>---
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>kind: HTTPRoute
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>apiVersion: gateway.networking.k8s.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>metadata:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  name: books-create
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  namespace: booksapp
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>spec:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  parentRefs:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    - name: books
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      group: core
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      kind: Service
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      port: 7002
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  rules:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    - matches:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        - path:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            type: Exact
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            value: &#34;/books.json&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>          method: POST
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>---
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>kind: HTTPRoute
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>apiVersion: gateway.networking.k8s.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>metadata:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  name: books-delete
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  namespace: booksapp
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>spec:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  parentRefs:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    - name: books
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      group: core
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      kind: Service
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      port: 7002
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>  rules:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    - matches:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        - path:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            type: RegularExpression
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            value: &#34;/books/\\\d+.json&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>          method: DELETE
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>EOF</span>
</span></span></code></pre></div><p>We can then check that these HTTPRoutes have been accepted by their parent
Service by checking their status subresource:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl -n booksapp get httproutes.gateway.networking.k8s.io <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>  -ojsonpath<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#39;{.items[*].status.parents[*].conditions[*]}&#39;</span> | jq .
</span></span></code></pre></div><p>Notice that the <code>Accepted</code> and <code>ResolvedRefs</code> conditions are <code>True</code>.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;lastTransitionTime&#34;</span>: <span style=color:#a5d6ff>&#34;2024-08-03T01:38:25Z&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;message&#34;</span>: <span style=color:#a5d6ff>&#34;&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;reason&#34;</span>: <span style=color:#a5d6ff>&#34;Accepted&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;status&#34;</span>: <span style=color:#a5d6ff>&#34;True&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;type&#34;</span>: <span style=color:#a5d6ff>&#34;Accepted&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;lastTransitionTime&#34;</span>: <span style=color:#a5d6ff>&#34;2024-08-03T01:38:25Z&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;message&#34;</span>: <span style=color:#a5d6ff>&#34;&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;reason&#34;</span>: <span style=color:#a5d6ff>&#34;ResolvedRefs&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;status&#34;</span>: <span style=color:#a5d6ff>&#34;True&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;type&#34;</span>: <span style=color:#a5d6ff>&#34;ResolvedRefs&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>[<span style=color:#f85149>...</span>]
</span></span></code></pre></div><p>With those HTTPRoutes in place, we can look at the <code>outbound_http_route_backend_response_statuses_total</code>
metric again, and see that the route labels have been populated:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd diagnostics proxy-metrics -n booksapp po/webapp-pod-here <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>| grep outbound_http_route_backend_response_statuses_total <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>| grep <span style=color:#79c0ff>http_status</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#79c0ff>\&#34;</span>500<span style=color:#79c0ff>\&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>outbound_http_route_backend_response_statuses_total{
</span></span><span style=display:flex><span>  parent_group=&#34;core&#34;,
</span></span><span style=display:flex><span>  parent_kind=&#34;Service&#34;,
</span></span><span style=display:flex><span>  parent_namespace=&#34;booksapp&#34;,
</span></span><span style=display:flex><span>  parent_name=&#34;books&#34;,
</span></span><span style=display:flex><span>  parent_port=&#34;7002&#34;,
</span></span><span style=display:flex><span>  parent_section_name=&#34;&#34;,
</span></span><span style=display:flex><span>  route_group=&#34;gateway.networking.k8s.io&#34;,
</span></span><span style=display:flex><span>  route_kind=&#34;HTTPRoute&#34;,
</span></span><span style=display:flex><span>  route_namespace=&#34;booksapp&#34;,
</span></span><span style=display:flex><span>  route_name=&#34;books-create&#34;,
</span></span><span style=display:flex><span>  backend_group=&#34;core&#34;,
</span></span><span style=display:flex><span>  backend_kind=&#34;Service&#34;,
</span></span><span style=display:flex><span>  backend_namespace=&#34;booksapp&#34;,
</span></span><span style=display:flex><span>  backend_name=&#34;books&#34;,
</span></span><span style=display:flex><span>  backend_port=&#34;7002&#34;,
</span></span><span style=display:flex><span>  backend_section_name=&#34;&#34;,
</span></span><span style=display:flex><span>  http_status=&#34;500&#34;,
</span></span><span style=display:flex><span>  error=&#34;&#34;
</span></span><span style=display:flex><span>} 212
</span></span></code></pre></div><p>This tells us that it is requests to the <code>books-create</code> HTTPRoute which have
been failing.</p><h2 id=retries class=anchor>Retries
<a href=#retries class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>As it can take a while to update code and roll out a new version, let&rsquo;s
tell Linkerd that it can retry requests to the failing endpoint. This will
increase request latencies, as requests will be retried multiple times, but not
require rolling out a new version. Add a retry annotation to the <code>books-create</code>
HTTPRoute which tells Linkerd to retry on 5xx responses:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl -n booksapp annotate httproutes.gateway.networking.k8s.io/books-create <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>retry.linkerd.io/http<span style=color:#ff7b72;font-weight:700>=</span>5xx
</span></span></code></pre></div><p>We can then see the effect of these retries by looking at Linkerd&rsquo;s retry
metrics:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd diagnostics proxy-metrics -n booksapp po/webapp-pod-here <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>| grep outbound_http_route_backend_response_statuses_total <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>| grep retry
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>outbound_http_route_retry_limit_exceeded_total{...} 222
</span></span><span style=display:flex><span>outbound_http_route_retry_overflow_total{...} 0
</span></span><span style=display:flex><span>outbound_http_route_retry_requests_total{...} 469
</span></span><span style=display:flex><span>outbound_http_route_retry_successes_total{...} 247
</span></span></code></pre></div><p>This tells us that Linkerd made a total of 469 retry requests, of which 247 were
successful. The remaining 222 failed and could not be retried again, since we
didn&rsquo;t raise the retry limit from its default of 1.</p><p>We can improve this further by increasing this limit to allow more than 1 retry
per request:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl -n booksapp annotate httproutes.gateway.networking.k8s.io/books-create <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>retry.linkerd.io/limit<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>3</span>
</span></span></code></pre></div><p>Over time you will see <code>outbound_http_route_retry_requests_total</code> and
<code>outbound_http_route_retry_successes_total</code> increase at a much higher rate than
<code>outbound_http_route_retry_limit_exceeded_total</code>.</p><h2 id=timeouts class=anchor>Timeouts
<a href=#timeouts class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>Linkerd can limit how long to wait before failing outgoing requests to another
service. For the purposes of this demo, let&rsquo;s set a 15ms timeout for calls to
the <code>books-create</code> route:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl -n booksapp annotate httproutes.gateway.networking.k8s.io/books-create <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>timeout.linkerd.io/request<span style=color:#ff7b72;font-weight:700>=</span>15ms
</span></span></code></pre></div><p>(You may need to adjust the timeout value depending on your cluster – 15ms
should definitely show some timeouts, but feel free to raise it if you&rsquo;re
getting so many that it&rsquo;s hard to see what&rsquo;s going on!)</p><p>We can see the effects of this timeout by running:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd diagnostics proxy-metrics -n booksapp po/webapp-pod-here <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>| grep outbound_http_route_request_statuses_total | grep books-create
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>outbound_http_route_request_statuses_total{
</span></span><span style=display:flex><span>  [...]
</span></span><span style=display:flex><span>  route_name=&#34;books-create&#34;,
</span></span><span style=display:flex><span>  http_status=&#34;&#34;,
</span></span><span style=display:flex><span>  error=&#34;REQUEST_TIMEOUT&#34;
</span></span><span style=display:flex><span>} 151
</span></span><span style=display:flex><span>outbound_http_route_request_statuses_total{
</span></span><span style=display:flex><span>  [...]
</span></span><span style=display:flex><span>  route_name=&#34;books-create&#34;,
</span></span><span style=display:flex><span>  http_status=&#34;201&#34;,
</span></span><span style=display:flex><span>  error=&#34;&#34;
</span></span><span style=display:flex><span>} 5548
</span></span><span style=display:flex><span>outbound_http_route_request_statuses_total{
</span></span><span style=display:flex><span>  [...]
</span></span><span style=display:flex><span>  route_name=&#34;books-create&#34;,
</span></span><span style=display:flex><span>  http_status=&#34;500&#34;,
</span></span><span style=display:flex><span>  error=&#34;&#34;
</span></span><span style=display:flex><span>} 3194
</span></span></code></pre></div><h2 id=clean-up class=anchor>Clean Up
<a href=#clean-up class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>To remove the books app and the booksapp namespace from your cluster, run:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl delete ns booksapp
</span></span></code></pre></div></div></div></div></div></div></main><footer class=main-footer><div class=main-footer__top><div class="main-footer__container container"><div class=main-footer__info><p><img src=/logos/linkerd.png alt=Linkerd></p><p>Linkerd was originally created by <a href=https://buoyant.io/ target=_blank rel=noopener>Buoyant</a></p><p>View <a href=https://github.com/linkerd/linkerd/wiki/Linkerd-code-of-conduct target=_blank rel=noopener>Code of Conduct</a></p></div><div class=main-footer__links><div class=main-footer__community><h4>Community</h4><ul><li><a href=https://github.com/linkerd/linkerd2 target=_blank rel=noopener>GitHub</a></li><li><a href=https://slack.linkerd.io target=_blank rel=noopener>Slack</a></li><li><a href=https://linkerd.buoyant.io target=_blank rel=noopener>Linkerd Forum</a></li></ul></div><div class=main-footer__follow><h4>Follow</h4><ul><li><a href=https://www.linkedin.com/company/linkerd/ target=_blank rel=noopener>Linkedin</a></li><li><a href=https://www.youtube.com/buoyantio target=_blank rel=noopener>YouTube</a></li><li><a href=https://twitter.com/linkerd target=_blank rel=noopener>Twitter</a></li></ul></div></div></div></div><div class=main-footer__bottom><div class="main-footer__container container"><p><a href=https://github.com/linkerd/website/tree/main/linkerd.io/content target=_blank rel=noopener>Edit This Site</a></p><p>Copyright © 2024 Linkerd Authors. All rights reserved.</p></div></div></footer></body></html>