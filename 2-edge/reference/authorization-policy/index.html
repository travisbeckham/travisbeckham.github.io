<!doctype html><html lang=en><head><meta charset=utf-8><title>Authorization Policy | Linkerd</title>
<link rel="shortcut icon" href=/favicon.png><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Reference guide to Linkerd's policy resources."><meta property="og:url" content="https://travisbeckham.github.io/2-edge/reference/authorization-policy/"><meta property="og:site_name" content="Linkerd"><meta property="og:title" content="Authorization Policy"><meta property="og:description" content="Reference guide to Linkerd's policy resources."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="2-edge"><meta property="og:image" content="https://travisbeckham.github.io/logos/linkerd.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://travisbeckham.github.io/logos/linkerd.png"><meta name=twitter:title content="Authorization Policy"><meta name=twitter:description content="Reference guide to Linkerd's policy resources."><meta name=twitter:site content="@Linkerd"><link rel=canonical href=https://travisbeckham.github.io/2-edge/reference/authorization-policy/><link rel=stylesheet href=/css/main.css><script src=/js/main.js></script><script async defer src=https://buttons.github.io/buttons.js></script></head><body><header class=main-header><div class=main-header__container><div class=main-header__logo><a href=/><img src=/logos/linkerd.png alt=Linkerd></a></div><input class=main-header__toggle-checkbox type=checkbox id=main-header-toggle>
<label class=main-header__toggle for=main-header-toggle><span class=main-header__toggle-icon><span class=main-header__toggle-icon--open><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3 6H21V8H3V6m0 5H21v2H3V11m0 5H21v2H3V16z"/></svg>
</span><span class=main-header__toggle-icon--close><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg></span></span></label><div class=main-header__nav><nav class=main-nav><ul class=main-nav__menu><li class=main-nav__menu--selected><a href=/docs>Docs</a></li><li><a href=#>Community<svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M7.41 8.58 12 13.17l4.59-4.59L18 10l-6 6-6-6L7.41 8.58z"/></svg></a><ul><li><a href=/community/get-involved/>Get Involved</a></li><li><a href=/community/adopters/>Adopters</a></li><li><a href=/community/ambassadors/>Linkerd Ambassadors</a></li><li><a href=https://linkerd.buoyant.io target=_blank rel=noopener>Buoyant's Linkerd Forum</a></li></ul></li><li><a href=/blog/>Blog</a></li><li><a href=/faq/>FAQ</a></li><li><a href=/enterprise/>Enterprise</a></li></ul><div class=main-nav__search><form action=/search method=get><div class="search-input search-input--sm"><svg class="icon" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5.0 0116 9.5c0 1.61-.59 3.09-1.56 4.23L14.71 14H15.5l5 5L19 20.5l-5-5V14.71L13.73 14.44C12.59 15.41 11.11 16 9.5 16A6.5 6.5.0 013 9.5 6.5 6.5.0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
<input type=text name=q placeholder=Search></div></form></div><div class=main-nav__github><a class=github-button href=https://github.com/linkerd/linkerd2 data-icon=octicon-star data-size=large data-show-count=true aria-label="Star linkerd/linkerd2 on GitHub">Star</a></div><div class=main-nav__forum><a href=https://linkerd.buoyant.io class="button button--primary button--sm" target=_blank rel=noopener>Join Forum</a></div></nav></div></div></header><div class=main-announcement><strong>Oct 23, 2024</strong> New blog post: Towards a Sustainable Service Mesh.
<a href=/2024/10/23/making-linkerd-sustainable/ class=main-announcement__link>Read the post</a></div><main class=main-content><div class=docs><div class=docs__container><div class=docs__sidebar><div class=docs__nav><div class=docs__versions><select onchange="window.location.href=this.value"><option value=/2-edge/ selected>Linkerd edge</option><option value=/2.16/>Linkerd 2.16</option><option value=/2.15/>Linkerd 2.15</option><option value=/2.14/>Linkerd 2.14</option><option value=/2.13/>Linkerd 2.13</option><option value=/2.12/>Linkerd 2.12</option><option value=/2.11/>Linkerd 2.11</option><option value=/2.10/>Linkerd 2.10</option></select></div><nav><ul><li><a href=/2-edge/overview/>Overview</a></li><li><a href=/2-edge/getting-started/>Getting Started</a></li><li><a href=/2-edge/features/>Features
</a><input class=toggle__input type=checkbox id=toggle-f524806733d51ea4f7c2504b44379f32>
<label class=toggle__label for=toggle-f524806733d51ea4f7c2504b44379f32><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2-edge/features/http-grpc/>HTTP, HTTP/2, and gRPC Proxying</a></li><li><a href=/2-edge/features/protocol-detection/>TCP Proxying and Protocol Detection</a></li><li><a href=/2-edge/features/retries-and-timeouts/>Retries and Timeouts</a></li><li><a href=/2-edge/features/automatic-mtls/>Automatic mTLS</a></li><li><a href=/2-edge/features/ingress/>Ingress</a></li><li><a href=/2-edge/features/telemetry/>Telemetry and Monitoring</a></li><li><a href=/2-edge/features/load-balancing/>Load Balancing</a></li><li><a href=/2-edge/features/server-policy/>Authorization Policy</a></li><li><a href=/2-edge/features/proxy-injection/>Automatic Proxy Injection</a></li><li><a href=/2-edge/features/cni/>CNI Plugin</a></li><li><a href=/2-edge/features/dashboard/>Dashboard and on-cluster metrics stack</a></li><li><a href=/2-edge/features/distributed-tracing/>Distributed Tracing</a></li><li><a href=/2-edge/features/request-routing/>Dynamic Request Routing</a></li><li><a href=/2-edge/features/fault-injection/>Fault Injection</a></li><li><a href=/2-edge/features/ha/>High Availability</a></li><li><a href=/2-edge/features/access-logging/>HTTP Access Logging</a></li><li><a href=/2-edge/features/httproute/>HTTPRoutes</a></li><li><a href=/2-edge/features/nft/>Iptables-nft Support</a></li><li><a href=/2-edge/features/ipv6/>IPv6 Support</a></li><li><a href=/2-edge/features/multicluster/>Multi-cluster communication</a></li><li><a href=/2-edge/features/non-kubernetes-workloads/>Non-Kubernetes workloads (mesh expansion)</a></li><li><a href=/2-edge/features/service-profiles/>Service Profiles</a></li><li><a href=/2-edge/features/traffic-split/>Traffic Split (canaries, blue/green deploys)</a></li></ul></li><li><a href=/2-edge/tasks/>Tasks
</a><input class=toggle__input type=checkbox id=toggle-eb66af6ff84f9fce506d3a9073494489>
<label class=toggle__label for=toggle-eb66af6ff84f9fce506d3a9073494489><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2-edge/tasks/adding-non-kubernetes-workloads/>Adding non-Kubernetes workloads to your mesh</a></li><li><a href=/2-edge/tasks/adding-your-service/>Adding your services to Linkerd</a></li><li><a href=/2-edge/tasks/automatic-failover/>Automatic Multicluster Failover</a></li><li><a href=/2-edge/tasks/automatically-rotating-control-plane-tls-credentials/>Automatically Rotating Control Plane TLS Credentials</a></li><li><a href=/2-edge/tasks/automatically-rotating-webhook-tls-credentials/>Automatically Rotating Webhook TLS Credentials</a></li><li><a href=/2-edge/tasks/external-prometheus/>Bringing your own Prometheus</a></li><li><a href=/2-edge/tasks/circuit-breakers/>Circuit Breakers</a></li><li><a href=/2-edge/tasks/configuring-dynamic-request-routing/>Configuring Dynamic Request Routing</a></li><li><a href=/2-edge/tasks/configuring-per-route-policy/>Configuring Per-Route Authorization Policy</a></li><li><a href=/2-edge/tasks/configuring-proxy-concurrency/>Configuring Proxy Concurrency</a></li><li><a href=/2-edge/tasks/configuring-proxy-discovery-cache/>Configuring Proxy Discovery Cache</a></li><li><a href=/2-edge/tasks/configuring-retries/>Configuring Retries</a></li><li><a href=/2-edge/tasks/configuring-timeouts/>Configuring Timeouts</a></li><li><a href=/2-edge/tasks/using-debug-endpoints/>Control Plane Debug Endpoints</a></li><li><a href=/2-edge/tasks/customize-install/>Customizing Linkerd's Configuration with Kustomize</a></li><li><a href=/2-edge/tasks/debugging-502s/>Debugging 502s</a></li><li><a href=/2-edge/tasks/debugging-your-service/>Debugging gRPC applications with request tracing</a></li><li><a href=/2-edge/tasks/books/>Debugging HTTP applications with per-route metrics</a></li><li><a href=/2-edge/tasks/distributed-tracing/>Distributed tracing with Linkerd</a></li><li><a href=/2-edge/tasks/exporting-metrics/>Exporting Metrics</a></li><li><a href=/2-edge/tasks/exposing-dashboard/>Exposing the Dashboard</a></li><li><a href=/2-edge/tasks/generate-certificates/>Generating your own mTLS root certificates</a></li><li><a href=/2-edge/tasks/getting-per-route-metrics/>Getting Per-Route Metrics</a></li><li><a href=/2-edge/tasks/linkerd-smi/>Getting started with Linkerd SMI extension</a></li><li><a href=/2-edge/tasks/graceful-shutdown/>Graceful Pod Shutdown</a></li><li><a href=/2-edge/tasks/grafana/>Grafana</a></li><li><a href=/2-edge/tasks/using-ingress/>Handling ingress traffic</a></li><li><a href=/2-edge/tasks/fault-injection/>Injecting Faults</a></li><li><a href=/2-edge/tasks/install/>Installing Linkerd</a></li><li><a href=/2-edge/tasks/install-helm/>Installing Linkerd with Helm</a></li><li><a href=/2-edge/tasks/installing-multicluster/>Installing Multi-cluster Components</a></li><li><a href=/2-edge/tasks/using-psp/>Linkerd and Pod Security Policies (PSP)</a></li><li><a href=/2-edge/tasks/manually-rotating-control-plane-tls-credentials/>Manually Rotating Control Plane TLS Credentials</a></li><li><a href=/2-edge/tasks/modifying-proxy-log-level/>Modifying the Proxy Log Level</a></li><li><a href=/2-edge/tasks/multicluster/>Multi-cluster communication</a></li><li><a href=/2-edge/tasks/multicluster-using-statefulsets/>Multi-cluster communication with StatefulSets</a></li><li><a href=/2-edge/tasks/per-request-policy/>Per-Request Policy</a></li><li><a href=/2-edge/tasks/pod-to-pod-multicluster/>Pod-to-Pod Multi-cluster communication</a></li><li><a href=/2-edge/tasks/flagger/>Progressive Delivery</a></li><li><a href=/2-edge/tasks/replacing_expired_certificates/>Replacing expired certificates</a></li><li><a href=/2-edge/tasks/restricting-access/>Restricting Access To Services</a></li><li><a href=/2-edge/tasks/rotating_webhooks_certificates/>Rotating webhooks certificates</a></li><li><a href=/2-edge/tasks/securing-linkerd-tap/>Securing Linkerd Tap</a></li><li><a href=/2-edge/tasks/setting-up-service-profiles/>Setting Up Service Profiles</a></li><li><a href=/2-edge/tasks/traffic-shifting/>Traffic Shifting</a></li><li><a href=/2-edge/tasks/troubleshooting/>Troubleshooting</a></li><li><a href=/2-edge/tasks/uninstall/>Uninstalling Linkerd</a></li><li><a href=/2-edge/tasks/uninstall-multicluster/>Uninstalling Multicluster</a></li><li><a href=/2-edge/tasks/upgrade/>Upgrading Linkerd</a></li><li><a href=/2-edge/tasks/using-custom-domain/>Using a Custom Cluster Domain</a></li><li><a href=/2-edge/tasks/extensions/>Using extensions</a></li><li><a href=/2-edge/tasks/gitops/>Using GitOps with Linkerd with Argo CD</a></li><li><a href=/2-edge/tasks/using-the-debug-container/>Using the Debug Sidecar</a></li><li><a href=/2-edge/tasks/validating-your-traffic/>Validating your mTLS traffic</a></li></ul></li><li class=docs__nav--selected><a href=/2-edge/reference/>Reference
</a><input class=toggle__input type=checkbox id=toggle-c5cd1c9c50e40c408453dcf4eae5468f checked>
<label class=toggle__label for=toggle-c5cd1c9c50e40c408453dcf4eae5468f><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2-edge/reference/architecture/>Architecture</a></li><li class=docs__nav--selected><a href=/2-edge/reference/authorization-policy/>Authorization Policy</a></li><li><a href=/2-edge/reference/circuit-breaking/>Circuit Breaking</a></li><li><a href=/2-edge/reference/cli/>CLI
</a><input class=toggle__input type=checkbox id=toggle-3670a1706f943ec7fd577cd3725efcef>
<label class=toggle__label for=toggle-3670a1706f943ec7fd577cd3725efcef><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2-edge/reference/cli/authz/>authz</a></li><li><a href=/2-edge/reference/cli/check/>check</a></li><li><a href=/2-edge/reference/cli/completion/>completion</a></li><li><a href=/2-edge/reference/cli/diagnostics/>diagnostics</a></li><li><a href=/2-edge/reference/cli/identity/>identity</a></li><li><a href=/2-edge/reference/cli/inject/>inject</a></li><li><a href=/2-edge/reference/cli/install/>install</a></li><li><a href=/2-edge/reference/cli/install-cni/>install-cni</a></li><li><a href=/2-edge/reference/cli/jaeger/>jaeger</a></li><li><a href=/2-edge/reference/cli/multicluster/>multicluster</a></li><li><a href=/2-edge/reference/cli/profile/>profile</a></li><li><a href=/2-edge/reference/cli/prune/>prune</a></li><li><a href=/2-edge/reference/cli/uninject/>uninject</a></li><li><a href=/2-edge/reference/cli/uninstall/>uninstall</a></li><li><a href=/2-edge/reference/cli/upgrade/>upgrade</a></li><li><a href=/2-edge/reference/cli/version/>version</a></li><li><a href=/2-edge/reference/cli/viz/>viz</a></li></ul></li><li><a href=/2-edge/reference/cluster-configuration/>Cluster Configuration</a></li><li><a href=/2-edge/reference/extension-list/>Extensions List</a></li><li><a href=/2-edge/reference/external-workload/>ExternalWorkload</a></li><li><a href=/2-edge/reference/httproute/>HTTPRoute</a></li><li><a href=/2-edge/reference/iptables/>IPTables Reference</a></li><li><a href=/2-edge/reference/multicluster/>Multi-cluster communication</a></li><li><a href=/2-edge/reference/proxy-configuration/>Proxy Configuration</a></li><li><a href=/2-edge/reference/proxy-log-level/>Proxy Log Level</a></li><li><a href=/2-edge/reference/proxy-metrics/>Proxy Metrics</a></li><li><a href=/2-edge/reference/retries/>Retries</a></li><li><a href=/2-edge/reference/service-profiles/>Service Profiles</a></li><li><a href=/2-edge/reference/k8s-versions/>Supported Kubernetes Versions</a></li><li><a href=/2-edge/reference/timeouts/>Timeouts</a></li></ul></li><li><a href=/2-edge/common-errors/>Common Errors
</a><input class=toggle__input type=checkbox id=toggle-de403e5bf3db4733165f05741364f350>
<label class=toggle__label for=toggle-de403e5bf3db4733165f05741364f350><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2-edge/common-errors/failfast/>Failfast</a></li><li><a href=/2-edge/common-errors/http-502/>HTTP 502 Errors</a></li><li><a href=/2-edge/common-errors/http-503-504/>HTTP 503 and 504 Errors</a></li><li><a href=/2-edge/common-errors/protocol-detection/>Protocol Detection Errors</a></li></ul></li></ul><ul><li><a href=/what-is-a-service-mesh/>What is a service mesh?</a></li><li><a href=/faq/>Frequently Asked Questions</a></li><li><a href=/releases/>Releases and Versions</a></li><li><a href=/design-principles/>Design Principles</a></li><li><a href=/going-to-production/>Going to Production</a></li><li><a href=/service-mesh-glossary/>Service Mesh Glossary</a></li></ul></nav><div class=docs__community><ul><li><a href=https://github.com/linkerd/linkerd2 target=_blank rel=noopener><img src=/logos/github.svg alt=GitHub class=img></a></li><li><a href=https://slack.linkerd.io target=_blank rel=noopener><img src=/logos/slack.svg alt=Slack class=img></a></li><li><a href=https://linkerd.buoyant.io target=_blank rel=noopener><img src=/logos/forum.png alt="Linkerd Forum" class=img></a></li></ul></div></div></div><div class=docs__main><div class=docs__body><div class=docs__header><h1>Authorization Policy</h1></div><div class="docs__content prose"><p>Linkerd&rsquo;s authorization policy allows you to control which types of traffic are
allowed to meshed pods. See the <a href=../../features/server-policy/>Authorization Policy feature
description</a> for more information on what this
means.</p><p>Linkerd&rsquo;s policy is configured using two mechanisms:</p><ol><li>A set of <em>default policies</em>, which can be set at the cluster,
namespace, and workload level through Kubernetes annotations.</li><li>A set of CRDs that specify fine-grained policy for specific ports, routes,
workloads, etc.</li></ol><h2 id=default-policies class=anchor>Default policies
<a href=#default-policies class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>During a Linkerd install, the <code>proxy.defaultInboundPolicy</code> field is used to
specify the cluster-wide default policy. This field can be one of the following:</p><ul><li><code>all-unauthenticated</code>: allow all traffic. This is the default.</li><li><code>all-authenticated</code>: allow traffic from meshed clients in the same or from
a different cluster (with multi-cluster).</li><li><code>cluster-authenticated</code>: allow traffic from meshed clients in the same cluster.</li><li><code>cluster-unauthenticated</code>: allow traffic from both meshed and non-meshed clients
in the same cluster.</li><li><code>deny</code>: all traffic are denied.</li><li><code>audit</code>: Same as <code>all-unauthenticated</code> but requests get flagged in logs and
metrics.</li></ul><p>This cluster-wide default can be overridden for specific resources by setting
the annotation <code>config.linkerd.io/default-inbound-policy</code> on either a pod spec
or its namespace.</p><h2 id=dynamic-policy-resources class=anchor>Dynamic policy resources
<a href=#dynamic-policy-resources class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>For dynamic control of policy, and for finer-grained policy than what the
default polices allow, Linkerd provides a set of CRDs which control traffic
policy in the cluster: <a href=#server>Server</a>, <a href=#httproute>HTTPRoute</a>, <a href=#serverauthorization>ServerAuthorization</a>,
<a href=#authorizationpolicy>AuthorizationPolicy</a>, <a href=#meshtlsauthentication>MeshTLSAuthentication</a>, and <a href=#networkauthentication>NetworkAuthentication</a>.</p><p>The general pattern for authorization is:</p><ul><li>A <code>Server</code> describes a set of pods, and a single port on those pods.</li><li>Optionally, an <code>HTTPRoute</code> references that <code>Server</code> and describes a
subset of HTTP traffic to it.</li><li>A <code>MeshTLSAuthentication</code> or <code>NetworkAuthentication</code> decribes who
is allowed access.</li><li>An <code>AuthorizationPolicy</code> references the <code>HTTPRoute</code> or <code>Server</code>
(the thing to be authorized) and the <code>MeshTLSAuthentication</code> or
<code>NetworkAuthentication</code> (the clients that have authorization).</li></ul><h2 id=server class=anchor>Server
<a href=#server class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>A <code>Server</code> selects a port on a set of pods in the same namespace as the server.
It typically selects a single port on a pod, though it may select multiple ports
when referring to the port by name (e.g. <code>admin-http</code>). While the <code>Server</code>
resource is similar to a Kubernetes <code>Service</code>, it has the added restriction that
multiple <code>Server</code> instances must not overlap: they must not select the same
pod/port pairs. Linkerd ships with an admission controller that prevents
overlapping <code>Server</code>s from being created.</p><div class="alert alert--info alert--callout"><div class=alert__title><svg class="icon icon--current" viewBox="0 0 24 24"><path d="M13 9H11V7h2m0 10H11V11h2M12 2A10 10 0 002 12 10 10 0 0012 22 10 10 0 0022 12 10 10 0 0012 2z"/></svg><h4>Note</h4></div><div class=alert__content>When a Server resource is present, all traffic to the port on its pods will be
denied unless explicitly authorized or audit mode is enabled (with
<code>accessPolicy:audit</code>). Thus, Servers are typically paired with e.g. an
AuthorizationPolicy that references the Server, or that reference an HTTPRoute
that in turn references the Server.</div></div><h3 id=server-spec class=anchor>Server Spec
<a href=#server-spec class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>A <code>Server</code> spec may contain the following top level fields:</p><div class=keyval><table><thead><tr><th>field</th><th>value</th></tr></thead><tbody><tr><td><code>accessPolicy</code></td><td><a href=#accesspolicy>accessPolicy</a> declares the policy applied to traffic not matching any associated authorization policies (defaults to <code>deny</code>).</td></tr><tr><td><code>podSelector</code></td><td>A <a href=#podselector>podSelector</a> selects pods in the same namespace.</td></tr><tr><td><code>port</code></td><td>A port name or number. Only ports in a pod spec&rsquo;s <code>ports</code> are considered.</td></tr><tr><td><code>proxyProtocol</code></td><td>Configures protocol discovery for inbound connections. Supersedes the <code>config.linkerd.io/opaque-ports</code> annotation. Must be one of <code>unknown</code>,<code>HTTP/1</code>,<code>HTTP/2</code>,<code>gRPC</code>,<code>opaque</code>,<code>TLS</code>. Defaults to <code>unknown</code> if not set.</td></tr></tbody></table></div><h4 id=accesspolicy class=anchor>accessPolicy
<a href=#accesspolicy class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h4><p>Traffic that doesn&rsquo;t conform to the authorization policies associated to the
Server are denied by default. You can alter that behavior by overriding the
<code>accessPolicy</code> field, which accepts the same values as the <a href=#default-policies>default
policies</a>. Of particular interest is the <code>audit</code> value, which
enables <a href=../../features/server-policy/#audit-mode>audit mode</a>, that you can use
to test policies before enforcing them.</p><h4 id=podselector class=anchor>podSelector
<a href=#podselector class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h4><p>This is the <a href=https://kubernetes.io/docs/reference/kubernetes-api/common-definitions/label-selector/#LabelSelector target=_blank rel=noopener>same labelSelector field in Kubernetes</a>.
All the pods that are part of this selector will be part of the <a href=#server>Server</a> group.
A podSelector object must contain <em>exactly one</em> of the following fields:</p><div class=keyval><table><thead><tr><th>field</th><th>value</th></tr></thead><tbody><tr><td><code>matchExpressions</code></td><td>matchExpressions is a list of label selector requirements. The requirements are ANDed.</td></tr><tr><td><code>matchLabels</code></td><td>matchLabels is a map of {key,value} pairs.</td></tr></tbody></table></div><p>See <a href=https://kubernetes.io/docs/reference/kubernetes-api/common-definitions/label-selector/#LabelSelector target=_blank rel=noopener>the Kubernetes LabelSelector reference</a>
for more details.</p><h3 id=server-examples class=anchor>Server Examples
<a href=#server-examples class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>A <a href=#server>Server</a> that selects over pods with a specific label, with <code>gRPC</code> as
the <code>proxyProtocol</code>.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#7ee787>apiVersion</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>policy.linkerd.io/v1beta1</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Server</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>metadata</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>namespace</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>emojivoto</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>emoji-grpc</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>spec</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>podSelector</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>matchLabels</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>app</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>emoji-svc</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>port</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>grpc</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>proxyProtocol</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>gRPC</span><span style=color:#6e7681>
</span></span></span></code></pre></div><p>A <a href=#server>Server</a> that selects over pods with <code>matchExpressions</code>, with <code>HTTP/2</code>
as the <code>proxyProtocol</code>, on port <code>8080</code>.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#7ee787>apiVersion</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>policy.linkerd.io/v1beta1</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Server</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>metadata</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>namespace</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>emojivoto</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>backend-services</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>spec</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>podSelector</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>matchExpressions</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- {<span style=color:#7ee787>key: app, operator: In, values</span>:<span style=color:#6e7681> </span>[<span style=color:#a5d6ff>voting-svc, emoji-svc]}</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- {<span style=color:#7ee787>key: environment, operator: NotIn, values</span>:<span style=color:#6e7681> </span>[<span style=color:#a5d6ff>dev]}</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>port</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>8080</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>proxyProtocol</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;HTTP/2&#34;</span><span style=color:#6e7681>
</span></span></span></code></pre></div><h2 id=httproute class=anchor>HTTPRoute
<a href=#httproute class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>When attached to a <a href=#server>Server</a>, an <code>HTTPRoute</code> resource represents a subset of the
traffic handled by the ports on pods referred in that Server, by declaring a set
of rules which determine which requests match. Matches can be based on path,
headers, query params, and/or verb. <a href=#authorizationpolicy>AuthorizationPolicies</a> may target
<code>HTTPRoute</code> resources, thereby authorizing traffic to that <code>HTTPRoute</code> only
rather than to the entire <a href=#server>Server</a>. <code>HTTPRoutes</code> may also define filters which
add processing steps that must be completed during the request or response
lifecycle.</p><div class="alert alert--info alert--callout"><div class=alert__title><svg class="icon icon--current" viewBox="0 0 24 24"><path d="M13 9H11V7h2m0 10H11V11h2M12 2A10 10 0 002 12 10 10 0 0012 22 10 10 0 0022 12 10 10 0 0012 2z"/></svg><h4>Note</h4></div><div class=alert__content>A given HTTP request can only match one HTTPRoute. If multiple HTTPRoutes
are present that match a request, one will be picked according to the <a href=https://gateway-api.sigs.k8s.io/references/spec/#gateway.networking.k8s.io/v1beta1.HTTPRouteSpec target=_blank rel=noopener>Gateway
API rules of
precendence</a>.</div></div><p>Please refer to HTTPRoute&rsquo;s full <a href=../httproute/>spec</a>.</p><div class="alert alert--info alert--callout"><div class=alert__title><svg class="icon icon--current" viewBox="0 0 24 24"><path d="M13 9H11V7h2m0 10H11V11h2M12 2A10 10 0 002 12 10 10 0 0012 22 10 10 0 0022 12 10 10 0 0012 2z"/></svg><h4>Note</h4></div><div class=alert__content><p>Two versions of the HTTPRoute resource may be used with Linkerd:</p><ul><li>The upstream version provided by the Gateway API, with the
<code>gateway.networking.k8s.io</code> API group</li><li>A Linkerd-specific CRD provided by Linkerd, with the <code>policy.linkerd.io</code> API
group</li></ul><p>The two HTTPRoute resource definitions are similar, but the Linkerd version
implements experimental features not yet available with the upstream Gateway API
resource definition. See <a href=../httproute/#linkerd-and-gateway-api-httproutes>the HTTPRoute reference
documentation</a>
for details.</p></div></div><h2 id=authorizationpolicy class=anchor>AuthorizationPolicy
<a href=#authorizationpolicy class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>An AuthorizationPolicy provides a way to authorize traffic to a <a href=#server>Server</a> or an
<a href=#httproute>HTTPRoute</a>. AuthorizationPolicies are a replacement for <a href=#serverauthorization>ServerAuthorizations</a>
which are more flexible because they can target <a href=#httproute>HTTPRoutes</a> instead of only
being able to target <a href=#server>Servers</a>.</p><h3 id=authorizationpolicy-spec class=anchor>AuthorizationPolicy Spec
<a href=#authorizationpolicy-spec class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>An <code>AuthorizationPolicy</code> spec may contain the following top level fields:</p><div class=keyval><table><thead><tr><th>field</th><th>value</th></tr></thead><tbody><tr><td><code>targetRef</code></td><td>A <a href=#targetref>TargetRef</a> which references a resource to which the authorization policy applies.</td></tr><tr><td><code>requiredAuthenticationRefs</code></td><td>A list of <a href=#targetref>TargetRefs</a> representing the required authentications. In the case of multiple entries, <em>all</em> authentications must match.</td></tr></tbody></table></div><h4 id=targetref class=anchor>targetRef
<a href=#targetref class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h4><p>A <code>TargetRef</code> identifies an API object to which this AuthorizationPolicy
applies. The API objects supported are:</p><ul><li>A <a href=#server>Server</a>, indicating that the AuthorizationPolicy applies to all traffic to
the Server.</li><li>An <a href=#httproute>HTTPRoute</a>, indicating that the AuthorizationPolicy applies to all traffic
matching the HTTPRoute.</li><li>A namespace (<code>kind: Namespace</code>), indicating that the AuthorizationPolicy
applies to all traffic to all <a href=#server>Servers</a> and <a href=#httproute>HTTPRoutes</a> defined in the
namespace.</li></ul><div class=keyval><table><thead><tr><th>field</th><th>value</th></tr></thead><tbody><tr><td><code>group</code></td><td>Group is the group of the target resource. For namespace kinds, this should be omitted.</td></tr><tr><td><code>kind</code></td><td>Kind is kind of the target resource.</td></tr><tr><td><code>namespace</code></td><td>The namespace of the target resource. When unspecified (or empty string), this refers to the local namespace of the policy.</td></tr><tr><td><code>name</code></td><td>Name is the name of the target resource.</td></tr></tbody></table></div><h3 id=authorizationpolicy-examples class=anchor>AuthorizationPolicy Examples
<a href=#authorizationpolicy-examples class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>An <code>AuthorizationPolicy</code> which authorizes clients that satisfy the
<code>authors-get-authn</code> authentication to send to the <code>authors-get-route</code>
<a href=#httproute>HTTPRoute</a>.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#7ee787>apiVersion</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>policy.linkerd.io/v1alpha1</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>AuthorizationPolicy</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>metadata</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>authors-get-policy</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>namespace</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>booksapp</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>spec</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>targetRef</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>group</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>policy.linkerd.io</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>HTTPRoute</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>authors-get-route</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>requiredAuthenticationRefs</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>authors-get-authn</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>MeshTLSAuthentication</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>group</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>policy.linkerd.io</span><span style=color:#6e7681>
</span></span></span></code></pre></div><p>An <code>AuthorizationPolicy</code> which authorizes the <code>webapp</code> <code>ServiceAccount</code> to send
to the <code>authors</code> <a href=#server>Server</a>.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#7ee787>apiVersion</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>policy.linkerd.io/v1alpha1</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>AuthorizationPolicy</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>metadata</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>authors-policy</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>namespace</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>booksapp</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>spec</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>targetRef</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>group</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>policy.linkerd.io</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Server</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>authors</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>requiredAuthenticationRefs</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>webapp</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>ServiceAccount</span><span style=color:#6e7681>
</span></span></span></code></pre></div><p>An <code>AuthorizationPolicy</code> which authorizes the <code>webapp</code> <code>ServiceAccount</code> to send
to all policy &ldquo;targets&rdquo; within the <code>booksapp</code> namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#7ee787>apiVersion</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>policy.linkerd.io/v1alpha1</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>AuthorizationPolicy</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>metadata</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>authors-policy</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>namespace</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>booksapp</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>spec</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>targetRef</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Namespace</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>booksapp</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>requiredAuthenticationRefs</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>webapp</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>ServiceAccount</span><span style=color:#6e7681>
</span></span></span></code></pre></div><h2 id=meshtlsauthentication class=anchor>MeshTLSAuthentication
<a href=#meshtlsauthentication class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>A <code>MeshTLSAuthentication</code> represents a set of mesh identities. When an
<a href=#authorizationpolicy>AuthorizationPolicy</a> has a <code>MeshTLSAuthentication</code> as one of its
<code>requiredAuthenticationRefs</code>, this means that clients must be in the mesh and
must have one of the specified identities in order to be authorized to send
to the target.</p><h3 id=meshtlsauthentication-spec class=anchor>MeshTLSAuthentication Spec
<a href=#meshtlsauthentication-spec class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>A <code>MeshTLSAuthentication</code> spec may contain the following top level fields:</p><div class=keyval><table><thead><tr><th>field</th><th>value</th></tr></thead><tbody><tr><td><code>identities</code></td><td>A list of mTLS identities to authenticate. The <code>*</code> prefix can be used to match all identities in a domain. An identity string of <code>*</code> indicates that all meshed clients are authorized.</td></tr><tr><td><code>identityRefs</code></td><td>A list of <a href=#targetref>targetRefs</a> to <code>ServiceAccounts</code> to authenticate.</td></tr></tbody></table></div><h3 id=meshtlsauthentication-examples class=anchor>MeshTLSAuthentication Examples
<a href=#meshtlsauthentication-examples class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>A <code>MeshTLSAuthentication</code> which authenticates the <code>books</code> and <code>webapp</code> mesh
identities.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#7ee787>apiVersion</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>policy.linkerd.io/v1alpha1</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>MeshTLSAuthentication</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>metadata</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>authors-get-authn</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>namespace</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>booksapp</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>spec</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>identities</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#a5d6ff>&#34;books.booksapp.serviceaccount.identity.linkerd.cluster.local&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#a5d6ff>&#34;webapp.booksapp.serviceaccount.identity.linkerd.cluster.local&#34;</span><span style=color:#6e7681>
</span></span></span></code></pre></div><p>A <code>MeshTLSAuthentication</code> which authenticate thes <code>books</code> and <code>webapp</code> mesh
identities. This is an alternative way to specify the same thing as the above
example.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#7ee787>apiVersion</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>policy.linkerd.io/v1alpha1</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>MeshTLSAuthentication</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>metadata</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>authors-get-authn</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>namespace</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>booksapp</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>spec</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>identityRefs</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>ServiceAccount</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>books</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>ServiceAccount</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>webapp</span><span style=color:#6e7681>
</span></span></span></code></pre></div><p>A <code>MeshTLSAuthentication</code> which authenticates all meshed identities.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#7ee787>apiVersion</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>policy.linkerd.io/v1alpha1</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>MeshTLSAuthentication</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>metadata</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>authors-get-authn</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>namespace</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>booksapp</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>spec</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>identities</span>:<span style=color:#6e7681> </span>[<span style=color:#a5d6ff>&#34;*&#34;</span>]<span style=color:#6e7681>
</span></span></span></code></pre></div><h2 id=networkauthentication class=anchor>NetworkAuthentication
<a href=#networkauthentication class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>A <code>NetworkAuthentication</code> represents a set of IP subnets. When an
<a href=#authorizationpolicy>AuthorizationPolicy</a> has a <code>NetworkAuthentication</code> as one of its
<code>requiredAuthenticationRefs</code>, this means that clients must be in one of the
specified networks in order to be authorized to send to the target.</p><h3 id=networkauthentication-spec class=anchor>NetworkAuthentication Spec
<a href=#networkauthentication-spec class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>A <code>NetworkAuthentication</code> spec may contain the following top level fields:</p><div class=keyval><table><thead><tr><th>field</th><th>value</th></tr></thead><tbody><tr><td><code>networks</code></td><td>A list of <a href=#network>networks</a> to authenticate.</td></tr></tbody></table></div><h4 id=network class=anchor>network
<a href=#network class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h4><p>A <code>network</code> defines an authenticated IP subnet.</p><div class=keyval><table><thead><tr><th>field</th><th>value</th></tr></thead><tbody><tr><td><code>cidr</code></td><td>A subnet in CIDR notation to authenticate.</td></tr><tr><td><code>except</code></td><td>A list of subnets in CIDR notation to exclude from the authentication.</td></tr></tbody></table></div><h3 id=networkauthentication-examples class=anchor>NetworkAuthentication Examples
<a href=#networkauthentication-examples class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>A <code>NetworkAuthentication</code> that authenticates clients which belong to any of
the specified CIDRs.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#7ee787>apiVersion</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>policy.linkerd.io/v1alpha1</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>NetworkAuthentication</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>metadata</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>cluster-network</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>namespace</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>booksapp</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>spec</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>networks</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>- <span style=color:#7ee787>cidr</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>10.0.0.0</span><span style=color:#a5d6ff>/8</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>- <span style=color:#7ee787>cidr</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>100.64.0.0</span><span style=color:#a5d6ff>/10</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>- <span style=color:#7ee787>cidr</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>172.16.0.0</span><span style=color:#a5d6ff>/12</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>- <span style=color:#7ee787>cidr</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>192.168.0.0</span><span style=color:#a5d6ff>/16</span><span style=color:#6e7681>
</span></span></span></code></pre></div><h2 id=serverauthorization class=anchor>ServerAuthorization
<a href=#serverauthorization class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>A <a href=#serverauthorization>ServerAuthorization</a> provides a way to authorize traffic to one or more
<a href=#server>Server</a>s.</p><div class="alert alert--info alert--callout"><div class=alert__title><svg class="icon icon--current" viewBox="0 0 24 24"><path d="M13 9H11V7h2m0 10H11V11h2M12 2A10 10 0 002 12 10 10 0 0012 22 10 10 0 0022 12 10 10 0 0012 2z"/></svg><h4>Note</h4></div><div class=alert__content><a href=#authorizationpolicy>AuthorizationPolicy</a> is a more flexible alternative to
<code>ServerAuthorization</code> that can target <a href=#httproute>HTTPRoutes</a> as well as
<a href=#server>Servers</a>. Use of <a href=#authorizationpolicy>AuthorizationPolicy</a> is
preferred, and <code>ServerAuthorization</code> will be deprecated in future releases.</div></div><h3 id=serverauthorization-spec class=anchor>ServerAuthorization Spec
<a href=#serverauthorization-spec class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>A ServerAuthorization spec must contain the following top level fields:</p><div class=keyval><table><thead><tr><th>field</th><th>value</th></tr></thead><tbody><tr><td><code>client</code></td><td>A <a href=#client>client</a> describes clients authorized to access a server.</td></tr><tr><td><code>server</code></td><td>A <a href=#serverref>serverRef</a> identifies <code>Servers</code> in the same namespace for which this authorization applies.</td></tr></tbody></table></div><h4 id=serverref class=anchor>serverRef
<a href=#serverref class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h4><p>A <code>serverRef</code> object must contain <em>exactly one</em> of the following fields:</p><div class=keyval><table><thead><tr><th>field</th><th>value</th></tr></thead><tbody><tr><td><code>name</code></td><td>References a <code>Server</code> instance by name.</td></tr><tr><td><code>selector</code></td><td>A <a href=#selector>selector</a> selects servers on which this authorization applies in the same namespace.</td></tr></tbody></table></div><h4 id=selector class=anchor>selector
<a href=#selector class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h4><p>This is the <a href=https://kubernetes.io/docs/reference/kubernetes-api/common-definitions/label-selector/#LabelSelector target=_blank rel=noopener>same labelSelector field in Kubernetes</a>.
All the servers that are part of this selector will have this authorization applied.
A selector object must contain <em>exactly one</em> of the following fields:</p><div class=keyval><table><thead><tr><th>field</th><th>value</th></tr></thead><tbody><tr><td><code>matchExpressions</code></td><td>A list of label selector requirements. The requirements are ANDed.</td></tr><tr><td><code>matchLabels</code></td><td>A map of {key,value} pairs.</td></tr></tbody></table></div><p>See <a href=https://kubernetes.io/docs/reference/kubernetes-api/common-definitions/label-selector/#LabelSelector target=_blank rel=noopener>the Kubernetes LabelSelector reference</a>
for more details.</p><h4 id=client class=anchor>client
<a href=#client class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h4><p>A <code>client</code> object must contain <em>exactly one</em> of the following fields:</p><div class=keyval><table><thead><tr><th>field</th><th>value</th></tr></thead><tbody><tr><td><code>meshTLS</code></td><td>A <a href=#meshtls>meshTLS</a> is used to authorize meshed clients to access a server.</td></tr><tr><td><code>unauthenticated</code></td><td>A boolean value that authorizes unauthenticated clients to access a server.</td></tr></tbody></table></div><p>Optionally, it can also contain the <code>networks</code> field:</p><div class=keyval><table><thead><tr><th>field</th><th>value</th></tr></thead><tbody><tr><td><code>networks</code></td><td>Limits the client IP addresses to which this authorization applies. If unset, the server chooses a default (typically, all IPs or the cluster&rsquo;s pod network).</td></tr></tbody></table></div><h4 id=meshtls class=anchor>meshTLS
<a href=#meshtls class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h4><p>A <code>meshTLS</code> object must contain <em>exactly one</em> of the following fields:</p><div class=keyval><table><thead><tr><th>field</th><th>value</th></tr></thead><tbody><tr><td><code>unauthenticatedTLS</code></td><td>A boolean to indicate that no client identity is required for communication. This is mostly important for the identity controller, which must terminate TLS connections from clients that do not yet have a certificate.</td></tr><tr><td><code>identities</code></td><td>A list of proxy identity strings (as provided via mTLS) that are authorized. The <code>*</code> prefix can be used to match all identities in a domain. An identity string of <code>*</code> indicates that all authentication clients are authorized.</td></tr><tr><td><code>serviceAccounts</code></td><td>A list of authorized client <a href=#serviceAccount>serviceAccount</a>s (as provided via mTLS).</td></tr></tbody></table></div><h4 id=serviceaccount class=anchor>serviceAccount
<a href=#serviceaccount class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h4><p>A serviceAccount field contains the following top level fields:</p><div class=keyval><table><thead><tr><th>field</th><th>value</th></tr></thead><tbody><tr><td><code>name</code></td><td>The ServiceAccount&rsquo;s name.</td></tr><tr><td><code>namespace</code></td><td>The ServiceAccount&rsquo;s namespace. If unset, the authorization&rsquo;s namespace is used.</td></tr></tbody></table></div><h3 id=serverauthorization-examples class=anchor>ServerAuthorization Examples
<a href=#serverauthorization-examples class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>A <a href=#serverauthorization>ServerAuthorization</a> that allows meshed clients with
<code>*.emojivoto.serviceaccount.identity.linkerd.cluster.local</code> proxy identity i.e. all
service accounts in the <code>emojivoto</code> namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#7ee787>apiVersion</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>policy.linkerd.io/v1beta1</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>ServerAuthorization</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>metadata</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>namespace</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>emojivoto</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>emoji-grpc</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>spec</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># Allow all authenticated clients to access the (read-only) emoji service.</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>server</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>selector</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>matchLabels</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>app</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>emoji-svc</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>client</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>meshTLS</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>identities</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#34;*.emojivoto.serviceaccount.identity.linkerd.cluster.local&#34;</span><span style=color:#6e7681>
</span></span></span></code></pre></div><p>A <a href=#serverauthorization>ServerAuthorization</a> that allows any unauthenticated
clients.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#7ee787>apiVersion</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>policy.linkerd.io/v1beta1</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>ServerAuthorization</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>metadata</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>namespace</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>emojivoto</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>web-public</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>spec</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>server</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>web-http</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># Allow all clients to access the web HTTP port without regard for</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># authentication. If unauthenticated connections are permitted, there is no</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># need to describe authenticated clients.</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>client</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>unauthenticated</span>:<span style=color:#6e7681> </span><span style=color:#79c0ff>true</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>networks</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>cidr</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>0.0.0.0</span><span style=color:#a5d6ff>/0</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>cidr</span>:<span style=color:#6e7681> </span>::<span style=color:#a5d6ff>/0</span><span style=color:#6e7681>
</span></span></span></code></pre></div><p>A <a href=#serverauthorization>ServerAuthorization</a> that allows meshed clients with a
specific service account.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#7ee787>apiVersion</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>policy.linkerd.io/v1beta1</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>kind</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>ServerAuthorization</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>metadata</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>namespace</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>emojivoto</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>prom-prometheus</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>spec</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>server</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>prom</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>client</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>meshTLS</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>serviceAccounts</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#7ee787>namespace</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>linkerd-viz</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>prometheus</span><span style=color:#6e7681>
</span></span></span></code></pre></div></div></div></div></div></div></main><footer class=main-footer><div class=main-footer__top><div class="main-footer__container container"><div class=main-footer__info><p><img src=/logos/linkerd.png alt=Linkerd></p><p>Linkerd was originally created by <a href=https://buoyant.io/ target=_blank rel=noopener>Buoyant</a></p><p>View <a href=https://github.com/linkerd/linkerd/wiki/Linkerd-code-of-conduct target=_blank rel=noopener>Code of Conduct</a></p></div><div class=main-footer__links><div class=main-footer__community><h4>Community</h4><ul><li><a href=https://github.com/linkerd/linkerd2 target=_blank rel=noopener>GitHub</a></li><li><a href=https://slack.linkerd.io target=_blank rel=noopener>Slack</a></li><li><a href=https://linkerd.buoyant.io target=_blank rel=noopener>Linkerd Forum</a></li></ul></div><div class=main-footer__follow><h4>Follow</h4><ul><li><a href=https://www.linkedin.com/company/linkerd/ target=_blank rel=noopener>Linkedin</a></li><li><a href=https://www.youtube.com/buoyantio target=_blank rel=noopener>YouTube</a></li><li><a href=https://twitter.com/linkerd target=_blank rel=noopener>Twitter</a></li></ul></div></div></div></div><div class=main-footer__bottom><div class="main-footer__container container"><p><a href=https://github.com/linkerd/website/tree/main/linkerd.io/content target=_blank rel=noopener>Edit This Site</a></p><p>Copyright © 2024 Linkerd Authors. All rights reserved.</p></div></div></footer></body></html>