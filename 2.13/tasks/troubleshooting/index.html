<!doctype html><html lang=en><head><meta charset=utf-8><title>Troubleshooting | Linkerd</title>
<link rel="shortcut icon" href=/favicon.png><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Troubleshoot issues with your Linkerd installation."><meta property="og:url" content="https://travisbeckham.github.io/2.13/tasks/troubleshooting/"><meta property="og:site_name" content="Linkerd"><meta property="og:title" content="Troubleshooting"><meta property="og:description" content="Troubleshoot issues with your Linkerd installation."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="2.13"><meta property="og:image" content="https://travisbeckham.github.io/logos/linkerd.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://travisbeckham.github.io/logos/linkerd.png"><meta name=twitter:title content="Troubleshooting"><meta name=twitter:description content="Troubleshoot issues with your Linkerd installation."><meta name=twitter:site content="@Linkerd"><link rel=canonical href=https://travisbeckham.github.io/2.13/tasks/troubleshooting/><link rel=stylesheet href=/css/main.css><script src=/js/main.js></script><script async defer src=https://buttons.github.io/buttons.js></script></head><body><header class=main-header><div class=main-header__container><div class=main-header__logo><a href=/><img src=/logos/linkerd.png alt=Linkerd></a></div><input class=main-header__toggle-checkbox type=checkbox id=main-header-toggle>
<label class=main-header__toggle for=main-header-toggle><span class=main-header__toggle-icon><span class=main-header__toggle-icon--open><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3 6H21V8H3V6m0 5H21v2H3V11m0 5H21v2H3V16z"/></svg>
</span><span class=main-header__toggle-icon--close><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg></span></span></label><div class=main-header__nav><nav class=main-nav><ul class=main-nav__menu><li class=main-nav__menu--selected><a href=/docs>Docs</a></li><li><a href=#>Community<svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M7.41 8.58 12 13.17l4.59-4.59L18 10l-6 6-6-6L7.41 8.58z"/></svg></a><ul><li><a href=/community/get-involved/>Get Involved</a></li><li><a href=/community/adopters/>Adopters</a></li><li><a href=/community/ambassadors/>Linkerd Ambassadors</a></li><li><a href=https://linkerd.buoyant.io target=_blank rel=noopener>Buoyant's Linkerd Forum</a></li></ul></li><li><a href=/blog/>Blog</a></li><li><a href=/faq/>FAQ</a></li><li><a href=/enterprise/>Enterprise</a></li></ul><div class=main-nav__search><form action=/search method=get><div class="search-input search-input--sm"><svg class="icon" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5.0 0116 9.5c0 1.61-.59 3.09-1.56 4.23L14.71 14H15.5l5 5L19 20.5l-5-5V14.71L13.73 14.44C12.59 15.41 11.11 16 9.5 16A6.5 6.5.0 013 9.5 6.5 6.5.0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
<input type=text name=q placeholder=Search></div></form></div><div class=main-nav__github><a class=github-button href=https://github.com/linkerd/linkerd2 data-icon=octicon-star data-size=large data-show-count=true aria-label="Star linkerd/linkerd2 on GitHub">Star</a></div><div class=main-nav__forum><a href=https://linkerd.buoyant.io class="button button--primary button--sm" target=_blank rel=noopener>Join Forum</a></div></nav></div></div></header><div class=main-announcement>Service Mesh 101: Get Service Mesh-Certified
<span class=main-announcement__link><a href=https://buoyant.io/courses/service-mesh-101 target=_blank rel=noopener>Enroll now</a></span></div><main class=main-content><div class="alert alert--warning alert--condensed alert--center docs__deprecated-alert"><div class=alert__content>You are viewing docs for an older version of Linkerd.
<a href=/2.16/>View the latest docs</a>.</div></div><div class=docs><div class=docs__container><div class=docs__sidebar><div class=docs__nav><div class=docs__versions><select onchange="window.location.href=this.value"><option value=/2-edge/>Linkerd edge</option><option value=/2.16/>Linkerd 2.16</option><option value=/2.15/>Linkerd 2.15</option><option value=/2.14/>Linkerd 2.14</option><option value=/2.13/ selected>Linkerd 2.13</option><option value=/2.12/>Linkerd 2.12</option><option value=/2.11/>Linkerd 2.11</option><option value=/2.10/>Linkerd 2.10</option></select></div><nav><ul><li><a href=/2.13/overview/>Overview</a></li><li><a href=/2.13/getting-started/>Getting Started</a></li><li><a href=/2.13/features/>Features
</a><input class=toggle__input type=checkbox id=toggle-eb69f9fda3cfd87e9a8e70073ecd9ca5>
<label class=toggle__label for=toggle-eb69f9fda3cfd87e9a8e70073ecd9ca5><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2.13/features/http-grpc/>HTTP, HTTP/2, and gRPC Proxying</a></li><li><a href=/2.13/features/protocol-detection/>TCP Proxying and Protocol Detection</a></li><li><a href=/2.13/features/retries-and-timeouts/>Retries and Timeouts</a></li><li><a href=/2.13/features/automatic-mtls/>Automatic mTLS</a></li><li><a href=/2.13/features/ingress/>Ingress</a></li><li><a href=/2.13/features/telemetry/>Telemetry and Monitoring</a></li><li><a href=/2.13/features/load-balancing/>Load Balancing</a></li><li><a href=/2.13/features/server-policy/>Authorization Policy</a></li><li><a href=/2.13/features/proxy-injection/>Automatic Proxy Injection</a></li><li><a href=/2.13/features/cni/>CNI Plugin</a></li><li><a href=/2.13/features/dashboard/>Dashboard and on-cluster metrics stack</a></li><li><a href=/2.13/features/distributed-tracing/>Distributed Tracing</a></li><li><a href=/2.13/features/request-routing/>Dynamic Request Routing</a></li><li><a href=/2.13/features/fault-injection/>Fault Injection</a></li><li><a href=/2.13/features/ha/>High Availability</a></li><li><a href=/2.13/features/access-logging/>HTTP Access Logging</a></li><li><a href=/2.13/features/nft/>Iptables-nft Support</a></li><li><a href=/2.13/features/multicluster/>Multi-cluster communication</a></li><li><a href=/2.13/features/service-profiles/>Service Profiles</a></li><li><a href=/2.13/features/traffic-split/>Traffic Split (canaries, blue/green deploys)</a></li></ul></li><li class=docs__nav--selected><a href=/2.13/tasks/>Tasks
</a><input class=toggle__input type=checkbox id=toggle-7a7cef84ddbcc31f1bd5f18df32ee069 checked>
<label class=toggle__label for=toggle-7a7cef84ddbcc31f1bd5f18df32ee069><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2.13/tasks/adding-your-service/>Adding your services to Linkerd</a></li><li><a href=/2.13/tasks/automatic-failover/>Automatic Multicluster Failover</a></li><li><a href=/2.13/tasks/automatically-rotating-control-plane-tls-credentials/>Automatically Rotating Control Plane TLS Credentials</a></li><li><a href=/2.13/tasks/automatically-rotating-webhook-tls-credentials/>Automatically Rotating Webhook TLS Credentials</a></li><li><a href=/2.13/tasks/external-prometheus/>Bringing your own Prometheus</a></li><li><a href=/2.13/tasks/circuit-breakers/>Circuit Breakers</a></li><li><a href=/2.13/tasks/configuring-dynamic-request-routing/>Configuring Dynamic Request Routing</a></li><li><a href=/2.13/tasks/configuring-per-route-policy/>Configuring Fine-grained Authorization Policy</a></li><li><a href=/2.13/tasks/configuring-proxy-concurrency/>Configuring Proxy Concurrency</a></li><li><a href=/2.13/tasks/configuring-retries/>Configuring Retries</a></li><li><a href=/2.13/tasks/configuring-timeouts/>Configuring Timeouts</a></li><li><a href=/2.13/tasks/using-debug-endpoints/>Control Plane Debug Endpoints</a></li><li><a href=/2.13/tasks/customize-install/>Customizing Linkerd's Configuration with Kustomize</a></li><li><a href=/2.13/tasks/debugging-502s/>Debugging 502s</a></li><li><a href=/2.13/tasks/debugging-your-service/>Debugging gRPC applications with request tracing</a></li><li><a href=/2.13/tasks/books/>Debugging HTTP applications with per-route metrics</a></li><li><a href=/2.13/tasks/distributed-tracing/>Distributed tracing with Linkerd</a></li><li><a href=/2.13/tasks/exporting-metrics/>Exporting Metrics</a></li><li><a href=/2.13/tasks/exposing-dashboard/>Exposing the Dashboard</a></li><li><a href=/2.13/tasks/generate-certificates/>Generating your own mTLS root certificates</a></li><li><a href=/2.13/tasks/getting-per-route-metrics/>Getting Per-Route Metrics</a></li><li><a href=/2.13/tasks/linkerd-smi/>Getting started with Linkerd SMI extension</a></li><li><a href=/2.13/tasks/graceful-shutdown/>Graceful Pod Shutdown</a></li><li><a href=/2.13/tasks/grafana/>Grafana</a></li><li><a href=/2.13/tasks/using-ingress/>Handling ingress traffic</a></li><li><a href=/2.13/tasks/fault-injection/>Injecting Faults</a></li><li><a href=/2.13/tasks/install/>Installing Linkerd</a></li><li><a href=/2.13/tasks/install-helm/>Installing Linkerd with Helm</a></li><li><a href=/2.13/tasks/installing-multicluster/>Installing Multi-cluster Components</a></li><li><a href=/2.13/tasks/using-psp/>Linkerd and Pod Security Policies (PSP)</a></li><li><a href=/2.13/tasks/manually-rotating-control-plane-tls-credentials/>Manually Rotating Control Plane TLS Credentials</a></li><li><a href=/2.13/tasks/modifying-proxy-log-level/>Modifying the Proxy Log Level</a></li><li><a href=/2.13/tasks/multicluster/>Multi-cluster communication</a></li><li><a href=/2.13/tasks/multicluster-using-statefulsets/>Multi-cluster communication with StatefulSets</a></li><li><a href=/2.13/tasks/flagger/>Progressive Delivery with Flagger</a></li><li><a href=/2.13/tasks/replacing_expired_certificates/>Replacing expired certificates</a></li><li><a href=/2.13/tasks/restricting-access/>Restricting Access To Services</a></li><li><a href=/2.13/tasks/rotating_webhooks_certificates/>Rotating webhooks certificates</a></li><li><a href=/2.13/tasks/securing-linkerd-tap/>Securing Linkerd Tap</a></li><li><a href=/2.13/tasks/setting-up-service-profiles/>Setting Up Service Profiles</a></li><li><a href=/2.13/tasks/traffic-shifting/>Traffic Shifting</a></li><li class=docs__nav--selected><a href=/2.13/tasks/troubleshooting/>Troubleshooting</a></li><li><a href=/2.13/tasks/uninstall/>Uninstalling Linkerd</a></li><li><a href=/2.13/tasks/uninstall-multicluster/>Uninstalling Multicluster</a></li><li><a href=/2.13/tasks/upgrade/>Upgrading Linkerd</a></li><li><a href=/2.13/tasks/using-custom-domain/>Using a Custom Cluster Domain</a></li><li><a href=/2.13/tasks/using-a-private-docker-repository/>Using A Private Docker Repository</a></li><li><a href=/2.13/tasks/extensions/>Using extensions</a></li><li><a href=/2.13/tasks/gitops/>Using GitOps with Linkerd with Argo CD</a></li><li><a href=/2.13/tasks/using-the-debug-container/>Using the Debug Sidecar</a></li><li><a href=/2.13/tasks/validating-your-traffic/>Validating your mTLS traffic</a></li></ul></li><li><a href=/2.13/reference/>Reference
</a><input class=toggle__input type=checkbox id=toggle-0bb183e885edaf2a0044b607cfb98a06>
<label class=toggle__label for=toggle-0bb183e885edaf2a0044b607cfb98a06><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2.13/reference/architecture/>Architecture</a></li><li><a href=/2.13/reference/authorization-policy/>Authorization Policy</a></li><li><a href=/2.13/reference/circuit-breaking/>Circuit Breaking</a></li><li><a href=/2.13/reference/cli/>CLI
</a><input class=toggle__input type=checkbox id=toggle-d6775a64e9a2f59c8f4dab50b7c8b796>
<label class=toggle__label for=toggle-d6775a64e9a2f59c8f4dab50b7c8b796><svg class="icon icon--secondary" viewBox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg></label><ul class=toggle__target><li><a href=/2.13/reference/cli/authz/>authz</a></li><li><a href=/2.13/reference/cli/check/>check</a></li><li><a href=/2.13/reference/cli/completion/>completion</a></li><li><a href=/2.13/reference/cli/diagnostics/>diagnostics</a></li><li><a href=/2.13/reference/cli/identity/>identity</a></li><li><a href=/2.13/reference/cli/inject/>inject</a></li><li><a href=/2.13/reference/cli/install/>install</a></li><li><a href=/2.13/reference/cli/install-cni/>install-cni</a></li><li><a href=/2.13/reference/cli/jaeger/>jaeger</a></li><li><a href=/2.13/reference/cli/multicluster/>multicluster</a></li><li><a href=/2.13/reference/cli/profile/>profile</a></li><li><a href=/2.13/reference/cli/prune/>prune</a></li><li><a href=/2.13/reference/cli/uninject/>uninject</a></li><li><a href=/2.13/reference/cli/uninstall/>uninstall</a></li><li><a href=/2.13/reference/cli/upgrade/>upgrade</a></li><li><a href=/2.13/reference/cli/version/>version</a></li><li><a href=/2.13/reference/cli/viz/>viz</a></li></ul></li><li><a href=/2.13/reference/cluster-configuration/>Cluster Configuration</a></li><li><a href=/2.13/reference/extension-list/>Extensions List</a></li><li><a href=/2.13/reference/helm-chart-version-matrix/>Helm Chart Version Matrix</a></li><li><a href=/2.13/reference/httproute/>HTTPRoute</a></li><li><a href=/2.13/reference/iptables/>IPTables Reference</a></li><li><a href=/2.13/reference/proxy-configuration/>Proxy Configuration</a></li><li><a href=/2.13/reference/proxy-log-level/>Proxy Log Level</a></li><li><a href=/2.13/reference/proxy-metrics/>Proxy Metrics</a></li><li><a href=/2.13/reference/service-profiles/>Service Profiles</a></li></ul></li></ul><ul><li><a href=/what-is-a-service-mesh/>What is a service mesh?</a></li><li><a href=/faq/>Frequently Asked Questions</a></li><li><a href=/releases/>Releases and Versions</a></li><li><a href=/design-principles/>Design Principles</a></li><li><a href=/going-to-production/>Going to Production</a></li><li><a href=/service-mesh-glossary/>Service Mesh Glossary</a></li></ul></nav><div class=docs__community><ul><li><a href=https://github.com/linkerd/linkerd2 target=_blank rel=noopener><img src=/logos/github.svg alt=GitHub class=img></a></li><li><a href=https://slack.linkerd.io target=_blank rel=noopener><img src=/logos/slack.svg alt=Slack class=img></a></li><li><a href=https://linkerd.buoyant.io target=_blank rel=noopener><img src=/logos/forum.png alt="Linkerd Forum" class=img></a></li></ul></div></div></div><div class=docs__main><div class=docs__body><div class=docs__header><h1>Troubleshooting</h1></div><div class="docs__content prose"><p>This section provides resolution steps for common problems reported with the
<code>linkerd check</code> command.</p><h2 id=pre-k8s-cluster class=anchor>The &ldquo;pre-kubernetes-cluster-setup&rdquo; checks
<a href=#pre-k8s-cluster class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>These checks only run when the <code>--pre</code> flag is set. This flag is intended for
use prior to running <code>linkerd install</code>, to verify your cluster is prepared for
installation.</p><h3 id=pre-ns class=anchor>√ control plane namespace does not already exist
<a href=#pre-ns class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× control plane namespace does not already exist
</span></span><span style=display:flex><span>    The <span style=color:#a5d6ff>&#34;linkerd&#34;</span> namespace already exists
</span></span></code></pre></div><p>By default <code>linkerd install</code> will create a <code>linkerd</code> namespace. Prior to
installation, that namespace should not exist. To check with a different
namespace, run:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd check --pre --linkerd-namespace linkerd-test
</span></span></code></pre></div><h3 id=pre-k8s-cluster-k8s class=anchor>√ can create Kubernetes resources
<a href=#pre-k8s-cluster-k8s class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>The subsequent checks in this section validate whether you have permission to
create the Kubernetes resources required for Linkerd installation, specifically:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>√ can create Namespaces
</span></span><span style=display:flex><span>√ can create ClusterRoles
</span></span><span style=display:flex><span>√ can create ClusterRoleBindings
</span></span><span style=display:flex><span>√ can create CustomResourceDefinitions
</span></span></code></pre></div><h2 id=pre-k8s class=anchor>The &ldquo;pre-kubernetes-setup&rdquo; checks
<a href=#pre-k8s class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>These checks only run when the <code>--pre</code> flag is set This flag is intended for use
prior to running <code>linkerd install</code>, to verify you have the correct RBAC
permissions to install Linkerd.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>√ can create Namespaces
</span></span><span style=display:flex><span>√ can create ClusterRoles
</span></span><span style=display:flex><span>√ can create ClusterRoleBindings
</span></span><span style=display:flex><span>√ can create CustomResourceDefinitions
</span></span><span style=display:flex><span>√ can create PodSecurityPolicies
</span></span><span style=display:flex><span>√ can create ServiceAccounts
</span></span><span style=display:flex><span>√ can create Services
</span></span><span style=display:flex><span>√ can create Deployments
</span></span><span style=display:flex><span>√ can create ConfigMaps
</span></span></code></pre></div><h3 id=pre-k8s-clock-skew class=anchor>√ no clock skew detected
<a href=#pre-k8s-clock-skew class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This check detects any differences between the system running the
<code>linkerd install</code> command and the Kubernetes nodes (known as clock skew). Having
a substantial clock skew can cause TLS validation problems because a node may
determine that a TLS certificate is expired when it should not be, or vice
versa.</p><p>Linkerd version edge-20.3.4 and later check for a difference of at most 5
minutes and older versions of Linkerd (including stable-2.7) check for a
difference of at most 1 minute. If your Kubernetes node heartbeat interval is
longer than this difference, you may experience false positives of this check.
The default node heartbeat interval was increased to 5 minutes in Kubernetes
1.17 meaning that users running Linkerd versions prior to edge-20.3.4 on
Kubernetes 1.17 or later are likely to experience these false positives. If this
is the case, you can upgrade to Linkerd edge-20.3.4 or later. If you choose to
ignore this error, we strongly recommend that you verify that your system clocks
are consistent.</p><h2 id=pre-k8s-capability class=anchor>The &ldquo;pre-kubernetes-capability&rdquo; checks
<a href=#pre-k8s-capability class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>These checks only run when the <code>--pre</code> flag is set. This flag is intended for
use prior to running <code>linkerd install</code>, to verify you have the correct
Kubernetes capability permissions to install Linkerd.</p><h2 id=pre-l5d-existence class=anchor>The &ldquo;pre-linkerd-global-resources&rdquo; checks
<a href=#pre-l5d-existence class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>These checks only run when the <code>--pre</code> flag is set. This flag is intended for
use prior to running <code>linkerd install</code>, to verify you have not already installed
the Linkerd control plane.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>√ no ClusterRoles exist
</span></span><span style=display:flex><span>√ no ClusterRoleBindings exist
</span></span><span style=display:flex><span>√ no CustomResourceDefinitions exist
</span></span><span style=display:flex><span>√ no MutatingWebhookConfigurations exist
</span></span><span style=display:flex><span>√ no ValidatingWebhookConfigurations exist
</span></span><span style=display:flex><span>√ no PodSecurityPolicies exist
</span></span></code></pre></div><h2 id=pre-single class=anchor>The &ldquo;pre-kubernetes-single-namespace-setup&rdquo; checks
<a href=#pre-single class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>If you do not expect to have the permission for a full cluster install, try the
<code>--single-namespace</code> flag, which validates if Linkerd can be installed in a
single namespace, with limited cluster access:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd check --pre --single-namespace
</span></span></code></pre></div><h2 id=k8s-api class=anchor>The &ldquo;kubernetes-api&rdquo; checks
<a href=#k8s-api class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>Example failures:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× can initialize the client
</span></span><span style=display:flex><span>    error configuring Kubernetes API client: stat badconfig: no such file or directory
</span></span><span style=display:flex><span>× can query the Kubernetes API
</span></span><span style=display:flex><span>    Get https://8.8.8.8/version: dial tcp 8.8.8.8:443: i/o timeout
</span></span></code></pre></div><p>Ensure that your system is configured to connect to a Kubernetes cluster.
Validate that the <code>KUBECONFIG</code> environment variable is set properly, and/or
<code>~/.kube/config</code> points to a valid cluster.</p><p>For more information see these pages in the Kubernetes Documentation:</p><ul><li><a href=https://kubernetes.io/docs/tasks/access-application-cluster/access-cluster/ target=_blank rel=noopener>Accessing Clusters</a></li><li><a href=https://kubernetes.io/docs/tasks/access-application-cluster/configure-access-multiple-clusters/ target=_blank rel=noopener>Configure Access to Multiple Clusters</a></li></ul><p>Also verify that these command works:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config view
</span></span><span style=display:flex><span>kubectl cluster-info
</span></span><span style=display:flex><span>kubectl version
</span></span></code></pre></div><p>Another example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>✘ can query the Kubernetes API
</span></span><span style=display:flex><span>    Get REDACTED/version: x509: certificate signed by unknown authority
</span></span></code></pre></div><p>As an (unsafe) workaround to this, you may try:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config set-cluster <span style=color:#a5d6ff>${</span><span style=color:#79c0ff>KUBE_CONTEXT</span><span style=color:#a5d6ff>}</span> --insecure-skip-tls-verify<span style=color:#ff7b72;font-weight:700>=</span>true <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>    --server<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>${</span><span style=color:#79c0ff>KUBE_CONTEXT</span><span style=color:#a5d6ff>}</span>
</span></span></code></pre></div><h2 id=the-kubernetes-version-checks class=anchor>The &ldquo;kubernetes-version&rdquo; checks
<a href=#the-kubernetes-version-checks class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><h3 id=k8s-version class=anchor>√ is running the minimum Kubernetes API version
<a href=#k8s-version class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× is running the minimum Kubernetes API version
</span></span><span style=display:flex><span>    Kubernetes is on version <span style=color:#ff7b72;font-weight:700>[</span>1.7.16<span style=color:#ff7b72;font-weight:700>]</span>, but version <span style=color:#ff7b72;font-weight:700>[</span>1.13.0<span style=color:#ff7b72;font-weight:700>]</span> or more recent is required
</span></span></code></pre></div><p>Linkerd requires at least version <code>1.13.0</code>. Verify your cluster version with:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl version
</span></span></code></pre></div><h3 id=kubectl-version class=anchor>√ is running the minimum kubectl version
<a href=#kubectl-version class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× is running the minimum kubectl version
</span></span><span style=display:flex><span>    kubectl is on version <span style=color:#ff7b72;font-weight:700>[</span>1.9.1<span style=color:#ff7b72;font-weight:700>]</span>, but version <span style=color:#ff7b72;font-weight:700>[</span>1.13.0<span style=color:#ff7b72;font-weight:700>]</span> or more recent is required
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#kubectl-version <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Linkerd requires at least version <code>1.13.0</code>. Verify your kubectl version with:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl version --client --short
</span></span></code></pre></div><p>To fix please update kubectl version.</p><p>For more information on upgrading Kubernetes, see the page in the Kubernetes
Documentation.</p><h2 id=l5d-config class=anchor>The &ldquo;linkerd-config&rdquo; checks
<a href=#l5d-config class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>This category of checks validates that Linkerd&rsquo;s cluster-wide RBAC and related
resources have been installed.</p><h3 id=l5d-existence-ns class=anchor>√ control plane Namespace exists
<a href=#l5d-existence-ns class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× control plane Namespace exists
</span></span><span style=display:flex><span>    The <span style=color:#a5d6ff>&#34;foo&#34;</span> namespace does not exist
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-existence-ns <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure the Linkerd control plane namespace exists:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get ns
</span></span></code></pre></div><p>The default control plane namespace is <code>linkerd</code>. If you installed Linkerd into
a different namespace, specify that in your check command:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd check --linkerd-namespace linkerdtest
</span></span></code></pre></div><h3 id=l5d-existence-cr class=anchor>√ control plane ClusterRoles exist
<a href=#l5d-existence-cr class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× control plane ClusterRoles exist
</span></span><span style=display:flex><span>    missing ClusterRoles: linkerd-linkerd-identity
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-existence-cr <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure the Linkerd ClusterRoles exist:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get clusterroles | grep linkerd
</span></span><span style=display:flex><span>linkerd-linkerd-destination                                            9d
</span></span><span style=display:flex><span>linkerd-linkerd-identity                                               9d
</span></span><span style=display:flex><span>linkerd-linkerd-proxy-injector                                         9d
</span></span><span style=display:flex><span>linkerd-policy                                                         9d
</span></span></code></pre></div><p>Also ensure you have permission to create ClusterRoles:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl auth can-i create clusterroles
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=l5d-existence-crb class=anchor>√ control plane ClusterRoleBindings exist
<a href=#l5d-existence-crb class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× control plane ClusterRoleBindings exist
</span></span><span style=display:flex><span>    missing ClusterRoleBindings: linkerd-linkerd-identity
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-existence-crb <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure the Linkerd ClusterRoleBindings exist:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get clusterrolebindings | grep linkerd
</span></span><span style=display:flex><span>linkerd-linkerd-destination                            9d
</span></span><span style=display:flex><span>linkerd-linkerd-identity                               9d
</span></span><span style=display:flex><span>linkerd-linkerd-proxy-injector                         9d
</span></span><span style=display:flex><span>linkerd-destination-policy                             9d
</span></span></code></pre></div><p>Also ensure you have permission to create ClusterRoleBindings:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl auth can-i create clusterrolebindings
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=l5d-existence-sa class=anchor>√ control plane ServiceAccounts exist
<a href=#l5d-existence-sa class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× control plane ServiceAccounts exist
</span></span><span style=display:flex><span>    missing ServiceAccounts: linkerd-identity
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-existence-sa <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure the Linkerd ServiceAccounts exist:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n linkerd get serviceaccounts
</span></span><span style=display:flex><span>NAME                     SECRETS   AGE
</span></span><span style=display:flex><span>default                  <span style=color:#a5d6ff>1</span>         14m
</span></span><span style=display:flex><span>linkerd-destination      <span style=color:#a5d6ff>1</span>         14m
</span></span><span style=display:flex><span>linkerd-heartbeat        <span style=color:#a5d6ff>1</span>         14m
</span></span><span style=display:flex><span>linkerd-identity         <span style=color:#a5d6ff>1</span>         14m
</span></span><span style=display:flex><span>linkerd-proxy-injector   <span style=color:#a5d6ff>1</span>         14m
</span></span></code></pre></div><p>Also ensure you have permission to create ServiceAccounts in the Linkerd
namespace:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n linkerd auth can-i create serviceaccounts
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=l5d-existence-crd class=anchor>√ control plane CustomResourceDefinitions exist
<a href=#l5d-existence-crd class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× control plane CustomResourceDefinitions exist
</span></span><span style=display:flex><span>    missing CustomResourceDefinitions: serviceprofiles.linkerd.io
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-existence-crd <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure the Linkerd CRD exists:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get customresourcedefinitions
</span></span><span style=display:flex><span>NAME                         CREATED AT
</span></span><span style=display:flex><span>serviceprofiles.linkerd.io   2019-04-25T21:47:31Z
</span></span></code></pre></div><p>Also ensure you have permission to create CRDs:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl auth can-i create customresourcedefinitions
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=l5d-existence-mwc class=anchor>√ control plane MutatingWebhookConfigurations exist
<a href=#l5d-existence-mwc class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× control plane MutatingWebhookConfigurations exist
</span></span><span style=display:flex><span>    missing MutatingWebhookConfigurations: linkerd-proxy-injector-webhook-config
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-existence-mwc <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure the Linkerd MutatingWebhookConfigurations exists:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get mutatingwebhookconfigurations | grep linkerd
</span></span><span style=display:flex><span>linkerd-proxy-injector-webhook-config   2019-07-01T13:13:26Z
</span></span></code></pre></div><p>Also ensure you have permission to create MutatingWebhookConfigurations:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl auth can-i create mutatingwebhookconfigurations
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=l5d-existence-vwc class=anchor>√ control plane ValidatingWebhookConfigurations exist
<a href=#l5d-existence-vwc class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× control plane ValidatingWebhookConfigurations exist
</span></span><span style=display:flex><span>    missing ValidatingWebhookConfigurations: linkerd-sp-validator-webhook-config
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-existence-vwc <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure the Linkerd ValidatingWebhookConfiguration exists:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get validatingwebhookconfigurations | grep linkerd
</span></span><span style=display:flex><span>linkerd-sp-validator-webhook-config   2019-07-01T13:13:26Z
</span></span></code></pre></div><p>Also ensure you have permission to create ValidatingWebhookConfigurations:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl auth can-i create validatingwebhookconfigurations
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=l5d-proxy-init-run-as-root class=anchor>√ proxy-init container runs as root if docker container runtime is used
<a href=#l5d-proxy-init-run-as-root class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× proxy-init container runs as root user <span style=color:#ff7b72>if</span> docker container runtime is used
</span></span><span style=display:flex><span>    there are nodes using the docker container runtime and proxy-init container must run as root user.
</span></span><span style=display:flex><span>try installing linkerd via --set proxyInit.runAsRoot<span style=color:#ff7b72;font-weight:700>=</span>true
</span></span><span style=display:flex><span>    see https://linkerd.io/2.11/checks/#l5d-proxy-init-run-as-root <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Kubernetes nodes running with docker as the container runtime (<a href=https://kubernetes.io/docs/concepts/architecture/cri/ target=_blank rel=noopener>CRI</a>)
require the init container to run as root for iptables.</p><p>Newer distributions of managed k8s use containerd where this is not an issue.</p><p>Without root in the init container you might get errors such as:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#79c0ff>time</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;2021-11-15T04:41:31Z&#34;</span> <span style=color:#79c0ff>level</span><span style=color:#ff7b72;font-weight:700>=</span>info <span style=color:#79c0ff>msg</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;iptables-save -t nat&#34;</span>
</span></span><span style=display:flex><span>Error: exit status <span style=color:#a5d6ff>1</span>
</span></span><span style=display:flex><span><span style=color:#79c0ff>time</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;2021-11-15T04:41:31Z&#34;</span> <span style=color:#79c0ff>level</span><span style=color:#ff7b72;font-weight:700>=</span>info <span style=color:#79c0ff>msg</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;iptables-save v1.8.7 (legacy): Cannot initialize: Permission denied (you must be root)\n\n&#34;</span>
</span></span></code></pre></div><p>See <a href=https://github.com/linkerd/linkerd2/issues/7283 target=_blank rel=noopener>linkerd/linkerd2#7283</a> and
<a href=https://github.com/linkerd/linkerd2/issues/7308 target=_blank rel=noopener>linkerd/linkerd2#7308</a>
for further details.</p><h2 id=l5d-existence class=anchor>The &ldquo;linkerd-existence&rdquo; checks
<a href=#l5d-existence class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><h3 id=l5d-existence-linkerd-config class=anchor>√ &rsquo;linkerd-config&rsquo; config map exists
<a href=#l5d-existence-linkerd-config class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× <span style=color:#a5d6ff>&#39;linkerd-config&#39;</span> config map exists
</span></span><span style=display:flex><span>    missing ConfigMaps: linkerd-config
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-existence-linkerd-config <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure the Linkerd ConfigMap exists:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n linkerd get configmap/linkerd-config
</span></span><span style=display:flex><span>NAME             DATA   AGE
</span></span><span style=display:flex><span>linkerd-config   <span style=color:#a5d6ff>3</span>      61m
</span></span></code></pre></div><p>Also ensure you have permission to create ConfigMaps:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n linkerd auth can-i create configmap
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=l5d-existence-replicasets class=anchor>√ control plane replica sets are ready
<a href=#l5d-existence-replicasets class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This failure occurs when one of Linkerd&rsquo;s ReplicaSets fails to schedule a pod.</p><p>For more information, see the Kubernetes documentation on
<a href=https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#failed-deployment target=_blank rel=noopener>Failed Deployments</a>.</p><h3 id=l5d-existence-unschedulable-pods class=anchor>√ no unschedulable pods
<a href=#l5d-existence-unschedulable-pods class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× no unschedulable pods
</span></span><span style=display:flex><span>    linkerd-prometheus-6b668f774d-j8ncr: 0/1 nodes are available: <span style=color:#a5d6ff>1</span> Insufficient cpu.
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-existence-unschedulable-pods <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>For more information, see the Kubernetes documentation on the
<a href=https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#pod-conditions target=_blank rel=noopener>Unschedulable Pod Condition</a>.</p><h2 id=l5d-identity class=anchor>The &ldquo;linkerd-identity&rdquo; checks
<a href=#l5d-identity class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><h3 id=l5d-identity-cert-config-valid class=anchor>√ certificate config is valid
<a href=#l5d-identity-cert-config-valid class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failures:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× certificate config is valid
</span></span><span style=display:flex><span>    key ca.crt containing the trust anchors needs to exist in secret linkerd-identity-issuer <span style=color:#ff7b72>if</span> --identity-external-issuer<span style=color:#ff7b72;font-weight:700>=</span>true
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-identity-cert-config-valid
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× certificate config is valid
</span></span><span style=display:flex><span>    key crt.pem containing the issuer certificate needs to exist in secret linkerd-identity-issuer <span style=color:#ff7b72>if</span> --identity-external-issuer<span style=color:#ff7b72;font-weight:700>=</span>false
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-identity-cert-config-valid
</span></span></code></pre></div><p>Ensure that your <code>linkerd-identity-issuer</code> secret contains the correct keys for
the <code>scheme</code> that Linkerd is configured with. If the scheme is
<code>kubernetes.io/tls</code> your secret should contain the <code>tls.crt</code>, <code>tls.key</code> and
<code>ca.crt</code> keys. Alternatively if your scheme is <code>linkerd.io/tls</code>, the required
keys are <code>crt.pem</code> and <code>key.pem</code>.</p><h3 id=l5d-identity-trustAnchors-use-supported-crypto class=anchor>√ trust roots are using supported crypto algorithm
<a href=#l5d-identity-trustAnchors-use-supported-crypto class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× trust roots are using supported crypto algorithm
</span></span><span style=display:flex><span>    Invalid roots:
</span></span><span style=display:flex><span>        * <span style=color:#a5d6ff>165223702412626077778653586125774349756</span> identity.linkerd.cluster.local must use P-256 curve <span style=color:#ff7b72>for</span> public key, instead P-521 was used
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-identity-trustAnchors-use-supported-crypto
</span></span></code></pre></div><p>You need to ensure that all of your roots use ECDSA P-256 for their public key
algorithm.</p><h3 id=l5d-identity-trustAnchors-are-time-valid class=anchor>√ trust roots are within their validity period
<a href=#l5d-identity-trustAnchors-are-time-valid class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× trust roots are within their validity period
</span></span><span style=display:flex><span>    Invalid roots:
</span></span><span style=display:flex><span>        * <span style=color:#a5d6ff>199607941798581518463476688845828639279</span> identity.linkerd.cluster.local not valid anymore. Expired on 2019-12-19T13:08:18Z
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-identity-trustAnchors-are-time-valid <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Failures of such nature indicate that your roots have expired. If that is the
case you will have to update both the root and issuer certificates at once. You
can follow the process outlined in
<a href=../replacing_expired_certificates/>Replacing Expired Certificates</a> to
get your cluster back to a stable state.</p><h3 id=l5d-identity-trustAnchors-not-expiring-soon class=anchor>√ trust roots are valid for at least 60 days
<a href=#l5d-identity-trustAnchors-not-expiring-soon class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example warnings:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ trust roots are valid <span style=color:#ff7b72>for</span> at least <span style=color:#a5d6ff>60</span> days
</span></span><span style=display:flex><span>    Roots expiring soon:
</span></span><span style=display:flex><span>        * <span style=color:#a5d6ff>66509928892441932260491975092256847205</span> identity.linkerd.cluster.local will expire on 2019-12-19T13:30:57Z
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-identity-trustAnchors-not-expiring-soon <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>This warning indicates that the expiry of some of your roots is approaching. In
order to address this problem without incurring downtime, you can follow the
process outlined in
<a href=../rotating_identity_certificates/>Rotating your identity certificates</a>.</p><h3 id=l5d-identity-issuer-cert-uses-supported-crypto class=anchor>√ issuer cert is using supported crypto algorithm
<a href=#l5d-identity-issuer-cert-uses-supported-crypto class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× issuer cert is using supported crypto algorithm
</span></span><span style=display:flex><span>    issuer certificate must use P-256 curve <span style=color:#ff7b72>for</span> public key, instead P-521 was used
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#5d-identity-issuer-cert-uses-supported-crypto <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>You need to ensure that your issuer certificate uses ECDSA P-256 for its public
key algorithm. You can refer to
<a href=../generate-certificates/#generating-the-certificates-with-step>Generating your own mTLS root certificates</a>
to see how you can generate certificates that will work with Linkerd.</p><h3 id=l5d-identity-issuer-cert-is-time-valid class=anchor>√ issuer cert is within its validity period
<a href=#l5d-identity-issuer-cert-is-time-valid class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× issuer cert is within its validity period
</span></span><span style=display:flex><span>    issuer certificate is not valid anymore. Expired on 2019-12-19T13:35:49Z
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-identity-issuer-cert-is-time-valid
</span></span></code></pre></div><p>This failure indicates that your issuer certificate has expired. In order to
bring your cluster back to a valid state, follow the process outlined in
<a href=../replacing_expired_certificates/>Replacing Expired Certificates</a>.</p><h3 id=l5d-identity-issuer-cert-not-expiring-soon class=anchor>√ issuer cert is valid for at least 60 days
<a href=#l5d-identity-issuer-cert-not-expiring-soon class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example warning:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ issuer cert is valid <span style=color:#ff7b72>for</span> at least <span style=color:#a5d6ff>60</span> days
</span></span><span style=display:flex><span>    issuer certificate will expire on 2019-12-19T13:35:49Z
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-identity-issuer-cert-not-expiring-soon <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>This warning means that your issuer certificate is expiring soon. If you do not
rely on external certificate management solution such as <code>cert-manager</code>, you can
follow the process outlined in
<a href=../rotating_identity_certificates/>Rotating your identity certificates</a></p><h3 id=l5d-identity-issuer-cert-issued-by-trust-anchor class=anchor>√ issuer cert is issued by the trust root
<a href=#l5d-identity-issuer-cert-issued-by-trust-anchor class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example error:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× issuer cert is issued by the trust root
</span></span><span style=display:flex><span>    x509: certificate signed by unknown authority <span style=color:#ff7b72;font-weight:700>(</span>possibly because of <span style=color:#a5d6ff>&#34;x509: ECDSA verification failure&#34;</span> <span style=color:#ff7b72>while</span> trying to verify candidate authority certificate <span style=color:#a5d6ff>&#34;identity.linkerd.cluster.local&#34;</span><span style=color:#ff7b72;font-weight:700>)</span>
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-identity-issuer-cert-issued-by-trust-anchor <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>This error indicates that the issuer certificate that is in the
<code>linkerd-identity-issuer</code> secret cannot be verified with any of the roots that
Linkerd has been configured with. Using the CLI install process, this should
never happen. If Helm was used for installation or the issuer certificates are
managed by a malfunctioning certificate management solution, it is possible for
the cluster to end up in such an invalid state. At that point the best to do is
to use the upgrade command to update your certificates:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd upgrade <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>    --identity-issuer-certificate-file<span style=color:#ff7b72;font-weight:700>=</span>./your-new-issuer.crt <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>    --identity-issuer-key-file<span style=color:#ff7b72;font-weight:700>=</span>./your-new-issuer.key <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>    --identity-trust-anchors-file<span style=color:#ff7b72;font-weight:700>=</span>./your-new-roots.crt <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>    --force | kubectl apply -f -
</span></span></code></pre></div><p>Once the upgrade process is over, the output of <code>linkerd check --proxy</code> should
be:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd-identity
</span></span><span style=display:flex><span>----------------
</span></span><span style=display:flex><span>√ certificate config is valid
</span></span><span style=display:flex><span>√ trust roots are using supported crypto algorithm
</span></span><span style=display:flex><span>√ trust roots are within their validity period
</span></span><span style=display:flex><span>√ trust roots are valid <span style=color:#ff7b72>for</span> at least <span style=color:#a5d6ff>60</span> days
</span></span><span style=display:flex><span>√ issuer cert is using supported crypto algorithm
</span></span><span style=display:flex><span>√ issuer cert is within its validity period
</span></span><span style=display:flex><span>√ issuer cert is valid <span style=color:#ff7b72>for</span> at least <span style=color:#a5d6ff>60</span> days
</span></span><span style=display:flex><span>√ issuer cert is issued by the trust root
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>linkerd-identity-data-plane
</span></span><span style=display:flex><span>---------------------------
</span></span><span style=display:flex><span>√ data plane proxies certificate match CA
</span></span></code></pre></div><h2 id=l5d-webhook class=anchor>The &ldquo;linkerd-webhooks-and-apisvc-tls&rdquo; checks
<a href=#l5d-webhook class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><h3 id=l5d-proxy-injector-webhook-cert-valid class=anchor>√ proxy-injector webhook has valid cert
<a href=#l5d-proxy-injector-webhook-cert-valid class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× proxy-injector webhook has valid cert
</span></span><span style=display:flex><span>    secrets <span style=color:#a5d6ff>&#34;linkerd-proxy-injector-tls&#34;</span> not found
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-proxy-injector-webhook-cert-valid <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure that the <code>linkerd-proxy-injector-k8s-tls</code> secret exists and contains the
appropriate <code>tls.crt</code> and <code>tls.key</code> data entries. For versions before 2.9, the
secret is named <code>linkerd-proxy-injector-tls</code> and it should contain the <code>crt.pem</code>
and <code>key.pem</code> data entries.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× proxy-injector webhook has valid cert
</span></span><span style=display:flex><span>    cert is not issued by the trust anchor: x509: certificate is valid <span style=color:#ff7b72>for</span> xxxxxx, not linkerd-proxy-injector.linkerd.svc
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-proxy-injector-webhook-cert-valid <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Here you need to make sure the certificate was issued specifically for
<code>linkerd-proxy-injector.linkerd.svc</code>.</p><h3 id=l5d-proxy-injector-webhook-cert-not-expiring-soon class=anchor>√ proxy-injector cert is valid for at least 60 days
<a href=#l5d-proxy-injector-webhook-cert-not-expiring-soon class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ proxy-injector cert is valid <span style=color:#ff7b72>for</span> at least <span style=color:#a5d6ff>60</span> days
</span></span><span style=display:flex><span>    certificate will expire on 2020-11-07T17:00:07Z
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-proxy-injector-webhook-cert-not-expiring-soon <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>This warning indicates that the expiry of proxy-injnector webhook
cert is approaching. In order to address this
problem without incurring downtime, you can follow the process outlined in
<a href=../automatically-rotating-webhook-tls-credentials/>Automatically Rotating your webhook TLS Credentials</a>.</p><h3 id=l5d-sp-validator-webhook-cert-valid class=anchor>√ sp-validator webhook has valid cert
<a href=#l5d-sp-validator-webhook-cert-valid class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× sp-validator webhook has valid cert
</span></span><span style=display:flex><span>    secrets <span style=color:#a5d6ff>&#34;linkerd-sp-validator-tls&#34;</span> not found
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-sp-validator-webhook-cert-valid <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure that the <code>linkerd-sp-validator-k8s-tls</code> secret exists and contains the
appropriate <code>tls.crt</code> and <code>tls.key</code> data entries. For versions before 2.9, the
secret is named <code>linkerd-sp-validator-tls</code> and it should contain the <code>crt.pem</code>
and <code>key.pem</code> data entries.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× sp-validator webhook has valid cert
</span></span><span style=display:flex><span>    cert is not issued by the trust anchor: x509: certificate is valid <span style=color:#ff7b72>for</span> xxxxxx, not linkerd-sp-validator.linkerd.svc
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-sp-validator-webhook-cert-valid <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Here you need to make sure the certificate was issued specifically for
<code>linkerd-sp-validator.linkerd.svc</code>.</p><h3 id=l5d-sp-validator-webhook-cert-not-expiring-soon class=anchor>√ sp-validator cert is valid for at least 60 days
<a href=#l5d-sp-validator-webhook-cert-not-expiring-soon class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ sp-validator cert is valid <span style=color:#ff7b72>for</span> at least <span style=color:#a5d6ff>60</span> days
</span></span><span style=display:flex><span>    certificate will expire on 2020-11-07T17:00:07Z
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-sp-validator-webhook-cert-not-expiring-soon <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>This warning indicates that the expiry of sp-validator webhook
cert is approaching. In order to address this
problem without incurring downtime, you can follow the process outlined in
<a href=../automatically-rotating-webhook-tls-credentials/>Automatically Rotating your webhook TLS Credentials</a>.</p><h3 id=l5d-policy-validator-webhook-cert-valid class=anchor>√ policy-validator webhook has valid cert
<a href=#l5d-policy-validator-webhook-cert-valid class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× policy-validator webhook has valid cert
</span></span><span style=display:flex><span>    secrets <span style=color:#a5d6ff>&#34;linkerd-policy-validator-tls&#34;</span> not found
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-policy-validator-webhook-cert-valid <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure that the <code>linkerd-policy-validator-k8s-tls</code> secret exists and contains the
appropriate <code>tls.crt</code> and <code>tls.key</code> data entries.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× policy-validator webhook has valid cert
</span></span><span style=display:flex><span>    cert is not issued by the trust anchor: x509: certificate is valid <span style=color:#ff7b72>for</span> xxxxxx, not linkerd-policy-validator.linkerd.svc
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-policy-validator-webhook-cert-valid <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Here you need to make sure the certificate was issued specifically for
<code>linkerd-policy-validator.linkerd.svc</code>.</p><h3 id=l5d-policy-validator-webhook-cert-not-expiring-soon class=anchor>√ policy-validator cert is valid for at least 60 days
<a href=#l5d-policy-validator-webhook-cert-not-expiring-soon class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ policy-validator cert is valid <span style=color:#ff7b72>for</span> at least <span style=color:#a5d6ff>60</span> days
</span></span><span style=display:flex><span>    certificate will expire on 2020-11-07T17:00:07Z
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-policy-validator-webhook-cert-not-expiring-soon <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>This warning indicates that the expiry of policy-validator webhook
cert is approaching. In order to address this
problem without incurring downtime, you can follow the process outlined in
<a href=../automatically-rotating-webhook-tls-credentials/>Automatically Rotating your webhook TLS Credentials</a>.</p><h2 id=l5d-identity-data-plane class=anchor>The &ldquo;linkerd-identity-data-plane&rdquo; checks
<a href=#l5d-identity-data-plane class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><h3 id=l5d-identity-data-plane-proxies-certs-match-ca class=anchor>√ data plane proxies certificate match CA
<a href=#l5d-identity-data-plane-proxies-certs-match-ca class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example warning:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ data plane proxies certificate match CA
</span></span><span style=display:flex><span>    Some pods <span style=color:#ff7b72>do</span> not have the current trust bundle and must be restarted:
</span></span><span style=display:flex><span>        * emojivoto/emoji-d8d7d9c6b-8qwfx
</span></span><span style=display:flex><span>        * emojivoto/vote-bot-588499c9f6-zpwz6
</span></span><span style=display:flex><span>        * emojivoto/voting-8599548fdc-6v64k
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/<span style=color:#ff7b72;font-weight:700>{</span><span style=color:#8b949e;font-style:italic>#l5d-identity-data-plane-proxies-certs-match-ca for hints</span>
</span></span></code></pre></div><p>Observing this warning indicates that some of your meshed pods have proxies that
have stale certificates. This is most likely to happen during <code>upgrade</code>
operations that deal with cert rotation. In order to solve the problem you can
use <code>rollout restart</code> to restart the pods in question. That should cause them to
pick the correct certs from the <code>linkerd-config</code> configmap. When <code>upgrade</code> is
performed using the <code>--identity-trust-anchors-file</code> flag to modify the roots,
the Linkerd components are restarted. While this operation is in progress the
<code>check --proxy</code> command may output a warning, pertaining to the Linkerd
components:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ data plane proxies certificate match CA
</span></span><span style=display:flex><span>    Some pods <span style=color:#ff7b72>do</span> not have the current trust bundle and must be restarted:
</span></span><span style=display:flex><span>        * linkerd/linkerd-sp-validator-75f9d96dc-rch4x
</span></span><span style=display:flex><span>        * linkerd-viz/tap-68d8bbf64-mpzgb
</span></span><span style=display:flex><span>        * linkerd-viz/web-849f74b7c6-qlhwc
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/<span style=color:#ff7b72;font-weight:700>{</span><span style=color:#8b949e;font-style:italic>#l5d-identity-data-plane-proxies-certs-match-ca for hints</span>
</span></span></code></pre></div><p>If that is the case, simply wait for the <code>upgrade</code> operation to complete. The
stale pods should terminate and be replaced by new ones, configured with the
correct certificates.</p><h2 id=l5d-api class=anchor>The &ldquo;linkerd-api&rdquo; checks
<a href=#l5d-api class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><h3 id=l5d-api-control-ready class=anchor>√ control plane pods are ready
<a href=#l5d-api-control-ready class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× control plane pods are ready
</span></span><span style=display:flex><span>    No running pods <span style=color:#ff7b72>for</span> <span style=color:#a5d6ff>&#34;linkerd-sp-validator&#34;</span>
</span></span></code></pre></div><p>Verify the state of the control plane pods with:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n linkerd get po
</span></span><span style=display:flex><span>NAME                                      READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>linkerd-destination-5fd7b5d466-szgqm      2/2     Running   <span style=color:#a5d6ff>1</span>          12m
</span></span><span style=display:flex><span>linkerd-identity-54df78c479-hbh5m         2/2     Running   <span style=color:#a5d6ff>0</span>          12m
</span></span><span style=display:flex><span>linkerd-proxy-injector-67f8cf65f7-4tvt5   2/2     Running   <span style=color:#a5d6ff>1</span>          12m
</span></span></code></pre></div><h3 id=l5d-cluster-networks-verified class=anchor>√ cluster networks can be verified
<a href=#l5d-cluster-networks-verified class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ cluster networks can be verified
</span></span><span style=display:flex><span>    the following nodes <span style=color:#ff7b72>do</span> not expose a podCIDR:
</span></span><span style=display:flex><span>        node-0
</span></span><span style=display:flex><span>    see https://linkerd.io/2.16/checks/#l5d-cluster-networks-verified <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Linkerd has a <code>clusterNetworks</code> setting which allows it to differentiate between
intra-cluster and egress traffic. Through each Node&rsquo;s <code>podCIDR</code> field, Linkerd
can verify that all possible Pod IPs are included in the <code>clusterNetworks</code>
setting. When a Node is missing the <code>podCIDR</code> field, Linkerd can not verify
this, and it&rsquo;s possible that the Node creates a Pod with an IP outside of
<code>clusterNetworks</code>; this may result in it not being meshed properly.</p><p>Nodes are not required to expose a <code>podCIDR</code> field which is why this results in
a warning. Getting a Node to expose this field depends on the specific
distribution being used.</p><h3 id=l5d-cluster-networks-cidr class=anchor>√ cluster networks contains all node podCIDRs
<a href=#l5d-cluster-networks-cidr class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× cluster networks contains all node podCIDRs
</span></span><span style=display:flex><span>    node has podCIDR<span style=color:#ff7b72;font-weight:700>(</span>s<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>[</span>10.244.0.0/24<span style=color:#ff7b72;font-weight:700>]</span> which are not contained in the Linkerd clusterNetworks.
</span></span><span style=display:flex><span>    Try installing linkerd via --set <span style=color:#79c0ff>clusterNetworks</span><span style=color:#ff7b72;font-weight:700>=</span>10.244.0.0/24
</span></span><span style=display:flex><span>    see https://linkerd.io/2.16/checks/#l5d-cluster-networks-cidr <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Linkerd has a <code>clusterNetworks</code> setting which allows it to differentiate between
intra-cluster and egress traffic. This warning indicates that the cluster has
a podCIDR which is not included in Linkerd&rsquo;s <code>clusterNetworks</code>. Traffic to pods
in this network may not be meshed properly. To remedy this, update the
<code>clusterNetworks</code> setting to include all pod networks in the cluster.</p><h3 id=l5d-cluster-networks-pods class=anchor>√ cluster networks contains all pods
<a href=#l5d-cluster-networks-pods class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failures:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× the Linkerd clusterNetworks <span style=color:#ff7b72;font-weight:700>[</span>10.244.0.0/24<span style=color:#ff7b72;font-weight:700>]</span> <span style=color:#ff7b72>do</span> not include pod default/foo <span style=color:#ff7b72;font-weight:700>(</span>104.21.63.202<span style=color:#ff7b72;font-weight:700>)</span>
</span></span><span style=display:flex><span>    see https://linkerd.io/2.16/checks/#l5d-cluster-networks-pods <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× the Linkerd clusterNetworks <span style=color:#ff7b72;font-weight:700>[</span>10.244.0.0/24<span style=color:#ff7b72;font-weight:700>]</span> <span style=color:#ff7b72>do</span> not include svc default/bar <span style=color:#ff7b72;font-weight:700>(</span>10.96.217.194<span style=color:#ff7b72;font-weight:700>)</span>
</span></span><span style=display:flex><span>    see https://linkerd.io/2.16/checks/#l5d-cluster-networks-pods <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Linkerd has a <code>clusterNetworks</code> setting which allows it to differentiate between
intra-cluster and egress traffic. This warning indicates that the cluster has
a pod or ClusterIP service which is not included in Linkerd&rsquo;s <code>clusterNetworks</code>.
Traffic to pods or services in this network may not be meshed properly. To
remedy this, update the <code>clusterNetworks</code> setting to include all pod and service
networks in the cluster.</p><h2 id=l5d-version class=anchor>The &ldquo;linkerd-version&rdquo; checks
<a href=#l5d-version class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><h3 id=l5d-version-latest class=anchor>√ can determine the latest version
<a href=#l5d-version-latest class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× can determine the latest version
</span></span><span style=display:flex><span>    Get https://versioncheck.linkerd.io/version.json?version<span style=color:#ff7b72;font-weight:700>=</span>edge-19.1.2&amp;<span style=color:#79c0ff>uuid</span><span style=color:#ff7b72;font-weight:700>=</span>test-uuid&amp;<span style=color:#79c0ff>source</span><span style=color:#ff7b72;font-weight:700>=</span>cli: context deadline exceeded
</span></span></code></pre></div><p>Ensure you can connect to the Linkerd version check endpoint from the
environment the <code>linkerd</code> cli is running:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl <span style=color:#a5d6ff>&#34;https://versioncheck.linkerd.io/version.json?version=edge-19.1.2&amp;uuid=test-uuid&amp;source=cli&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>{</span><span style=color:#a5d6ff>&#34;stable&#34;</span>:<span style=color:#a5d6ff>&#34;stable-2.1.0&#34;</span>,<span style=color:#a5d6ff>&#34;edge&#34;</span>:<span style=color:#a5d6ff>&#34;edge-19.1.2&#34;</span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=l5d-version-cli class=anchor>√ cli is up-to-date
<a href=#l5d-version-cli class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ cli is up-to-date
</span></span><span style=display:flex><span>    is running version 19.1.1 but the latest edge version is 19.1.2
</span></span></code></pre></div><p>See the page on <a href=../../upgrade/>Upgrading Linkerd</a>.</p><h2 id=l5d-version-control class=anchor>The &ldquo;control-plane-version&rdquo; checks
<a href=#l5d-version-control class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>Example failures:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ control plane is up-to-date
</span></span><span style=display:flex><span>    is running version 19.1.1 but the latest edge version is 19.1.2
</span></span><span style=display:flex><span>‼ control plane and cli versions match
</span></span><span style=display:flex><span>    mismatched channels: running stable-2.1.0 but retrieved edge-19.1.2
</span></span></code></pre></div><p>See the page on <a href=../../upgrade/>Upgrading Linkerd</a>.</p><h2 id=linkerd-control-plane-proxy class=anchor>The &ldquo;linkerd-control-plane-proxy&rdquo; checks
<a href=#linkerd-control-plane-proxy class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><h3 id=l5d-cp-proxy-healthy class=anchor>√ control plane proxies are healthy
<a href=#l5d-cp-proxy-healthy class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This error indicates that the proxies running in the Linkerd control plane are
not healthy. Ensure that Linkerd has been installed with all of the correct
setting or re-install Linkerd as necessary.</p><h3 id=l5d-cp-proxy-version class=anchor>√ control plane proxies are up-to-date
<a href=#l5d-cp-proxy-version class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This warning indicates the proxies running in the Linkerd control plane are
running an old version. We recommend downloading the latest Linkerd release
and <a href=../../upgrade/>Upgrading Linkerd</a>.</p><h3 id=l5d-cp-proxy-cli-version class=anchor>√ control plane proxies and cli versions match
<a href=#l5d-cp-proxy-cli-version class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This warning indicates that the proxies running in the Linkerd control plane are
running a different version from the Linkerd CLI. We recommend keeping this
versions in sync by updating either the CLI or the control plane as necessary.</p><h2 id=l5d-data-plane class=anchor>The &ldquo;linkerd-data-plane&rdquo; checks
<a href=#l5d-data-plane class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>These checks only run when the <code>--proxy</code> flag is set. This flag is intended for
use after running <code>linkerd inject</code>, to verify the injected proxies are operating
normally.</p><h3 id=l5d-data-plane-exists class=anchor>√ data plane namespace exists
<a href=#l5d-data-plane-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ linkerd check --proxy --namespace foo
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>× data plane namespace exists
</span></span><span style=display:flex><span>    The <span style=color:#a5d6ff>&#34;foo&#34;</span> namespace does not exist
</span></span></code></pre></div><p>Ensure the <code>--namespace</code> specified exists, or, omit the parameter to check all
namespaces.</p><h3 id=l5d-data-plane-ready class=anchor>√ data plane proxies are ready
<a href=#l5d-data-plane-ready class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× data plane proxies are ready
</span></span><span style=display:flex><span>    No <span style=color:#a5d6ff>&#34;linkerd-proxy&#34;</span> containers found
</span></span></code></pre></div><p>Ensure you have injected the Linkerd proxy into your application via the
<code>linkerd inject</code> command.</p><p>For more information on <code>linkerd inject</code>, see
<a href=../../getting-started/#step-5-install-the-demo-app>Step 5: Install the demo app</a>
in our <a href=../../getting-started/>Getting Started</a> guide.</p><h3 id=l5d-data-plane-version class=anchor>√ data plane is up-to-date
<a href=#l5d-data-plane-version class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ data plane is up-to-date
</span></span><span style=display:flex><span>    linkerd/linkerd-prometheus-74d66f86f6-6t6dh: is running version 19.1.2 but the latest edge version is 19.1.3
</span></span></code></pre></div><p>See the page on <a href=../../upgrade/>Upgrading Linkerd</a>.</p><h3 id=l5d-data-plane-cli-version class=anchor>√ data plane and cli versions match
<a href=#l5d-data-plane-cli-version class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ data plane and cli versions match
</span></span><span style=display:flex><span>    linkerd/linkerd-identity-5f6c45d6d9-9hd9j: is running version 19.1.2 but the latest edge version is 19.1.3
</span></span></code></pre></div><p>See the page on <a href=../../upgrade/>Upgrading Linkerd</a>.</p><h3 id=l5d-data-plane-pod-labels class=anchor>√ data plane pod labels are configured correctly
<a href=#l5d-data-plane-pod-labels class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ data plane pod labels are configured correctly
</span></span><span style=display:flex><span>    Some labels on data plane pods should be annotations:
</span></span><span style=display:flex><span>    * emojivoto/voting-ff4c54b8d-tv9pp
</span></span><span style=display:flex><span>        linkerd.io/inject
</span></span></code></pre></div><p><code>linkerd.io/inject</code>, <code>config.linkerd.io/*</code> or <code>config.alpha.linkerd.io/*</code> should
be annotations in order to take effect.</p><h3 id=l5d-data-plane-services-labels class=anchor>√ data plane service labels are configured correctly
<a href=#l5d-data-plane-services-labels class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ data plane service labels and annotations are configured correctly
</span></span><span style=display:flex><span>    Some labels on data plane services should be annotations:
</span></span><span style=display:flex><span>    * emojivoto/emoji-svc
</span></span><span style=display:flex><span>        config.linkerd.io/control-port
</span></span></code></pre></div><p><code>config.linkerd.io/*</code> or <code>config.alpha.linkerd.io/*</code> should
be annotations in order to take effect.</p><h3 id=l5d-data-plane-services-annotations class=anchor>√ data plane service annotations are configured correctly
<a href=#l5d-data-plane-services-annotations class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ data plane service annotations are configured correctly
</span></span><span style=display:flex><span>    Some annotations on data plane services should be labels:
</span></span><span style=display:flex><span>    * emojivoto/emoji-svc
</span></span><span style=display:flex><span>        mirror.linkerd.io/exported
</span></span></code></pre></div><p><code>mirror.linkerd.io/exported</code> should
be a label in order to take effect.</p><h3 id=linkerd-opaque-ports-definition class=anchor>√ opaque ports are properly annotated
<a href=#linkerd-opaque-ports-definition class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× opaque ports are properly annotated
</span></span><span style=display:flex><span>        * service emoji-svc targets the opaque port <span style=color:#a5d6ff>8080</span> through 8080; add <span style=color:#a5d6ff>8080</span> to its config.linkerd.io/opaque-ports annotation
</span></span><span style=display:flex><span>    see https://linkerd.io/2.16/checks/#linkerd-opaque-ports-definition <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>If a Pod marks a port as opaque by using the <code>config.linkerd.io/opaque-ports</code>
annotation, then any Service which targets that port must also use the
<code>config.linkerd.io/opaque-ports</code> annotation to mark that port as opaque. Having
a port marked as opaque on the Pod but not the Service (or vice versa) can
cause inconsistent behavior depending on if traffic is sent to the Pod directly
(for example with a headless Service) or through a ClusterIP Service. This
error can be remedied by adding the <code>config.linkerd.io/opaque-ports</code> annotation
to both the Pod and Service. See
<a href=../../features/protocol-detection/>Protocol Detection</a> for more information.</p><h2 id=l5d-ha class=anchor>The &ldquo;linkerd-ha-checks&rdquo; checks
<a href=#l5d-ha class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>These checks are ran if Linkerd has been installed in HA mode.</p><h3 id=l5d-injection-disabled class=anchor>√ pod injection disabled on kube-system
<a href=#l5d-injection-disabled class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example warning:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ pod injection disabled on kube-system
</span></span><span style=display:flex><span>    kube-system namespace needs to have the label config.linkerd.io/admission-webhooks: disabled <span style=color:#ff7b72>if</span> HA mode is enabled
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-injection-disabled <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure the kube-system namespace has the
<code>config.linkerd.io/admission-webhooks:disabled</code> label:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get namespace kube-system -oyaml
</span></span><span style=display:flex><span>kind: Namespace
</span></span><span style=display:flex><span>apiVersion: v1
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  name: kube-system
</span></span><span style=display:flex><span>  annotations:
</span></span><span style=display:flex><span>    linkerd.io/inject: disabled
</span></span><span style=display:flex><span>  labels:
</span></span><span style=display:flex><span>    config.linkerd.io/admission-webhooks: disabled
</span></span></code></pre></div><h3 id=l5d-control-plane-replicas class=anchor>√ multiple replicas of control plane pods
<a href=#l5d-control-plane-replicas class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example warning:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ multiple replicas of control plane pods
</span></span><span style=display:flex><span>    not enough replicas available <span style=color:#ff7b72>for</span> <span style=color:#ff7b72;font-weight:700>[</span>linkerd-identity<span style=color:#ff7b72;font-weight:700>]</span>
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-control-plane-replicas <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>This happens when one of the control plane pods doesn&rsquo;t have at least two
replicas running. This is likely caused by insufficient node resources.</p><h3 id=extensions class=anchor>The &ldquo;extensions&rdquo; checks
<a href=#extensions class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>When any <a href=../extensions/>Extensions</a> are installed, The Linkerd binary
tries to invoke <code>check --output json</code> on the extension binaries.
It is important that the extension binaries implement it.
For more information, See <a href=https://github.com/linkerd/linkerd2/blob/main/EXTENSIONS.md target=_blank rel=noopener>Extension
developer docs</a></p><p>Example error:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>invalid extension check output from <span style=color:#79c0ff>\&#34;</span>jaeger<span style=color:#79c0ff>\&#34;</span> <span style=color:#ff7b72;font-weight:700>(</span>JSON object expected<span style=color:#ff7b72;font-weight:700>)</span>
</span></span></code></pre></div><p>Make sure that the extension binary implements <code>check --output json</code>
which returns the healthchecks in the <a href=https://github.com/linkerd/linkerd2/blob/main/EXTENSIONS.md#linkerd-name-check target=_blank rel=noopener>expected json format</a>.</p><p>Example error:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× Linkerd command jaeger exists
</span></span></code></pre></div><p>Make sure that relevant binary exists in <code>$PATH</code>.</p><p>For more information about Linkerd extensions. See
<a href=https://github.com/linkerd/linkerd2/blob/main/EXTENSIONS.md target=_blank rel=noopener>Extension developer docs</a></p><h2 id=l5d-cni class=anchor>The &ldquo;linkerd-cni-plugin&rdquo; checks
<a href=#l5d-cni class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>These checks run if Linkerd has been installed with the <code>--linkerd-cni-enabled</code>
flag. Alternatively they can be run as part of the pre-checks by providing the
<code>--linkerd-cni-enabled</code> flag. Most of these checks verify that the required
resources are in place. If any of them are missing, you can use
<code>linkerd install-cni | kubectl apply -f -</code> to re-install them.</p><h3 id=cni-plugin-cm-exists class=anchor>√ cni plugin ConfigMap exists
<a href=#cni-plugin-cm-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example error:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× cni plugin ConfigMap exists
</span></span><span style=display:flex><span>    configmaps <span style=color:#a5d6ff>&#34;linkerd-cni-config&#34;</span> not found
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#cni-plugin-cm-exists <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure that the linkerd-cni-config ConfigMap exists in the CNI namespace:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get cm linkerd-cni-config -n linkerd-cni
</span></span><span style=display:flex><span>NAME                      PRIV    CAPS   SELINUX    RUNASUSER   FSGROUP    SUPGROUP   READONLYROOTFS   VOLUMES
</span></span><span style=display:flex><span>linkerd-linkerd-cni-cni   false          RunAsAny   RunAsAny    RunAsAny   RunAsAny   false            hostPath,secret
</span></span></code></pre></div><p>Also ensure you have permission to create ConfigMaps:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl auth can-i create ConfigMaps
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=cni-plugin-cr-exists class=anchor>√ cni plugin ClusterRole exist
<a href=#cni-plugin-cr-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example error:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× cni plugin ClusterRole exists
</span></span><span style=display:flex><span>    missing ClusterRole: linkerd-cni
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#cni-plugin-cr-exists <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure that the cluster role exists:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get clusterrole linkerd-cni
</span></span><span style=display:flex><span>NAME          AGE
</span></span><span style=display:flex><span>linkerd-cni   54m
</span></span></code></pre></div><p>Also ensure you have permission to create ClusterRoles:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl auth can-i create ClusterRoles
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=cni-plugin-crb-exists class=anchor>√ cni plugin ClusterRoleBinding exist
<a href=#cni-plugin-crb-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example error:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× cni plugin ClusterRoleBinding exists
</span></span><span style=display:flex><span>    missing ClusterRoleBinding: linkerd-cni
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#cni-plugin-crb-exists <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure that the cluster role binding exists:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get clusterrolebinding linkerd-cni
</span></span><span style=display:flex><span>NAME          AGE
</span></span><span style=display:flex><span>linkerd-cni   54m
</span></span></code></pre></div><p>Also ensure you have permission to create ClusterRoleBindings:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl auth can-i create ClusterRoleBindings
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=cni-plugin-sa-exists class=anchor>√ cni plugin ServiceAccount exists
<a href=#cni-plugin-sa-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example error:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× cni plugin ServiceAccount exists
</span></span><span style=display:flex><span>    missing ServiceAccount: linkerd-cni
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#cni-plugin-sa-exists <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure that the CNI service account exists in the CNI namespace:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get ServiceAccount linkerd-cni -n linkerd-cni
</span></span><span style=display:flex><span>NAME          SECRETS   AGE
</span></span><span style=display:flex><span>linkerd-cni   <span style=color:#a5d6ff>1</span>         45m
</span></span></code></pre></div><p>Also ensure you have permission to create ServiceAccount:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl auth can-i create ServiceAccounts -n linkerd-cni
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=cni-plugin-ds-exists class=anchor>√ cni plugin DaemonSet exists
<a href=#cni-plugin-ds-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example error:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× cni plugin DaemonSet exists
</span></span><span style=display:flex><span>    missing DaemonSet: linkerd-cni
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#cni-plugin-ds-exists <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure that the CNI daemonset exists in the CNI namespace:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get ds -n linkerd-cni
</span></span><span style=display:flex><span>NAME          DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR                 AGE
</span></span><span style=display:flex><span>linkerd-cni   <span style=color:#a5d6ff>1</span>         <span style=color:#a5d6ff>1</span>         <span style=color:#a5d6ff>1</span>       <span style=color:#a5d6ff>1</span>            <span style=color:#a5d6ff>1</span>           beta.kubernetes.io/os<span style=color:#ff7b72;font-weight:700>=</span>linux   14m
</span></span></code></pre></div><p>Also ensure you have permission to create DaemonSets:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl auth can-i create DaemonSets -n linkerd-cni
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=cni-plugin-ready class=anchor>√ cni plugin pod is running on all nodes
<a href=#cni-plugin-ready class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ cni plugin pod is running on all nodes
</span></span><span style=display:flex><span>    number ready: 2, number scheduled: <span style=color:#a5d6ff>3</span>
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#cni-plugin-ready
</span></span></code></pre></div><p>Ensure that all the CNI pods are running:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get po -n linkerd-cn
</span></span><span style=display:flex><span>NAME                READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>linkerd-cni-rzp2q   1/1     Running   <span style=color:#a5d6ff>0</span>          9m20s
</span></span><span style=display:flex><span>linkerd-cni-mf564   1/1     Running   <span style=color:#a5d6ff>0</span>          9m22s
</span></span><span style=display:flex><span>linkerd-cni-p5670   1/1     Running   <span style=color:#a5d6ff>0</span>          9m25s
</span></span></code></pre></div><p>Ensure that all pods have finished the deployment of the CNI config and binary:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl logs linkerd-cni-rzp2q -n linkerd-cni
</span></span><span style=display:flex><span>Wrote linkerd CNI binaries to /host/opt/cni/bin
</span></span><span style=display:flex><span>Created CNI config /host/etc/cni/net.d/10-kindnet.conflist
</span></span><span style=display:flex><span>Done configuring CNI. <span style=color:#79c0ff>Sleep</span><span style=color:#ff7b72;font-weight:700>=</span>true
</span></span></code></pre></div><h2 id=l5d-multicluster class=anchor>The &ldquo;linkerd-multicluster checks
<a href=#l5d-multicluster class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>These checks run if the service mirroring controller has been installed.
Additionally they can be ran with <code>linkerd multicluster check</code>.
Most of these checks verify that the service mirroring controllers are working
correctly along with remote gateways. Furthermore the checks ensure that
end to end TLS is possible between paired clusters.</p><h3 id=l5d-multicluster-link-crd-exists class=anchor>√ Link CRD exists
<a href=#l5d-multicluster-link-crd-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example error:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× Link CRD exists
</span></span><span style=display:flex><span>    multicluster.linkerd.io/Link CRD is missing
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-multicluster-link-crd-exists <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Make sure multicluster extension is correctly installed and that the
<code>links.multicluster.linkerd.io</code> CRD is present.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectll get crds | grep multicluster
</span></span><span style=display:flex><span>NAME                              CREATED AT
</span></span><span style=display:flex><span>links.multicluster.linkerd.io     2021-03-10T09:58:10Z
</span></span></code></pre></div><h3 id=l5d-multicluster-links-are-valid class=anchor>√ Link resources are valid
<a href=#l5d-multicluster-links-are-valid class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example error:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× Link resources are valid
</span></span><span style=display:flex><span>    failed to parse Link east
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-multicluster-links-are-valid <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Make sure all the link objects are specified in the expected format.</p><h3 id=l5d-smc-target-clusters-access class=anchor>√ remote cluster access credentials are valid
<a href=#l5d-smc-target-clusters-access class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example error:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× remote cluster access credentials are valid
</span></span><span style=display:flex><span>    * secret <span style=color:#ff7b72;font-weight:700>[</span>east/east-config<span style=color:#ff7b72;font-weight:700>]</span>: could not find east-config secret
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-smc-target-clusters-access <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Make sure the relevant Kube-config with relevant permissions.
for the specific target cluster is present as a secret correctly</p><h3 id=l5d-multicluster-clusters-share-anchors class=anchor>√ clusters share trust anchors
<a href=#l5d-multicluster-clusters-share-anchors class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example errors:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× clusters share trust anchors
</span></span><span style=display:flex><span>    Problematic clusters:
</span></span><span style=display:flex><span>        * remote
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-multicluster-clusters-share-anchors <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>The error above indicates that your trust anchors are not compatible. In order
to fix that you need to ensure that both your anchors contain identical sets of
certificates.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× clusters share trust anchors
</span></span><span style=display:flex><span>    Problematic clusters:
</span></span><span style=display:flex><span>        * remote: cannot parse trust anchors
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-multicluster-clusters-share-anchors <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Such an error indicates that there is a problem with your anchors on the cluster
named <code>remote</code> You need to make sure the identity config aspect of your Linkerd
installation on the <code>remote</code> cluster is ok. You can run <code>check</code> against the
remote cluster to verify that:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd --context<span style=color:#ff7b72;font-weight:700>=</span>remote check
</span></span></code></pre></div><h3 id=l5d-multicluster-source-rbac-correct class=anchor>√ service mirror controller has required permissions
<a href=#l5d-multicluster-source-rbac-correct class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example error:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× service mirror controller has required permissions
</span></span><span style=display:flex><span>    missing Service mirror ClusterRole linkerd-service-mirror-access-local-resources: unexpected verbs expected create,delete,get,list,update,watch, got create,delete,get,update,watch
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-multicluster-source-rbac-correct <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>This error indicates that the local RBAC permissions of the service mirror
service account are not correct. In order to ensure that you have the correct
verbs and resources you can inspect your ClusterRole and Role object and look at
the rules section.</p><p>Expected rules for <code>linkerd-service-mirror-access-local-resources</code> cluster role:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl  --context<span style=color:#ff7b72;font-weight:700>=</span>local get clusterrole linkerd-service-mirror-access-local-resources -o yaml
</span></span><span style=display:flex><span>kind: ClusterRole
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  labels:
</span></span><span style=display:flex><span>    linkerd.io/control-plane-component: linkerd-service-mirror
</span></span><span style=display:flex><span>  name: linkerd-service-mirror-access-local-resources
</span></span><span style=display:flex><span>rules:
</span></span><span style=display:flex><span>- apiGroups:
</span></span><span style=display:flex><span>  - <span style=color:#a5d6ff>&#34;&#34;</span>
</span></span><span style=display:flex><span>  resources:
</span></span><span style=display:flex><span>  - endpoints
</span></span><span style=display:flex><span>  - services
</span></span><span style=display:flex><span>  verbs:
</span></span><span style=display:flex><span>  - list
</span></span><span style=display:flex><span>  - get
</span></span><span style=display:flex><span>  - watch
</span></span><span style=display:flex><span>  - create
</span></span><span style=display:flex><span>  - delete
</span></span><span style=display:flex><span>  - update
</span></span><span style=display:flex><span>- apiGroups:
</span></span><span style=display:flex><span>  - <span style=color:#a5d6ff>&#34;&#34;</span>
</span></span><span style=display:flex><span>  resources:
</span></span><span style=display:flex><span>  - namespaces
</span></span><span style=display:flex><span>  verbs:
</span></span><span style=display:flex><span>  - create
</span></span><span style=display:flex><span>  - list
</span></span><span style=display:flex><span>  - get
</span></span><span style=display:flex><span>  - watch
</span></span></code></pre></div><p>Expected rules for <code>linkerd-service-mirror-read-remote-creds</code> role:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl  --context<span style=color:#ff7b72;font-weight:700>=</span>local get role linkerd-service-mirror-read-remote-creds -n linkerd-multicluster  -o yaml
</span></span><span style=display:flex><span>kind: Role
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  labels:
</span></span><span style=display:flex><span>    linkerd.io/control-plane-component: linkerd-service-mirror
</span></span><span style=display:flex><span>  name: linkerd-service-mirror-read-remote-creds
</span></span><span style=display:flex><span>  namespace: linkerd-multicluster
</span></span><span style=display:flex><span>  rules:
</span></span><span style=display:flex><span>- apiGroups:
</span></span><span style=display:flex><span>  - <span style=color:#a5d6ff>&#34;&#34;</span>
</span></span><span style=display:flex><span>  resources:
</span></span><span style=display:flex><span>  - secrets
</span></span><span style=display:flex><span>  verbs:
</span></span><span style=display:flex><span>  - list
</span></span><span style=display:flex><span>  - get
</span></span><span style=display:flex><span>  - watch
</span></span></code></pre></div><h3 id=l5d-multicluster-service-mirror-running class=anchor>√ service mirror controllers are running
<a href=#l5d-multicluster-service-mirror-running class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example error:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× service mirror controllers are running
</span></span><span style=display:flex><span>    Service mirror controller is not present
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-multicluster-service-mirror-running <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Note, it takes a little bit for pods to be scheduled, images to be pulled and
everything to start up. If this is a permanent error, you&rsquo;ll want to validate
the state of the controller pod with:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl --all-namespaces get po --selector linkerd.io/control-plane-component<span style=color:#ff7b72;font-weight:700>=</span>linkerd-service-mirror
</span></span><span style=display:flex><span>NAME                                  READY     STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>linkerd-service-mirror-7bb8ff5967-zg265   2/2       Running   <span style=color:#a5d6ff>0</span>          50m
</span></span></code></pre></div><h3 id=l5d-multicluster-gateways-endpoints class=anchor>√ all gateway mirrors are healthy
<a href=#l5d-multicluster-gateways-endpoints class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example errors:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ all gateway mirrors are healthy
</span></span><span style=display:flex><span>    Some gateway mirrors <span style=color:#ff7b72>do</span> not have endpoints:
</span></span><span style=display:flex><span>  linkerd-gateway-gke.linkerd-multicluster mirrored from cluster <span style=color:#ff7b72;font-weight:700>[</span>gke<span style=color:#ff7b72;font-weight:700>]</span>
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-multicluster-gateways-endpoints <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>The error above indicates that some gateway mirror services in the source
cluster do not have associated endpoints resources. These endpoints are created
by the Linkerd service mirror controller on the source cluster whenever a link
is established with a target cluster.</p><p>Such an error indicates that there could be a problem with the creation of the
resources by the service mirror controller or the external IP of the gateway
service in target cluster.</p><h3 id=l5d-multicluster-services-endpoints class=anchor>√ all mirror services have endpoints
<a href=#l5d-multicluster-services-endpoints class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example errors:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ all mirror services have endpoints
</span></span><span style=display:flex><span>    Some mirror services <span style=color:#ff7b72>do</span> not have endpoints:
</span></span><span style=display:flex><span>  voting-svc-gke.emojivoto mirrored from cluster <span style=color:#ff7b72;font-weight:700>[</span>gke<span style=color:#ff7b72;font-weight:700>]</span> <span style=color:#ff7b72;font-weight:700>(</span>gateway: <span style=color:#ff7b72;font-weight:700>[</span>linkerd-multicluster/linkerd-gateway<span style=color:#ff7b72;font-weight:700>])</span>
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-multicluster-services-endpoints <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>The error above indicates that some mirror services in the source cluster do not
have associated endpoints resources. These endpoints are created by the Linkerd
service mirror controller when creating a mirror service with endpoints values
as the remote gateway&rsquo;s external IP.</p><p>Such an error indicates that there could be a problem with the creation of the
mirror resources by the service mirror controller or the mirror gateway service
in the source cluster or the external IP of the gateway service in target
cluster.</p><h3 id=l5d-multicluster-orphaned-services class=anchor>√ all mirror services are part of a Link
<a href=#l5d-multicluster-orphaned-services class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example errors:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼  all mirror services are part of a Link
</span></span><span style=display:flex><span>    mirror service voting-east.emojivoto is not part of any Link
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-multicluster-orphaned-services <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>The error above indicates that some mirror services in the source cluster do not
have associated link. These mirror services are created by the Linkerd
service mirror controller when a remote service is marked to be
mirrored.</p><p>Make sure services are marked to be mirrored correctly at remote, and delete
if there are any unnecessary ones.</p><h3 id=l5d-multicluster-proxy-healthy class=anchor>√ multicluster extension proxies are healthy
<a href=#l5d-multicluster-proxy-healthy class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This error indicates that the proxies running in the multicluster extension are
not healthy. Ensure that linkerd-multicluster has been installed with all of the
correct setting or re-install as necessary.</p><h3 id=l5d-multicluster-proxy-cp-version class=anchor>√ multicluster extension proxies are up-to-date
<a href=#l5d-multicluster-proxy-cp-version class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This warning indicates the proxies running in the multicluster extension are
running an old version. We recommend downloading the latest linkerd-multicluster
and upgrading.</p><h3 id=l5d-multicluster-proxy-cli-version class=anchor>√ multicluster extension proxies and cli versions match
<a href=#l5d-multicluster-proxy-cli-version class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This warning indicates that the proxies running in the multicluster extension are
running a different version from the Linkerd CLI. We recommend keeping this
versions in sync by updating either the CLI or linkerd-multicluster as necessary.</p><h2 id=l5d-viz class=anchor>The &ldquo;linkerd-viz&rdquo; checks
<a href=#l5d-viz class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>These checks only run when the <code>linkerd-viz</code> extension is installed.
This check is intended to verify the installation of linkerd-viz
extension which comprises of <code>tap</code>, <code>web</code>,
<code>metrics-api</code> and optional <code>grafana</code> and <code>prometheus</code> instances
along with <code>tap-injector</code> which injects the specific
tap configuration to the proxies.</p><h3 id=l5d-viz-ns-exists class=anchor>√ linkerd-viz Namespace exists
<a href=#l5d-viz-ns-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This is the basic check used to verify if the linkerd-viz extension
namespace is installed or not. The extension can be installed by running
the following command:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd viz install | kubectl apply -f -
</span></span></code></pre></div><p>The installation can be configured by using the
<code>--set</code>, <code>--values</code>, <code>--set-string</code> and <code>--set-file</code> flags.
See <a href=https://www.github.com/linkerd/linkerd2/tree/main/viz/charts/linkerd-viz/README.md target=_blank rel=noopener>Linkerd Viz Readme</a>
for a full list of configurable fields.</p><h3 id=l5d-viz-cr-exists class=anchor>√ linkerd-viz ClusterRoles exist
<a href=#l5d-viz-cr-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× linkerd-viz ClusterRoles exist
</span></span><span style=display:flex><span>    missing ClusterRoles: linkerd-linkerd-viz-metrics-api
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-viz-cr-exists <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure the linkerd-viz extension ClusterRoles exist:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get clusterroles | grep linkerd-viz
</span></span><span style=display:flex><span>linkerd-linkerd-viz-metrics-api                                        2021-01-26T18:02:17Z
</span></span><span style=display:flex><span>linkerd-linkerd-viz-prometheus                                         2021-01-26T18:02:17Z
</span></span><span style=display:flex><span>linkerd-linkerd-viz-tap                                                2021-01-26T18:02:17Z
</span></span><span style=display:flex><span>linkerd-linkerd-viz-tap-admin                                          2021-01-26T18:02:17Z
</span></span><span style=display:flex><span>linkerd-linkerd-viz-web-check                                          2021-01-26T18:02:18Z
</span></span></code></pre></div><p>Also ensure you have permission to create ClusterRoles:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl auth can-i create clusterroles
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=l5d-viz-crb-exists class=anchor>√ linkerd-viz ClusterRoleBindings exist
<a href=#l5d-viz-crb-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× linkerd-viz ClusterRoleBindings exist
</span></span><span style=display:flex><span>    missing ClusterRoleBindings: linkerd-linkerd-viz-metrics-api
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-viz-crb-exists <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure the linkerd-viz extension ClusterRoleBindings exist:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get clusterrolebindings | grep linkerd-viz
</span></span><span style=display:flex><span>linkerd-linkerd-viz-metrics-api                        ClusterRole/linkerd-linkerd-viz-metrics-api                                        18h
</span></span><span style=display:flex><span>linkerd-linkerd-viz-prometheus                         ClusterRole/linkerd-linkerd-viz-prometheus                                         18h
</span></span><span style=display:flex><span>linkerd-linkerd-viz-tap                                ClusterRole/linkerd-linkerd-viz-tap                                                18h
</span></span><span style=display:flex><span>linkerd-linkerd-viz-tap-auth-delegator                 ClusterRole/system:auth-delegator                                                  18h
</span></span><span style=display:flex><span>linkerd-linkerd-viz-web-admin                          ClusterRole/linkerd-linkerd-viz-tap-admin                                          18h
</span></span><span style=display:flex><span>linkerd-linkerd-viz-web-check                          ClusterRole/linkerd-linkerd-viz-web-check                                          18h
</span></span></code></pre></div><p>Also ensure you have permission to create ClusterRoleBindings:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl auth can-i create clusterrolebindings
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=l5d-viz-proxy-healthy class=anchor>√ viz extension proxies are healthy
<a href=#l5d-viz-proxy-healthy class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This error indicates that the proxies running in the viz extension are
not healthy. Ensure that linkerd-viz has been installed with all of the
correct setting or re-install as necessary.</p><h3 id=l5d-viz-proxy-cp-version class=anchor>√ viz extension proxies are up-to-date
<a href=#l5d-viz-proxy-cp-version class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This warning indicates the proxies running in the viz extension are
running an old version. We recommend downloading the latest linkerd-viz
and upgrading.</p><h3 id=l5d-viz-proxy-cli-version class=anchor>√ viz extension proxies and cli versions match
<a href=#l5d-viz-proxy-cli-version class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This warning indicates that the proxies running in the viz extension are
running a different version from the Linkerd CLI. We recommend keeping this
versions in sync by updating either the CLI or linkerd-viz as necessary.</p><h3 id=l5d-tap-cert-valid class=anchor>√ tap API server has valid cert
<a href=#l5d-tap-cert-valid class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× tap API server has valid cert
</span></span><span style=display:flex><span>    secrets <span style=color:#a5d6ff>&#34;tap-k8s-tls&#34;</span> not found
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-tap-cert-valid <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure that the <code>tap-k8s-tls</code> secret exists and contains the appropriate
<code>tls.crt</code> and <code>tls.key</code> data entries. For versions before 2.9, the secret is
named <code>linkerd-tap-tls</code> and it should contain the <code>crt.pem</code> and <code>key.pem</code> data
entries.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× tap API server has valid cert
</span></span><span style=display:flex><span>    cert is not issued by the trust anchor: x509: certificate is valid <span style=color:#ff7b72>for</span> xxxxxx, not tap.linkerd-viz.svc
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-tap-cert-valid <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Here you need to make sure the certificate was issued specifically for
<code>tap.linkerd-viz.svc</code>.</p><h3 id=l5d-tap-cert-not-expiring-soon class=anchor>√ tap API server cert is valid for at least 60 days
<a href=#l5d-tap-cert-not-expiring-soon class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ tap API server cert is valid <span style=color:#ff7b72>for</span> at least <span style=color:#a5d6ff>60</span> days
</span></span><span style=display:flex><span>    certificate will expire on 2020-11-07T17:00:07Z
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-webhook-cert-not-expiring-soon <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>This warning indicates that the expiry of the tap API Server webhook
cert is approaching. In order to address this
problem without incurring downtime, you can follow the process outlined in
<a href=../automatically-rotating-webhook-tls-credentials/>Automatically Rotating your webhook TLS Credentials</a>.</p><h3 id=l5d-tap-api class=anchor>√ tap api service is running
<a href=#l5d-tap-api class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× FailedDiscoveryCheck: no response from https://10.233.31.133:443: Get https://10.233.31.133:443: net/http: request canceled <span style=color:#ff7b72>while</span> waiting <span style=color:#ff7b72>for</span> connection <span style=color:#ff7b72;font-weight:700>(</span>Client.Timeout exceeded <span style=color:#ff7b72>while</span> awaiting headers<span style=color:#ff7b72;font-weight:700>)</span>
</span></span></code></pre></div><p>tap uses the
<a href=https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/apiserver-aggregation/ target=_blank rel=noopener>kubernetes Aggregated Api-Server model</a>
to allow users to have k8s RBAC on top. This model has the following specific
requirements in the cluster:</p><ul><li>tap Server must be
<a href=https://kubernetes.io/docs/concepts/architecture/master-node-communication/#master-to-cluster target=_blank rel=noopener>reachable from kube-apiserver</a></li><li>The kube-apiserver must be correctly configured to
<a href=https://kubernetes.io/docs/tasks/access-kubernetes-api/configure-aggregation-layer/ target=_blank rel=noopener>enable an aggregation layer</a></li></ul><h3 id=l5d-viz-pods-injection class=anchor>√ linkerd-viz pods are injected
<a href=#l5d-viz-pods-injection class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× linkerd-viz extension pods are injected
</span></span><span style=display:flex><span>    could not find proxy container <span style=color:#ff7b72>for</span> tap-59f5595fc7-ttndp pod
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-viz-pods-injection <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure all the linkerd-viz pods are injected</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n linkerd-viz get pods
</span></span><span style=display:flex><span>NAME                                   READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>grafana-68cddd7cc8-nrv4h       2/2     Running   <span style=color:#a5d6ff>3</span>          18h
</span></span><span style=display:flex><span>metrics-api-77f684f7c7-hnw8r   2/2     Running   <span style=color:#a5d6ff>2</span>          18h
</span></span><span style=display:flex><span>prometheus-5f6898ff8b-s6rjc    2/2     Running   <span style=color:#a5d6ff>2</span>          18h
</span></span><span style=display:flex><span>tap-59f5595fc7-ttndp           2/2     Running   <span style=color:#a5d6ff>2</span>          18h
</span></span><span style=display:flex><span>web-78d6588d4-pn299            2/2     Running   <span style=color:#a5d6ff>2</span>          18h
</span></span><span style=display:flex><span>tap-injector-566f7ff8df-vpcwc          2/2     Running   <span style=color:#a5d6ff>2</span>          18h
</span></span></code></pre></div><p>Make sure that the <code>proxy-injector</code> is working correctly by running
<code>linkerd check</code></p><h3 id=l5d-viz-pods-running class=anchor>√ viz extension pods are running
<a href=#l5d-viz-pods-running class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× viz extension pods are running
</span></span><span style=display:flex><span>    container linkerd-proxy in pod tap-59f5595fc7-ttndp is not ready
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-viz-pods-running <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure all the linkerd-viz pods are running with 2/2</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n linkerd-viz get pods
</span></span><span style=display:flex><span>NAME                                   READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>grafana-68cddd7cc8-nrv4h               2/2     Running   <span style=color:#a5d6ff>3</span>          18h
</span></span><span style=display:flex><span>metrics-api-77f684f7c7-hnw8r           2/2     Running   <span style=color:#a5d6ff>2</span>          18h
</span></span><span style=display:flex><span>prometheus-5f6898ff8b-s6rjc            2/2     Running   <span style=color:#a5d6ff>2</span>          18h
</span></span><span style=display:flex><span>tap-59f5595fc7-ttndp                   2/2     Running   <span style=color:#a5d6ff>2</span>          18h
</span></span><span style=display:flex><span>web-78d6588d4-pn299                    2/2     Running   <span style=color:#a5d6ff>2</span>          18h
</span></span><span style=display:flex><span>tap-injector-566f7ff8df-vpcwc          2/2     Running   <span style=color:#a5d6ff>2</span>          18h
</span></span></code></pre></div><p>Make sure that the <code>proxy-injector</code> is working correctly by running
<code>linkerd check</code></p><h3 id=l5d-viz-prometheus class=anchor>√ prometheus is installed and configured correctly
<a href=#l5d-viz-prometheus class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× prometheus is installed and configured correctly
</span></span><span style=display:flex><span>    missing ClusterRoles: linkerd-linkerd-viz-prometheus
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-viz-cr-exists <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure all the prometheus related resources are present and running
correctly.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ kubectl -n linkerd-viz get deploy,cm | grep prometheus
</span></span><span style=display:flex><span>deployment.apps/prometheus     1/1     <span style=color:#a5d6ff>1</span>            <span style=color:#a5d6ff>1</span>           3m18s
</span></span><span style=display:flex><span>configmap/prometheus-config   <span style=color:#a5d6ff>1</span>      3m18s
</span></span><span style=display:flex><span>❯ kubectl get clusterRoleBindings | grep prometheus
</span></span><span style=display:flex><span>linkerd-linkerd-viz-prometheus                         ClusterRole/linkerd-linkerd-viz-prometheus                         3m37s
</span></span><span style=display:flex><span>❯ kubectl get clusterRoles | grep prometheus
</span></span><span style=display:flex><span>linkerd-linkerd-viz-prometheus                                         2021-02-26T06:03:11Zh
</span></span></code></pre></div><h3 id=l5d-viz-existence-client class=anchor>√ can initialize the client
<a href=#l5d-viz-existence-client class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× can initialize the client
</span></span><span style=display:flex><span>    Failed to get deploy <span style=color:#ff7b72>for</span> pod metrics-api-77f684f7c7-hnw8r: not running
</span></span></code></pre></div><p>Verify that the metrics API pod is running correctly</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ kubectl -n linkerd-viz get pods
</span></span><span style=display:flex><span>NAME                           READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>metrics-api-7bb8cb8489-cbq4m   2/2     Running   <span style=color:#a5d6ff>0</span>          4m58s
</span></span><span style=display:flex><span>tap-injector-6b9bc6fc4-cgbr4   2/2     Running   <span style=color:#a5d6ff>0</span>          4m56s
</span></span><span style=display:flex><span>tap-5f6ddcc684-k2fd6           2/2     Running   <span style=color:#a5d6ff>0</span>          4m57s
</span></span><span style=display:flex><span>web-cbb846484-d987n            2/2     Running   <span style=color:#a5d6ff>0</span>          4m56s
</span></span><span style=display:flex><span>grafana-76fd8765f4-9rg8q       2/2     Running   <span style=color:#a5d6ff>0</span>          4m58s
</span></span><span style=display:flex><span>prometheus-7c5c48c466-jc27g    2/2     Running   <span style=color:#a5d6ff>0</span>          4m58s
</span></span></code></pre></div><h3 id=l5d-viz-metrics-api class=anchor>√ viz extension self-check
<a href=#l5d-viz-metrics-api class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× viz extension self-check
</span></span><span style=display:flex><span>    No results returned
</span></span></code></pre></div><p>Check the logs on the viz extensions&rsquo;s metrics API:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl -n linkerd-viz logs deploy/metrics-api metrics-api
</span></span></code></pre></div><h3 id=l5d-viz-data-plane-prom-authz class=anchor>√ prometheus is authorized to scrape data plane pods
<a href=#l5d-viz-data-plane-prom-authz class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>
</span></span><span style=display:flex><span>‼ prometheus is authorized to scrape data plane pods
</span></span><span style=display:flex><span>    prometheus may not be authorized to scrape the following pods:
</span></span><span style=display:flex><span>        * emojivoto/voting-5f46cbcdc6-p5dhn
</span></span><span style=display:flex><span>        * emojivoto/emoji-54f8786975-6qc8s
</span></span><span style=display:flex><span>        * emojivoto/vote-bot-85dfbf8996-86c44
</span></span><span style=display:flex><span>        * emojivoto/web-79db6f4548-4mzkg
</span></span><span style=display:flex><span>    consider running <span style=color:#a5d6ff>`</span>linkerd viz allow-scrapes<span style=color:#a5d6ff>`</span> to authorize prometheus scrapes
</span></span><span style=display:flex><span>    see https://linkerd.io/2.16/checks/#l5d-viz-data-plane-prom-authz <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>This warning indicates that the listed pods have the
<a href=../../features/server-policy/#policy-annotations><code>deny</code> default inbound policy</a>,
which may prevent the <code>linkerd-viz</code> Prometheus instance from scraping the data
plane proxies in those pods. If Prometheus cannot scrape a data plane pod,
<code>linkerd viz</code> commands targeting that pod will return no data.</p><p>This may be resolved by running the <code>linkerd viz allow-scrapes</code> command, which
generates <a href=../../features/server-policy/>policy resources</a> authorizing
Prometheus to scrape the data plane proxies in a namespace:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd viz allow-scrapes --namespace emojivoto | kubectl apply -f -
</span></span></code></pre></div><p>Note that this warning <em>only</em> checks for the existence of the policy resources
generated by <code>linkerd viz allow-scrapes</code> in namespaces that contain pods with
the <code>deny</code> default inbound policy. In some cases, Prometheus scrapes may also be
authorized by other, user-generated authorization policies. If metrics from the
listed pods are present in Prometheus, this warning is a false positive and can
be safely disregarded.</p><h3 id=l5d-data-plane-prom class=anchor>√ data plane proxy metrics are present in Prometheus
<a href=#l5d-data-plane-prom class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>Example failure:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× data plane proxy metrics are present in Prometheus
</span></span><span style=display:flex><span>    Data plane metrics not found <span style=color:#ff7b72>for</span> linkerd/linkerd-identity-b8c4c48c8-pflc9.
</span></span></code></pre></div><p>Ensure Prometheus can connect to each <code>linkerd-proxy</code> via the Prometheus
dashboard:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl -n linkerd-viz port-forward svc/prometheus <span style=color:#a5d6ff>9090</span>
</span></span></code></pre></div><p>&mldr;and then browse to
<a href=http://localhost:9090/targets target=_blank rel=noopener>http://localhost:9090/targets</a>, validate the
<code>linkerd-proxy</code> section.</p><p>You should see all your pods here. If they are not:</p><ul><li>Prometheus might be experiencing connectivity issues with the k8s api server.
Check out the logs and delete the pod to flush any possible transient errors.</li></ul><h2 id=l5d-jaeger class=anchor>The &ldquo;linkerd-jaeger&rdquo; checks
<a href=#l5d-jaeger class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>These checks only run when the <code>linkerd-jaeger</code> extension is installed.
This check is intended to verify the installation of linkerd-jaeger
extension which comprises of open-census collector and jaeger
components along with <code>jaeger-injector</code> which injects the specific
trace configuration to the proxies.</p><h3 id=l5d-jaeger-ns-exists class=anchor>√ linkerd-jaeger extension Namespace exists
<a href=#l5d-jaeger-ns-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This is the basic check used to verify if the linkerd-jaeger extension
namespace is installed or not. The extension can be installed by running
the following command</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd jaeger install | kubectl apply -f -
</span></span></code></pre></div><p>The installation can be configured by using the
<code>--set</code>, <code>--values</code>, <code>--set-string</code> and <code>--set-file</code> flags.
See <a href=https://www.github.com/linkerd/linkerd2/tree/main/jaeger/charts/linkerd-jaeger/README.md target=_blank rel=noopener>Linkerd Jaeger Readme</a>
for a full list of configurable fields.</p><h3 id=l5d-jaeger-proxy-healthy class=anchor>√ jaeger extension proxies are healthy
<a href=#l5d-jaeger-proxy-healthy class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This error indicates that the proxies running in the jaeger extension are
not healthy. Ensure that linkerd-jaeger has been installed with all of the
correct setting or re-install as necessary.</p><h3 id=l5d-jaeger-proxy-cp-version class=anchor>√ jaeger extension proxies are up-to-date
<a href=#l5d-jaeger-proxy-cp-version class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This warning indicates the proxies running in the jaeger extension are
running an old version. We recommend downloading the latest linkerd-jaeger
and upgrading.</p><h3 id=l5d-jaeger-proxy-cli-version class=anchor>√ jaeger extension proxies and cli versions match
<a href=#l5d-jaeger-proxy-cli-version class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><p>This warning indicates that the proxies running in the jaeger extension are
running a different version from the Linkerd CLI. We recommend keeping this
versions in sync by updating either the CLI or linkerd-jaeger as necessary.</p><h3 id=l5d-jaeger-pods-injection class=anchor>√ jaeger extension pods are injected
<a href=#l5d-jaeger-pods-injection class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× jaeger extension pods are injected
</span></span><span style=display:flex><span>    could not find proxy container <span style=color:#ff7b72>for</span> jaeger-6f98d5c979-scqlq pod
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-jaeger-pods-injections <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure all the jaeger pods are injected</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n linkerd-jaeger get pods
</span></span><span style=display:flex><span>NAME                               READY   STATUS      RESTARTS   AGE
</span></span><span style=display:flex><span>collector-69cc44dfbc-rhpfg         2/2     Running     <span style=color:#a5d6ff>0</span>          11s
</span></span><span style=display:flex><span>jaeger-6f98d5c979-scqlq            2/2     Running     <span style=color:#a5d6ff>0</span>          11s
</span></span><span style=display:flex><span>jaeger-injector-6c594f5577-cz75h   2/2     Running     <span style=color:#a5d6ff>0</span>          10s
</span></span></code></pre></div><p>Make sure that the <code>proxy-injector</code> is working correctly by running
<code>linkerd check</code></p><h3 id=l5d-jaeger-pods-running class=anchor>√ jaeger extension pods are running
<a href=#l5d-jaeger-pods-running class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× jaeger extension pods are running
</span></span><span style=display:flex><span>    container linkerd-proxy in pod jaeger-59f5595fc7-ttndp is not ready
</span></span><span style=display:flex><span>    see https://linkerd.io/checks/#l5d-jaeger-pods-running <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure all the linkerd-jaeger pods are running with 2/2</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n linkerd-jaeger get pods
</span></span><span style=display:flex><span>NAME                               READY   STATUS   RESTARTS   AGE
</span></span><span style=display:flex><span>jaeger-injector-548684d74b-bcq5h   2/2     Running   <span style=color:#a5d6ff>0</span>          5s
</span></span><span style=display:flex><span>collector-69cc44dfbc-wqf6s         2/2     Running   <span style=color:#a5d6ff>0</span>          5s
</span></span><span style=display:flex><span>jaeger-6f98d5c979-vs622            2/2     Running   <span style=color:#a5d6ff>0</span>          5sh
</span></span></code></pre></div><p>Make sure that the <code>proxy-injector</code> is working correctly by running
<code>linkerd check</code></p><h2 id=l5d-buoyant class=anchor>The &ldquo;linkerd-buoyant&rdquo; checks
<a href=#l5d-buoyant class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h2><p>These checks only run when the <code>linkerd-buoyant</code> extension is installed.
This check is intended to verify the installation of linkerd-buoyant
extension which comprises <code>linkerd-buoyant</code> CLI, the <code>buoyant-cloud-agent</code>
Deployment, and the <code>buoyant-cloud-metrics</code> DaemonSet.</p><h3 id=-linkerd-extension-command-linkerd-buoyant-exists class=anchor>√ Linkerd extension command linkerd-buoyant exists
<a href=#-linkerd-extension-command-linkerd-buoyant-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ Linkerd extension command linkerd-buoyant exists
</span></span><span style=display:flex><span>    exec: <span style=color:#a5d6ff>&#34;linkerd-buoyant&#34;</span>: executable file not found in <span style=color:#79c0ff>$PATH</span>
</span></span><span style=display:flex><span>    see https://linkerd.io/2.16/checks/#extensions <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure you have the <code>linkerd-buoyant</code> cli installed:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd-buoyant check
</span></span></code></pre></div><p>To install the CLI:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl https://buoyant.cloud/install | sh
</span></span></code></pre></div><h3 id=-linkerd-buoyant-can-determine-the-latest-version class=anchor>√ linkerd-buoyant can determine the latest version
<a href=#-linkerd-buoyant-can-determine-the-latest-version class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ linkerd-buoyant can determine the latest version
</span></span><span style=display:flex><span>    Get <span style=color:#a5d6ff>&#34;https://buoyant.cloud/version.json&#34;</span>: dial tcp: lookup buoyant.cloud: no such host
</span></span><span style=display:flex><span>    see https://linkerd.io/checks#l5d-buoyant <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure you can connect to the Linkerd Buoyant version check endpoint from the
environment the <code>linkerd</code> cli is running:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl https://buoyant.cloud/version.json
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>{</span><span style=color:#a5d6ff>&#34;linkerd-buoyant&#34;</span>:<span style=color:#a5d6ff>&#34;v0.4.4&#34;</span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=-linkerd-buoyant-cli-is-up-to-date class=anchor>√ linkerd-buoyant cli is up-to-date
<a href=#-linkerd-buoyant-cli-is-up-to-date class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ linkerd-buoyant cli is up-to-date
</span></span><span style=display:flex><span>    CLI version is v0.4.3 but the latest is v0.4.4
</span></span><span style=display:flex><span>    see https://linkerd.io/checks#l5d-buoyant <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>To update to the latest version of the <code>linkerd-buoyant</code> CLI:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl https://buoyant.cloud/install | sh
</span></span></code></pre></div><h3 id=-buoyant-cloud-namespace-exists class=anchor>√ buoyant-cloud Namespace exists
<a href=#-buoyant-cloud-namespace-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× buoyant-cloud Namespace exists
</span></span><span style=display:flex><span>    namespaces <span style=color:#a5d6ff>&#34;buoyant-cloud&#34;</span> not found
</span></span><span style=display:flex><span>    see https://linkerd.io/checks#l5d-buoyant <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure the <code>buoyant-cloud</code> namespace exists:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get ns/buoyant-cloud
</span></span></code></pre></div><p>If the namespace does not exist, the <code>linkerd-buoyant</code> installation may be
missing or incomplete. To install the extension:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd-buoyant install | kubectl apply -f -
</span></span></code></pre></div><h3 id=-buoyant-cloud-namespace-has-correct-labels class=anchor>√ buoyant-cloud Namespace has correct labels
<a href=#-buoyant-cloud-namespace-has-correct-labels class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× buoyant-cloud Namespace has correct labels
</span></span><span style=display:flex><span>    missing app.kubernetes.io/part-of label
</span></span><span style=display:flex><span>    see https://linkerd.io/checks#l5d-buoyant <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>The <code>linkerd-buoyant</code> installation may be missing or incomplete. To install the
extension:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd-buoyant install | kubectl apply -f -
</span></span></code></pre></div><h3 id=-buoyant-cloud-agent-clusterrole-exists class=anchor>√ buoyant-cloud-agent ClusterRole exists
<a href=#-buoyant-cloud-agent-clusterrole-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× buoyant-cloud-agent ClusterRole exists
</span></span><span style=display:flex><span>    missing ClusterRole: buoyant-cloud-agent
</span></span><span style=display:flex><span>    see https://linkerd.io/checks#l5d-buoyant <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure that the cluster role exists:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get clusterrole buoyant-cloud-agent
</span></span><span style=display:flex><span>NAME                  CREATED AT
</span></span><span style=display:flex><span>buoyant-cloud-agent   2020-11-13T00:59:50Z
</span></span></code></pre></div><p>Also ensure you have permission to create ClusterRoles:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl auth can-i create ClusterRoles
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=-buoyant-cloud-agent-clusterrolebinding-exists class=anchor>√ buoyant-cloud-agent ClusterRoleBinding exists
<a href=#-buoyant-cloud-agent-clusterrolebinding-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× buoyant-cloud-agent ClusterRoleBinding exists
</span></span><span style=display:flex><span>    missing ClusterRoleBinding: buoyant-cloud-agent
</span></span><span style=display:flex><span>    see https://linkerd.io/checks#l5d-buoyant <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure that the cluster role binding exists:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get clusterrolebinding buoyant-cloud-agent
</span></span><span style=display:flex><span>NAME                  ROLE                              AGE
</span></span><span style=display:flex><span>buoyant-cloud-agent   ClusterRole/buoyant-cloud-agent   301d
</span></span></code></pre></div><p>Also ensure you have permission to create ClusterRoleBindings:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl auth can-i create ClusterRoleBindings
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=-buoyant-cloud-agent-serviceaccount-exists class=anchor>√ buoyant-cloud-agent ServiceAccount exists
<a href=#-buoyant-cloud-agent-serviceaccount-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× buoyant-cloud-agent ServiceAccount exists
</span></span><span style=display:flex><span>    missing ServiceAccount: buoyant-cloud-agent
</span></span><span style=display:flex><span>    see https://linkerd.io/checks#l5d-buoyant <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure that the service account exists:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n buoyant-cloud get serviceaccount buoyant-cloud-agent
</span></span><span style=display:flex><span>NAME                  SECRETS   AGE
</span></span><span style=display:flex><span>buoyant-cloud-agent   <span style=color:#a5d6ff>1</span>         301d
</span></span></code></pre></div><p>Also ensure you have permission to create ServiceAccounts:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n buoyant-cloud auth can-i create ServiceAccount
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=-buoyant-cloud-id-secret-exists class=anchor>√ buoyant-cloud-id Secret exists
<a href=#-buoyant-cloud-id-secret-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× buoyant-cloud-id Secret exists
</span></span><span style=display:flex><span>    missing Secret: buoyant-cloud-id
</span></span><span style=display:flex><span>    see https://linkerd.io/checks#l5d-buoyant <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure that the secret exists:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n buoyant-cloud get secret buoyant-cloud-id
</span></span><span style=display:flex><span>NAME               TYPE     DATA   AGE
</span></span><span style=display:flex><span>buoyant-cloud-id   Opaque   <span style=color:#a5d6ff>4</span>      301d
</span></span></code></pre></div><p>Also ensure you have permission to create ServiceAccounts:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n buoyant-cloud auth can-i create ServiceAccount
</span></span><span style=display:flex><span>yes
</span></span></code></pre></div><h3 id=-buoyant-cloud-agent-deployment-exists class=anchor>√ buoyant-cloud-agent Deployment exists
<a href=#-buoyant-cloud-agent-deployment-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× buoyant-cloud-agent Deployment exists
</span></span><span style=display:flex><span>    deployments.apps <span style=color:#a5d6ff>&#34;buoyant-cloud-agent&#34;</span> not found
</span></span><span style=display:flex><span>    see https://linkerd.io/checks#l5d-buoyant <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure the <code>buoyant-cloud-agent</code> Deployment exists:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl -n buoyant-cloud get deploy/buoyant-cloud-agent
</span></span></code></pre></div><p>If the Deployment does not exist, the <code>linkerd-buoyant</code> installation may be
missing or incomplete. To reinstall the extension:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd-buoyant install | kubectl apply -f -
</span></span></code></pre></div><h3 id=-buoyant-cloud-agent-deployment-is-running class=anchor>√ buoyant-cloud-agent Deployment is running
<a href=#-buoyant-cloud-agent-deployment-is-running class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× buoyant-cloud-agent Deployment is running
</span></span><span style=display:flex><span>    no running pods <span style=color:#ff7b72>for</span> buoyant-cloud-agent Deployment
</span></span><span style=display:flex><span>    see https://linkerd.io/checks#l5d-buoyant <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Note, it takes a little bit for pods to be scheduled, images to be pulled and
everything to start up. If this is a permanent error, you&rsquo;ll want to validate
the state of the <code>buoyant-cloud-agent</code> Deployment with:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n buoyant-cloud get po --selector <span style=color:#79c0ff>app</span><span style=color:#ff7b72;font-weight:700>=</span>buoyant-cloud-agent
</span></span><span style=display:flex><span>NAME                                   READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>buoyant-cloud-agent-6b8c6888d7-htr7d   2/2     Running   <span style=color:#a5d6ff>0</span>          156m
</span></span></code></pre></div><p>Check the agent&rsquo;s logs with:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl logs -n buoyant-cloud buoyant-cloud-agent-6b8c6888d7-htr7d buoyant-cloud-agent
</span></span></code></pre></div><h3 id=-buoyant-cloud-agent-deployment-is-injected class=anchor>√ buoyant-cloud-agent Deployment is injected
<a href=#-buoyant-cloud-agent-deployment-is-injected class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× buoyant-cloud-agent Deployment is injected
</span></span><span style=display:flex><span>    could not find proxy container <span style=color:#ff7b72>for</span> buoyant-cloud-agent-6b8c6888d7-htr7d pod
</span></span><span style=display:flex><span>    see https://linkerd.io/checks#l5d-buoyant <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure the <code>buoyant-cloud-agent</code> pod is injected, the <code>READY</code> column should show
<code>2/2</code>:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n buoyant-cloud get pods --selector <span style=color:#79c0ff>app</span><span style=color:#ff7b72;font-weight:700>=</span>buoyant-cloud-agent
</span></span><span style=display:flex><span>NAME                                   READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>buoyant-cloud-agent-6b8c6888d7-htr7d   2/2     Running   <span style=color:#a5d6ff>0</span>          161m
</span></span></code></pre></div><p>Make sure that the <code>proxy-injector</code> is working correctly by running
<code>linkerd check</code>.</p><h3 id=-buoyant-cloud-agent-deployment-is-up-to-date class=anchor>√ buoyant-cloud-agent Deployment is up-to-date
<a href=#-buoyant-cloud-agent-deployment-is-up-to-date class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ buoyant-cloud-agent Deployment is up-to-date
</span></span><span style=display:flex><span>    incorrect app.kubernetes.io/version label: v0.4.3, expected: v0.4.4
</span></span><span style=display:flex><span>    see https://linkerd.io/checks#l5d-buoyant <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Check the version with:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ linkerd-buoyant version
</span></span><span style=display:flex><span>CLI version:   v0.4.4
</span></span><span style=display:flex><span>Agent version: v0.4.4
</span></span></code></pre></div><p>To update to the latest version:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd-buoyant install | kubectl apply -f -
</span></span></code></pre></div><h3 id=-buoyant-cloud-agent-deployment-is-running-a-single-pod class=anchor>√ buoyant-cloud-agent Deployment is running a single pod
<a href=#-buoyant-cloud-agent-deployment-is-running-a-single-pod class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× buoyant-cloud-agent Deployment is running a single pod
</span></span><span style=display:flex><span>    expected <span style=color:#a5d6ff>1</span> buoyant-cloud-agent pod, found <span style=color:#a5d6ff>2</span>
</span></span><span style=display:flex><span>    see https://linkerd.io/checks#l5d-buoyant <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p><code>buoyant-cloud-agent</code> should run as a singleton. Check for other pods:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get po -A --selector <span style=color:#79c0ff>app</span><span style=color:#ff7b72;font-weight:700>=</span>buoyant-cloud-agent
</span></span></code></pre></div><h3 id=-buoyant-cloud-metrics-daemonset-exists class=anchor>√ buoyant-cloud-metrics DaemonSet exists
<a href=#-buoyant-cloud-metrics-daemonset-exists class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× buoyant-cloud-metrics DaemonSet exists
</span></span><span style=display:flex><span>    deployments.apps <span style=color:#a5d6ff>&#34;buoyant-cloud-metrics&#34;</span> not found
</span></span><span style=display:flex><span>    see https://linkerd.io/checks#l5d-buoyant <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure the <code>buoyant-cloud-metrics</code> DaemonSet exists:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl -n buoyant-cloud get daemonset/buoyant-cloud-metrics
</span></span></code></pre></div><p>If the DaemonSet does not exist, the <code>linkerd-buoyant</code> installation may be
missing or incomplete. To reinstall the extension:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd-buoyant install | kubectl apply -f -
</span></span></code></pre></div><h3 id=-buoyant-cloud-metrics-daemonset-is-running class=anchor>√ buoyant-cloud-metrics DaemonSet is running
<a href=#-buoyant-cloud-metrics-daemonset-is-running class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× buoyant-cloud-metrics DaemonSet is running
</span></span><span style=display:flex><span>    no running pods <span style=color:#ff7b72>for</span> buoyant-cloud-metrics DaemonSet
</span></span><span style=display:flex><span>    see https://linkerd.io/checks#l5d-buoyant <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Note, it takes a little bit for pods to be scheduled, images to be pulled and
everything to start up. If this is a permanent error, you&rsquo;ll want to validate
the state of the <code>buoyant-cloud-metrics</code> DaemonSet with:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n buoyant-cloud get po --selector <span style=color:#79c0ff>app</span><span style=color:#ff7b72;font-weight:700>=</span>buoyant-cloud-metrics
</span></span><span style=display:flex><span>NAME                          READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>buoyant-cloud-metrics-kt9mv   2/2     Running   <span style=color:#a5d6ff>0</span>          163m
</span></span><span style=display:flex><span>buoyant-cloud-metrics-q8jhj   2/2     Running   <span style=color:#a5d6ff>0</span>          163m
</span></span><span style=display:flex><span>buoyant-cloud-metrics-qtflh   2/2     Running   <span style=color:#a5d6ff>0</span>          164m
</span></span><span style=display:flex><span>buoyant-cloud-metrics-wqs4k   2/2     Running   <span style=color:#a5d6ff>0</span>          163m
</span></span></code></pre></div><p>Check the agent&rsquo;s logs with:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl logs -n buoyant-cloud buoyant-cloud-metrics-kt9mv buoyant-cloud-metrics
</span></span></code></pre></div><h3 id=-buoyant-cloud-metrics-daemonset-is-injected class=anchor>√ buoyant-cloud-metrics DaemonSet is injected
<a href=#-buoyant-cloud-metrics-daemonset-is-injected class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>× buoyant-cloud-metrics DaemonSet is injected
</span></span><span style=display:flex><span>    could not find proxy container <span style=color:#ff7b72>for</span> buoyant-cloud-agent-6b8c6888d7-htr7d pod
</span></span><span style=display:flex><span>    see https://linkerd.io/checks#l5d-buoyant <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Ensure the <code>buoyant-cloud-metrics</code> pods are injected, the <code>READY</code> column should
show <code>2/2</code>:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n buoyant-cloud get pods --selector <span style=color:#79c0ff>app</span><span style=color:#ff7b72;font-weight:700>=</span>buoyant-cloud-metrics
</span></span><span style=display:flex><span>NAME                          READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>buoyant-cloud-metrics-kt9mv   2/2     Running   <span style=color:#a5d6ff>0</span>          166m
</span></span><span style=display:flex><span>buoyant-cloud-metrics-q8jhj   2/2     Running   <span style=color:#a5d6ff>0</span>          166m
</span></span><span style=display:flex><span>buoyant-cloud-metrics-qtflh   2/2     Running   <span style=color:#a5d6ff>0</span>          166m
</span></span><span style=display:flex><span>buoyant-cloud-metrics-wqs4k   2/2     Running   <span style=color:#a5d6ff>0</span>          166m
</span></span></code></pre></div><p>Make sure that the <code>proxy-injector</code> is working correctly by running
<code>linkerd check</code>.</p><h3 id=-buoyant-cloud-metrics-daemonset-is-up-to-date class=anchor>√ buoyant-cloud-metrics DaemonSet is up-to-date
<a href=#-buoyant-cloud-metrics-daemonset-is-up-to-date class=anchor__link><svg class="icon icon--primary" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7A5 5 0 002 12a5 5 0 005 5h4V15.1H7c-1.71.0-3.1-1.39-3.1-3.1M8 13h8V11H8v2m9-6H13V8.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1H13V17h4a5 5 0 005-5A5 5 0 0017 7z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‼ buoyant-cloud-metrics DaemonSet is up-to-date
</span></span><span style=display:flex><span>    incorrect app.kubernetes.io/version label: v0.4.3, expected: v0.4.4
</span></span><span style=display:flex><span>    see https://linkerd.io/checks#l5d-buoyant <span style=color:#ff7b72>for</span> hints
</span></span></code></pre></div><p>Check the version with:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl -n buoyant-cloud get daemonset/buoyant-cloud-metrics -o <span style=color:#79c0ff>jsonpath</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#39;{.metadata.labels}&#39;</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>{</span><span style=color:#a5d6ff>&#34;app.kubernetes.io/name&#34;</span>:<span style=color:#a5d6ff>&#34;metrics&#34;</span>,<span style=color:#a5d6ff>&#34;app.kubernetes.io/part-of&#34;</span>:<span style=color:#a5d6ff>&#34;buoyant-cloud&#34;</span>,<span style=color:#a5d6ff>&#34;app.kubernetes.io/version&#34;</span>:<span style=color:#a5d6ff>&#34;v0.4.4&#34;</span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span></code></pre></div><p>To update to the latest version:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>linkerd-buoyant install | kubectl apply -f -
</span></span></code></pre></div></div></div></div></div></div></main><footer class=main-footer><div class=main-footer__top><div class="main-footer__container container"><div class=main-footer__info><p><img src=/logos/linkerd.png alt=Linkerd></p><p>Linkerd was originally created by <a href=https://buoyant.io/ target=_blank rel=noopener>Buoyant</a></p><p>View <a href=https://github.com/linkerd/linkerd/wiki/Linkerd-code-of-conduct target=_blank rel=noopener>Code of Conduct</a></p></div><div class=main-footer__links><div class=main-footer__community><h4>Community</h4><ul><li><a href=https://github.com/linkerd/linkerd2 target=_blank rel=noopener>GitHub</a></li><li><a href=https://slack.linkerd.io target=_blank rel=noopener>Slack</a></li><li><a href=https://linkerd.buoyant.io target=_blank rel=noopener>Linkerd Forum</a></li></ul></div><div class=main-footer__follow><h4>Follow</h4><ul><li><a href=https://www.linkedin.com/company/linkerd/ target=_blank rel=noopener>Linkedin</a></li><li><a href=https://www.youtube.com/buoyantio target=_blank rel=noopener>YouTube</a></li><li><a href=https://twitter.com/linkerd target=_blank rel=noopener>Twitter</a></li></ul></div></div></div></div><div class=main-footer__bottom><div class="main-footer__container container"><p><a href=https://github.com/linkerd/website/tree/main/linkerd.io/content target=_blank rel=noopener>Edit This Site</a></p><p>Copyright © 2024 Linkerd Authors. All rights reserved.</p></div></div></footer></body></html>